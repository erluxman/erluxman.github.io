{"componentChunkName":"component---src-templates-blog-post-js","path":"/zh-hans/algebraic-effects-for-the-rest-of-us/","result":{"data":{"site":{"siteMetadata":{"title":"Overreacted","author":"Dan Abramov"}},"markdownRemark":{"id":"9287b715-803e-5e3a-8070-3464423f5693","html":"<p>æœ‹å‹ä½ å¬è¯´è¿‡<strong>ä»£æ•°æ•ˆåº”</strong>å—ï¼Ÿ</p>\n<p>æˆ‘æƒ³çŸ¥é“è¿™æ˜¯ä»€ä¹ˆä»¥åŠä¸ºä»€ä¹ˆæˆ‘éœ€è¦äº†è§£å®ƒï¼Œäºæ˜¯æŸ¥é˜…äº†<a href=\"https://www.eff-lang.org/handlers-tutorial.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ä¸€äº›</a> <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2016/08/algeff-tr-2016-v2.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pdfs</a>ï¼Œè¶Šçœ‹è¶Šä¸€å¤´é›¾æ°´ï¼ˆé‡Œé¢ä¸€äº›æ¯”è¾ƒå­¦æœ¯çš„ pdfs çœ‹å¾—æˆ‘æ˜æ˜æ¬²ç¡ï¼‰ã€‚åˆæ¬¡å…¥å‘å¤±è´¥ã€‚</p>\n<p>ä½†æˆ‘çš„åŒäº‹ Sebastian <a href=\"https://mobile.twitter.com/sebmarkbage/status/763792452289343490\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ä¸€ç›´</a><a href=\"https://mobile.twitter.com/sebmarkbage/status/776883429400915968\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å‚</a><a href=\"https://mobile.twitter.com/sebmarkbage/status/776840575207116800\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è€ƒ</a><a href=\"https://mobile.twitter.com/sebmarkbage/status/969279885276454912\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®ƒä»¬</a>ä½œä¸ºæˆ‘ä»¬åœ¨Reactä¸­åšçš„ä¸€äº›ä¸œè¥¿çš„å¿ƒæ™ºæ¨¡å‹ã€‚ï¼ˆSebastian å·¥ä½œäº React å›¢é˜Ÿå¹¶ä¸”è´¡çŒ®è¿‡å¾ˆå¤šæƒ³æ³•ï¼ŒåŒ…æ‹¬ Hooks å’Œ Suspenseã€‚ï¼‰åœ¨æŸç§æ„ä¹‰ä¸Šï¼Œè¿™å·²ç»å˜æˆäº† React å›¢é˜Ÿçš„ä¸€ä¸ªæ¢—ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„è°ˆè¯éƒ½ä»¥æ­¤ç»“å°¾ï¼š</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5fb19385d24afb94180b6ba9aeb2b8d4/066f9/effects.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 400px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 87.16216216216216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDBQL/xAAWAQEBAQAAAAAAAAAAAAAAAAACAwD/2gAMAwEAAhADEAAAAeVtVlNwrBdforHjhb//xAAdEAACAgEFAAAAAAAAAAAAAAABAgADERMhIjIz/9oACAEBAAEFAgu9yaYxCoK2K7NxEr85Z3//xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8BI//EABkRAAEFAAAAAAAAAAAAAAAAAAEAEBESUf/aAAgBAgEBPwESrHH/AP/EABsQAAMAAgMAAAAAAAAAAAAAAAABEQIhEBJh/9oACAEBAAY/AhbvC6pssbnhMtMRkM//xAAcEAABBQEBAQAAAAAAAAAAAAABABARIUExUXH/2gAIAQEAAT8h6MQS7j0Q0nDe0EQwmNK0gPhDXflh/9oADAMBAAIAAwAAABDcL/z/xAAZEQABBQAAAAAAAAAAAAAAAAARAAEQQVH/2gAIAQMBAT8QLWg2f//EABkRAQACAwAAAAAAAAAAAAAAAAEAECExUf/aAAgBAgEBPxBLKR7Iar//xAAeEAEAAgIBBQAAAAAAAAAAAAABABEhQaExUXGx8f/aAAgBAQABPxBLMvoqCCrF614lnURBHN9agjMlNH1m5Zjzl2rB2nGfcZefP//Z'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"\"Algebraic Effects\" caption on the \"Ancient Aliens\" guy meme\"\n        title=\"\"\n        src=\"/static/5fb19385d24afb94180b6ba9aeb2b8d4/066f9/effects.jpg\"\n        srcset=\"/static/5fb19385d24afb94180b6ba9aeb2b8d4/a80bd/effects.jpg 148w,\n/static/5fb19385d24afb94180b6ba9aeb2b8d4/1c91a/effects.jpg 295w,\n/static/5fb19385d24afb94180b6ba9aeb2b8d4/066f9/effects.jpg 400w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>äº‹å®è¯æ˜ï¼Œä»£æ•°æ•ˆåº”æ˜¯ä¸€ä¸ªå¾ˆé…·çš„æ¦‚å¿µï¼Œä¹Ÿæ²¡æœ‰æˆ‘çœ‹äº†ä¸€äº› pdfs ä¹‹åæƒ³çš„é‚£ä¹ˆå¯æ€•ã€‚<strong>å¦‚æœä½ åªæ˜¯ç”¨ Reactï¼Œ å…¶å®å®Œå…¨æ²¡æœ‰å¿…è¦å»äº†è§£è¿™äº›æ¦‚å¿µ â€”â€” ä½†å¦‚æœä½ åƒæˆ‘ä¸€æ ·å¯¹æ­¤æ„Ÿåˆ°å¥½å¥‡ï¼Œå°±è¯·ç»§ç»­è¯»ä¸‹å»å§ã€‚</strong></p>\n<p><strong>ï¼ˆå…è´£å£°æ˜ï¼šæˆ‘å¹¶ä¸æ˜¯ä¸€ä¸ªç¼–ç¨‹è¯­è¨€çš„ç ”ç©¶äººå‘˜ï¼Œåœ¨è§£é‡Šçš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šææ··ä¸€äº›ä¸œè¥¿ã€‚åœ¨è¿™ä¸ªè¯é¢˜ä¸Šæˆ‘ä¸æ˜¯æƒå¨äººå£«ï¼Œæ‰€ä»¥å¦‚æœå‘ç°å“ªé‡Œä¸å¯¹è¯·å‘Šè¯‰æˆ‘ï¼ï¼‰</strong></p>\n<h3 id=\"å°šæœªæŠ•å…¥ç”Ÿäº§\"><a href=\"#%E5%B0%9A%E6%9C%AA%E6%8A%95%E5%85%A5%E7%94%9F%E4%BA%A7\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å°šæœªæŠ•å…¥ç”Ÿäº§</h3>\n<p><strong>ä»£æ•°æ•ˆåº”</strong>æ˜¯ä¸€é¡¹ç ”ç©¶ä¸­çš„ç¼–ç¨‹è¯­è¨€ç‰¹æ€§ã€‚è¿™æ„å‘³ç€<strong>ä¸åƒ <code class=\"language-text\">if</code>ï¼Œfunctionsï¼Œç”šè‡³æ¯”è¾ƒæ–°çš„ <code class=\"language-text\">async / await</code>ï¼Œä½ ä¹Ÿè®¸è¿˜ä¸èƒ½åœ¨ç”Ÿäº§ä¸­çœŸæ­£çš„ä½¿ç”¨å®ƒã€‚</strong>åªæœ‰<a href=\"https://www.eff-lang.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å°‘æ•°</a>ä¸“ä¸ºç ”ç©¶è¿™äº›ç‰¹æ€§è€Œåˆ›é€ çš„<a href=\"https://www.microsoft.com/en-us/research/project/koka/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è¯­è¨€</a>æ”¯æŒå®ƒä»¬çš„ä½¿ç”¨ã€‚OCaml å°†è¿™äº›ç‰¹æ€§æŠ•å…¥ç”Ÿäº§ï¼Œè™½ç„¶å–å¾—äº†ä¸€äº›è¿›å±•ä½†ä¹Ÿâ€¦â€¦å°šåœ¨<a href=\"https://github.com/ocaml-multicore/ocaml-multicore/wiki\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è¿›è¡Œä¸­</a>ã€‚æ¢å¥è¯æ¥è¯´å°±æ˜¯ï¼Œ<a href=\"https://www.youtube.com/watch?v=otCpCn0l4Wo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è§¦ä¸å¯åŠ</a>ã€‚</p>\n<blockquote>\n<p>ä¿®æ­£ï¼šæœ‰äººæŒ‡å‡º LISP ä¸­<a href=\"#learn-more\">æœ‰ç±»ä¼¼çš„å®ç°</a>ï¼Œæ‰€ä»¥å¦‚æœä½ å†™ LISP çš„è¯å¯ä»¥åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨è¿™äº›ç‰¹æ€§ã€‚</p>\n</blockquote>\n<h3 id=\"æ‰€ä»¥æˆ‘ä¸ºä»€ä¹ˆè¦å…³å¿ƒè¿™ä¸ªï¼Ÿ\"><a href=\"#%E6%89%80%E4%BB%A5%E6%88%91%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%85%B3%E5%BF%83%E8%BF%99%E4%B8%AA%EF%BC%9F\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ‰€ä»¥æˆ‘ä¸ºä»€ä¹ˆè¦å…³å¿ƒè¿™ä¸ªï¼Ÿ</h3>\n<p>æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ä½ è¿˜åœ¨å†™ <code class=\"language-text\">goto</code> çš„æ—¶å€™ï¼Œæœ‰äººå‘ä½ å±•ç¤ºäº† <code class=\"language-text\">if</code> å’Œ <code class=\"language-text\">for</code>ã€‚æˆ–è€…å½“ä½ æ·±é™·å›è°ƒåœ°ç‹±çš„æ—¶å€™ï¼Œæœ‰äººå‘Šè¯‰ä½ æœ‰ <code class=\"language-text\">async / await</code>ã€‚æŒºé…·çš„ä¸æ˜¯å—ï¼Ÿ</p>\n<p>å¦‚æœä½ æ˜¯é‚£ç§å–œæ¬¢åœ¨æŸç§ç¼–ç¨‹æ€æƒ³æˆä¸ºä¸»æµä¹‹å‰å‡ å¹´å°±æ—©æ—©å‘æ˜å®ƒä»¬çš„äººï¼Œç°åœ¨å°±æ˜¯ä¸€ä¸ªæ¢ç´¢ä»£æ•°æ•ˆåº”çš„å¥½æ—¶æœºã€‚è¿™æœ‰ç‚¹åƒåœ¨1999å¹´çš„æ—¶å€™å°±å¼€å§‹æ€è€ƒ <code class=\"language-text\">async / await</code>ï¼Œå¯ä»¥ä½†ä¹Ÿä¸æ˜¯<strong>å¿…é¡»</strong>çš„ã€‚</p>\n<h3 id=\"å¥½å§ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯ä»£æ•°æ•ˆåº”ï¼Ÿ\"><a href=\"#%E5%A5%BD%E5%90%A7%EF%BC%8C%E9%82%A3%E4%B9%88%E4%BB%80%E4%B9%88%E6%98%AF%E4%BB%A3%E6%95%B0%E6%95%88%E5%BA%94%EF%BC%9F\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å¥½å§ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯ä»£æ•°æ•ˆåº”ï¼Ÿ</h3>\n<p>è¿™ä¸ªåå­—å¯èƒ½æœ‰ç‚¹å“äººï¼Œä½†æ€æƒ³å¹¶ä¸å¤æ‚ã€‚å¦‚æœä½ ç†Ÿæ‚‰ <code class=\"language-text\">try / catch</code> è¯­æ³•å—çš„è¯ï¼Œä½ ä¹Ÿä¼šå¾ˆå¿«å¼„æ¸…ä»£æ•°æ•ˆåº”ã€‚</p>\n<p>å…ˆæ¥æ€»ç»“ä¸€ä¸‹ <code class=\"language-text\">try / catch</code>ã€‚å‡è®¾æœ‰ä¸€ä¸ªå‡½æ•°æŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯ï¼Œåœ¨å®ƒå’Œ <code class=\"language-text\">catch</code> ä¹‹é—´å¯èƒ½éš”äº†ä¸€å †å‡½æ•°ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  \t<span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A girl has no name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user1<span class=\"token punctuation\">,</span> user2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  user1<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  user2<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> arya <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gendry <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Gendry'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Oops, that didn't work out: \"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>æˆ‘ä»¬åœ¨ <code class=\"language-text\">getName</code> ä¸­ <code class=\"language-text\">throw</code> ä¸€ä¸ªé”™è¯¯ï¼Œä½†å®ƒç©¿è¿‡ <code class=\"language-text\">makeFriends</code>ï¼Œâ€œå†’æ³¡â€åˆ°äº†æœ€è¿‘çš„ <code class=\"language-text\">catch</code> å—ã€‚è¿™æ˜¯ <code class=\"language-text\">try / catch</code> çš„ä¸€ä¸ªé‡è¦å±æ€§ã€‚<strong>å¤„äºä¸­é—´çš„ä¸œè¥¿ä¸éœ€è¦å…³å¿ƒè‡ªèº«çš„é”™è¯¯å¤„ç†ã€‚</strong></p>\n<p>ä¸ C è¿™ç±»è¯­è¨€ä¸­çš„é”™è¯¯ç ä¸åŒï¼Œä½ ä¸ç”¨æ‰‹åŠ¨å±‚å±‚ä¼ é€’éšæ—¶æ‹…å¿ƒå¼„ä¸¢å®ƒä»¬ï¼Œæœ‰äº† <code class=\"language-text\">try / catch</code>ï¼Œé”™è¯¯ä¼šè‡ªåŠ¨ä¼ é€’ã€‚</p>\n<h3 id=\"è¿™å’Œä»£æ•°æ•ˆåº”æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ\"><a href=\"#%E8%BF%99%E5%92%8C%E4%BB%A3%E6%95%B0%E6%95%88%E5%BA%94%E6%9C%89%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB%E5%91%A2%EF%BC%9F\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è¿™å’Œä»£æ•°æ•ˆåº”æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</h3>\n<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¸€æ—¦å‘½ä¸­é”™è¯¯ï¼Œåé¢çš„ä»£ç å°±ä¸èƒ½ç»§ç»­æ‰§è¡Œäº†ã€‚å½“æˆ‘ä»¬è¿›å…¥ <code class=\"language-text\">catch</code> å—ï¼Œå°±æ— æ³•å†å›åˆ°åŸæ¥çš„ä»£ç ç»§ç»­æ‰§è¡Œã€‚</p>\n<p>ç»“æŸäº†ã€‚ä¸€åˆ‡éƒ½å¤ªæ™šäº†ã€‚è¿™æ—¶æˆ‘ä»¬èƒ½åšçš„å°±åªæœ‰ä»è¿è¡Œå¤±è´¥ä¸­æ¢å¤ï¼Œæˆ–è®¸è¿˜èƒ½ä»¥æŸç§æ–¹å¼é‡è¯•æˆ‘ä»¬æ­£åœ¨åšçš„äº‹æƒ…ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å¥‡è¿¹èˆ¬åœ°â€œå›åˆ°â€åŸæ¥çš„åœ°æ–¹ç„¶ååšä¸€äº›æ”¹å˜å—ï¼Ÿ<strong>æœ‰äº†ä»£æ•°æ•ˆåº”çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ã€‚</strong></p>\n<p>è¿™æ˜¯ä¸€ä¸ªç”¨å‡å®šçš„ JavaScript è¯­æ³•ï¼ˆä¸ºäº†å¥½ç©æˆ‘ä»¬ç§°ä¹‹ä¸º ES2025ï¼‰å†™çš„ä¾‹å­ï¼Œè®©æˆ‘ä»¬ä» <code class=\"language-text\">user.name</code> ç¼ºå¤±ä¸­<strong>æ¢å¤</strong>ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  \tname <span class=\"token operator\">=</span> perform <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user1<span class=\"token punctuation\">,</span> user2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  user1<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  user2<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> arya <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gendry <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Gendry'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  \tresume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>ï¼ˆæˆ‘å‘æ‰€æœ‰åœ¨2025å¹´æœç´¢â€œES2025â€ä½†æœå‡ºäº†è¿™ç¯‡æ–‡ç« çš„è¯»è€…é“æ­‰ã€‚å¦‚æœåˆ°æ—¶å€™ä»£æ•°æ•ˆåº”å·²ç»æˆäº† JavaScript çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä¼šå¾ˆä¹äºæ›´æ–°è¿™ç¯‡æ–‡ç« ï¼ï¼‰</strong></p>\n<p>æˆ‘ä»¬ç”¨ä¸€ä¸ªå‡å®šå…³é”®å­— <code class=\"language-text\">perform</code> æ›¿ä»£ <code class=\"language-text\">throw</code>ã€‚ç›¸åº”çš„ï¼Œæˆ‘ä»¬ç”¨å‡å®šçš„ <code class=\"language-text\">try / handle</code> æ›¿ä»£ <code class=\"language-text\">try / catch</code>ã€‚<strong>å…·ä½“çš„è¯­æ³•å¹¶ä¸é‡è¦ â€”â€” æˆ‘åªæ˜¯æƒ³å€Ÿä»€ä¹ˆä¸œè¥¿æ¥è¯´æ˜è¿™ä¸ªæ¦‚å¿µã€‚</strong></p>\n<p>è®©æˆ‘ä»¬è¿›ä¸€æ­¥çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š</p>\n<p>ä¸åƒä¹‹å‰é‚£æ ·æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¿™æ¬¡æˆ‘ä»¬<strong>æ‰§è¡Œäº†ä¸€ä¸ªæ•ˆåº”</strong>ã€‚å°±åƒæˆ‘ä»¬å¯ä»¥ <code class=\"language-text\">throw</code> ä»»ä½•å€¼ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¼ ç»™ <code class=\"language-text\">perform</code> ä»»ä½•å€¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä¼ å…¥çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…ä»»æ„å…¶ä»–æ•°æ®ç±»å‹ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  \tname <span class=\"token operator\">=</span> perform <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å½“æˆ‘ä»¬ <code class=\"language-text\">throw</code> ä¸€ä¸ªé”™è¯¯æ—¶ï¼Œå¼•æ“ä¼šåœ¨è°ƒç”¨å †æ ˆä¸­å¯»æ‰¾æœ€è¿‘çš„ <code class=\"language-text\">try / catch</code> é”™è¯¯å¤„ç†ã€‚åŒæ ·çš„ï¼Œå½“æˆ‘ä»¬<code class=\"language-text\">perform</code> ä¸€ä¸ªæ•ˆåº”æ—¶ï¼Œå¼•æ“åœ¨è°ƒç”¨å †æ ˆä¸­å¯»æ‰¾æœ€è¿‘çš„  <code class=\"language-text\">try / handle</code> <strong>æ•ˆåº”å¤„ç†</strong>ã€‚</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  \tresume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™ä¸ªæ•ˆåº”å‘Šè¯‰æˆ‘ä»¬å¦‚ä½•å¤„ç†åå­—å‚æ•°ç¼ºå¤±çš„æƒ…å†µã€‚è¿™é‡Œæ–°å¢çš„éƒ¨åˆ†ï¼ˆä¸ exception ç›¸å¯¹ï¼‰æ˜¯ä¸€ä¸ªå‡å®šçš„ <code class=\"language-text\">resume with</code>ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  \tresume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™æ˜¯ <code class=\"language-text\">try / catch</code> åšä¸åˆ°çš„ã€‚è¿™å¯ä»¥<strong>è·³å›æˆ‘ä»¬æ‰§è¡Œæ•ˆåº”çš„åœ°æ–¹ï¼Œå¹¶é€šè¿‡è¿™ä¸ªå¤„ç†è¯­å¥ä¼ å›ä¸€äº›ä¸œè¥¿ã€‚</strong> ğŸ¤¯</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  \t<span class=\"token comment\">// 1. æˆ‘ä»¬åœ¨è¿™é‡Œæ‰§è¡Œæ•ˆåº”</span></span>  \tname <span class=\"token operator\">=</span> perform <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  \t<span class=\"token comment\">// 4. ...æœ€åå›åˆ°è¿™é‡Œï¼ˆç°åœ¨ name æ˜¯ 'Arya Stark'ï¼‰äº†</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ...å·´æ‹‰å·´æ‹‰</span>\n\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// 2. æˆ‘ä»¬è¿›å…¥å¤„ç†ç¨‹åºï¼ˆç±»ä¼¼ try/catchï¼‰</span></span>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  \t<span class=\"token comment\">// 3. ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¸¦ä¸€ä¸ªå€¼ç»§ç»­æ‰§è¡Œï¼ˆä¸ try/catch ä¸åŒ!ï¼‰</span></span>  \tresume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>é€‚åº”è¿™ç§å†™æ³•éœ€è¦èŠ±ä¸€ç‚¹æ—¶é—´ï¼Œä½†è¿™åœ¨æ¦‚å¿µä¸Šè·Ÿâ€œæ–­ç‚¹ç»­ä¼ çš„ <code class=\"language-text\">try / catch</code>â€æ²¡ä»€ä¹ˆä¸åŒã€‚</p>\n<p>ä½†æ˜¯è¦æ³¨æ„ï¼Œ<strong>ä»£æ•°æ•ˆåº”æ¯” <code class=\"language-text\">try / catch</code> çµæ´»çš„å¤šï¼Œé”™è¯¯æ¢å¤åªæ˜¯ä¼—å¤šç”¨ä¾‹ä¸­çš„ä¸€ç§è€Œå·²ã€‚</strong>æˆ‘ä»¥æ­¤å¼€å¤´ï¼Œä¹Ÿåªæ˜¯å› ä¸ºå®ƒæœ€æ˜“äºç”¨æ¥è¡¨è¿°æˆ‘çš„æƒ³æ³•ã€‚</p>\n<h3 id=\"æ²¡æœ‰é¢œè‰²çš„å‡½æ•°\"><a href=\"#%E6%B2%A1%E6%9C%89%E9%A2%9C%E8%89%B2%E7%9A%84%E5%87%BD%E6%95%B0\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ²¡æœ‰é¢œè‰²çš„å‡½æ•°</h3>\n<p>ä»£æ•°æ•ˆåº”ä¸ºå¼‚æ­¥ä»£ç æä¾›äº†ä¸€äº›æœ‰è¶£çš„å¯ç¤ºã€‚</p>\n<p>åœ¨å®ç°äº† <code class=\"language-text\">async / await</code> çš„è¯­è¨€ä¸­ï¼Œ<a href=\"https://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å‡½æ•°å¸¸å¸¸æ˜¯æœ‰â€œé¢œè‰²â€çš„</a>ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ JavaScript é‡Œï¼Œæˆ‘ä»¬ä¸èƒ½å•å•å°† <code class=\"language-text\">getName</code> å˜æˆå¼‚æ­¥çš„è€Œä¸å¯¹ <code class=\"language-text\">makeFriends</code> ä»¥åŠè°ƒç”¨å®ƒçš„åœ°æ–¹é€ æˆâ€œå½±å“â€ï¼Œå®ƒä»¬éƒ½è¦å˜æˆ <code class=\"language-text\">async</code> çš„ã€‚æƒ³æƒ³å¦‚æœ<strong>ä¸€æ®µä»£ç éœ€è¦æ—¶è€Œæ˜¯åŒæ­¥çš„æ—¶è€Œæ˜¯å¼‚æ­¥çš„</strong>ï¼Œé‚£çœŸçš„ä¼šæŒºç—›è‹¦çš„ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// å¦‚æœæˆ‘ä»¬è¦æŠŠå®ƒå˜æˆå¼‚æ­¥çš„...</span>\n<span class=\"token keyword\">async</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// é‚£ä¹ˆè¿™é‡Œä¹Ÿè¦å˜æˆå¼‚æ­¥çš„...</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user1<span class=\"token punctuation\">,</span> user2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  user1<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  user2<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ä»¥æ­¤ç±»æ¨...</span></code></pre></div>\n<p>JavaScript generators ä¹Ÿæ˜¯<a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç±»ä¼¼çš„</a>ï¼šå¦‚æœä½ æ­£åœ¨å†™ generators çš„ä»£ç å°±ä¼šå‘ç°ï¼Œä¸­é—´çš„ä»£ç ä¸å¾—ä¸å»æ³¨æ„ generatorsã€‚</p>\n<p>æ‰€ä»¥è¿™å’Œæˆ‘ä»¬çš„ä¸»é¢˜æœ‰ä»€ä¹ˆå…³ç³»å—ï¼Ÿ</p>\n<p>æ¥ä¸‹æ¥çš„å‡ åˆ†é’Ÿï¼Œè®©æˆ‘ä»¬å…ˆå¿˜æ‰ <code class=\"language-text\">async / await</code> ç„¶åå›åˆ°æˆ‘ä»¬åˆšåˆšçš„ä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  \tname <span class=\"token operator\">=</span> perform <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user1<span class=\"token punctuation\">,</span> user2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  user1<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  user2<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> arya <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gendry <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Gendry'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  \tresume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>å¦‚æœæˆ‘ä»¬çš„æ•ˆåº”å¤„ç†å™¨å¹¶ä¸èƒ½åŒæ­¥è·å–â€œå¤‡ç”¨åå­—â€å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬æƒ³ä»æ•°æ®åº“ä¸­å–å¾—è¯¥å€¼å‘¢ï¼Ÿ</p>\n<p>äº‹å®è¯æ˜ï¼Œé€šè¿‡æ•ˆåº”å¤„ç†å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å¼‚æ­¥åœ°è°ƒç”¨ <code class=\"language-text\">resume with</code> è€Œæ— éœ€ä¿®æ”¹ <code class=\"language-text\">getName</code> æˆ– <code class=\"language-text\">makeFriends</code>ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  \tname <span class=\"token operator\">=</span> perform <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user1<span class=\"token punctuation\">,</span> user2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  user1<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  user2<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> arya <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gendry <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Gendry'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  \t<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      resume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  \t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨1ç§’åè°ƒç”¨ <code class=\"language-text\">resume with</code>ã€‚ä½ å¯ä»¥è®¤ä¸º <code class=\"language-text\">resume with</code> æ˜¯ä¸€ä¸ªåªèƒ½è°ƒç”¨ä¸€æ¬¡çš„å›è°ƒã€‚ï¼ˆä½ ä¹Ÿå¯ä»¥å«å®ƒâ€œå•æ¬¡é™å®šå»¶ç»­ï¼ˆcontinuationï¼‰â€ï¼Œè¿™æ ·èƒ½ç»™ä½ çš„æœ‹å‹ç•™ä¸‹æ·±åˆ»å°è±¡ã€‚ï¼‰</p>\n<p>ç°åœ¨ä»£æ•°æ•ˆåº”çš„æœºåˆ¶åº”è¯¥æ˜¯æ›´æ¸…æ™°ä¸€ç‚¹äº†ã€‚å½“æˆ‘ä»¬ <code class=\"language-text\">throw</code> ä¸€ä¸ªé”™è¯¯ï¼ŒJavaScript å¼•æ“é‡Šæ”¾å †æ ˆï¼Œé”€æ¯è¿è¡Œä¸­çš„å±€éƒ¨å˜é‡ã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬<code class=\"language-text\">perform</code> ä¸€ä¸ªæ•ˆåº”ï¼Œæˆ‘ä»¬å‡å®šçš„å¼•æ“ä¼šç”¨ä½™ä¸‹çš„å‡½æ•°åˆ›å»ºä¸€ä¸ªå›è°ƒï¼Œç„¶åç”¨ <code class=\"language-text\">resume with</code> å»è°ƒç”¨å®ƒã€‚</p>\n<p><strong>å†æ¬¡æé†’ï¼šå…·ä½“çš„è¯­æ³•å’Œå…³é”®å­—æ˜¯ä¸ºè¿™ç¯‡æ–‡ç« è€Œé€ çš„ã€‚å®ƒä»¬å¹¶ä¸æ˜¯é‡ç‚¹ï¼Œé‡ç‚¹æ˜¯å®ƒä»¬é˜è¿°çš„æœºåˆ¶ã€‚</strong></p>\n<h3 id=\"å…³äºçº¯å‡€\"><a href=\"#%E5%85%B3%E4%BA%8E%E7%BA%AF%E5%87%80\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å…³äºçº¯å‡€</h3>\n<p>æŠ›å¼€å‡½æ•°å¼ç¼–ç¨‹çš„ç ”ç©¶è°ˆä»£æ•°æ•ˆåº”æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºå®ƒä»¬è§£å†³çš„ä¸€äº›é—®é¢˜æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­ç‰¹æœ‰çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨<strong>ä¸</strong>å…è®¸éšæ„äº§ç”Ÿå‰¯ä½œç”¨çš„è¯­è¨€ï¼ˆåƒæ˜¯ Haskellï¼‰ä¸­ï¼Œå¿…é¡»ä½¿ç”¨åƒ Monads è¿™æ ·çš„æ¦‚å¿µæ¥å°†æ•ˆåº”å¼•å…¥ä½ çš„ç¨‹åºã€‚å¦‚æœä½ è¯»è¿‡ Monad çš„æ•™ç¨‹ï¼Œå°±ä¼šçŸ¥é“å®ƒä»¬ç†è§£èµ·æ¥æœ‰ç‚¹è¯¡å¼‚ã€‚ä»£æ•°æ•ˆåº”å¯ä»¥å¸®åŠ©ä½ èŠ±æ›´å°‘çš„ä»ªå¼å®ç°ç›¸ä¼¼çš„åŠŸèƒ½ã€‚</p>\n<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘å¯¹è¿™ä¹ˆå¤šä»£æ•°æ•ˆåº”çš„è®¨è®ºæ„Ÿåˆ°è´¹è§£ã€‚ï¼ˆå› ä¸ºæˆ‘<a href=\"/things-i-dont-know-as-of-2018/\">ä¸æ‡‚</a> Haskell å’Œ friendsã€‚ï¼‰ä½†æ˜¯æˆ‘ä¾ç„¶è®¤ä¸ºï¼Œå³ä½¿æ˜¯åœ¨ JavaScript è¿™æ ·ä¸çº¯çš„è¯­è¨€ä¸­ï¼Œ<strong>ä»£æ•°æ•ˆåº”å¯ä»¥ä½œä¸ºä¸€ç§å¼ºæœ‰åŠ›çš„å·¥å…·ï¼Œå°†ä»£ç ä¸­çš„ <em>what</em> å’Œ <em>how</em> åˆ†å¼€ã€‚</strong></p>\n<p>è¿™è®©ä½ åœ¨å†™ä»£ç æ—¶å¯ä»¥å…³æ³¨ä½ åœ¨åš<strong>ä»€ä¹ˆ</strong>ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">enumerateFiles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dir</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// æšä¸¾æ–‡ä»¶</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> contents <span class=\"token operator\">=</span> perform <span class=\"token function\">OpenDirectory</span><span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  perform <span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Enumerating files in '</span><span class=\"token punctuation\">,</span> dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> file <span class=\"token keyword\">of</span> contents<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  \tperform <span class=\"token function\">HandleFile</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">  perform <span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Enumerating subdirectories in '</span><span class=\"token punctuation\">,</span> dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> directory <span class=\"token keyword\">of</span> contents<span class=\"token punctuation\">.</span>dir<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// é€’å½’æˆ–è°ƒç”¨å…¶ä»–å‡½æ•°æ—¶ï¼Œä¹Ÿå¯ä½¿ç”¨ effectsã€‚</span>\n  \t<span class=\"token function\">enumerateFiles</span><span class=\"token punctuation\">(</span>directory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">  perform <span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Done'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>éšåï¼Œå°†å®ƒåŒ…åœ¨å®ç°äº†<strong>æ€ä¹ˆæ ·</strong>çš„å—é‡Œï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">let</span> files <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">enumerateFiles</span><span class=\"token punctuation\">(</span><span class=\"token string\">'C:\\\\'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Log</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  \tmyLoggingLibrary<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>effect<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  \tresume<span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">OpenDirectory</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  \tmyFileSystemImpl<span class=\"token punctuation\">.</span><span class=\"token function\">openDir</span><span class=\"token punctuation\">(</span>effect<span class=\"token punctuation\">.</span>dirName<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">contents</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      resume <span class=\"token keyword\">with</span> contents<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  \t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">HandleFile</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    files<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>effect<span class=\"token punctuation\">.</span>fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    resume<span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// ç°åœ¨ `files` æ•°ç»„ä¸­æœ‰æ‰€æœ‰çš„æ–‡ä»¶å•¦</span></code></pre></div>\n<p>è¿™æ„å‘³ç€è¿™äº›ç‰‡æ®µç”šè‡³å¯ä»¥æ‰“åŒ…æ”¶å½•èµ·æ¥ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> withMyLoggingLibrary <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'my-log'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> withMyFileSystem <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'my-fs'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ourProgram</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">enumerateFiles</span><span class=\"token punctuation\">(</span><span class=\"token string\">'C:\\\\'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">withMyLoggingLibrary</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">withMyFileSystem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">ourProgram</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¸åƒ <code class=\"language-text\">async / await</code> æˆ– Generatorsï¼Œ<strong>ä»£æ•°æ•ˆåº”ä¸ä¼šå¤æ‚åŒ–â€œä¸­é—´â€çš„å‡½æ•°</strong>ã€‚æˆ‘ä»¬çš„<code class=\"language-text\">enumerateFiles</code> å¯ä»¥åœ¨ <code class=\"language-text\">ourProgram</code> çš„æ·±å±‚åµŒå¥—ä¸­è¢«è°ƒç”¨ï¼Œå¯¹æ¯ä¸ªå¯èƒ½æ‰§è¡Œçš„æ•ˆåº”ï¼Œåªè¦<strong>ä¸Šé¢éšä¾¿å“ªé‡Œ</strong>æœ‰ä¸€ä¸ªå¯¹åº”çš„æ•ˆåº”å¤„ç†å™¨ï¼Œæˆ‘ä»¬çš„ä»£ç å°±ä¾ç„¶æœ‰æ•ˆã€‚</p>\n<p>æœ‰äº†æ•ˆåº”å¤„ç†å™¨ï¼Œæˆ‘ä»¬ä¸ç”¨å†™å¤ªå¤šä»ªå¼ä»£ç æˆ–æ ·æ¿ä»£ç å°±èƒ½è§£è€¦ç¨‹åºé€»è¾‘å’Œå…·ä½“å®ç°ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨æµ‹è¯•ä¸­æˆ‘ä»¬å¯ä»¥å®Œå…¨é‡å†™è¡Œä¸ºï¼Œç”¨å‡çš„æ–‡ä»¶ç³»ç»Ÿå’Œå¿«ç…§æ—¥å¿—æ¥ä»£æ›¿å°†å®ƒä»¬è¾“å‡ºåˆ°æ§åˆ¶å°ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> withFakeFileSystem <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'fake-fs'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">withLogSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fn</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> logs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  \t<span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  \t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Log</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  \t  logs<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>effect<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \t  resume<span class=\"token punctuation\">;</span>\n  \t<span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// Snapshot emitted logs.</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>logs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my program'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> fakeFiles <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token comment\">/* ... */</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">withFakeFileSystem</span><span class=\"token punctuation\">(</span>fakeFiles<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  \t<span class=\"token function\">withLogSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">\t  <span class=\"token function\">ourProgram</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  \t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å› ä¸ºè¿™é‡Œæ²¡æœ‰<a href=\"https://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">â€œå‡½æ•°é¢œè‰²â€</a>ï¼ˆåœ¨å…¶ä¸­çš„ä»£ç ä¸å¿…å…³å¿ƒæ•ˆåº”çš„å½±å“ï¼‰ä¸”æ•ˆåº”å¤„ç†å™¨æ˜¯<strong>å¯ç»„åˆ</strong>çš„ï¼ˆä½ å¯ä»¥åµŒå¥—å®ƒä»¬ï¼‰ï¼Œä½ å¯ä»¥ç”¨å®ƒä»¬åˆ›é€ æå…·è¡¨ç°åŠ›çš„æŠ½è±¡ã€‚</p>\n<h3 id=\"å…³äºç±»å‹\"><a href=\"#%E5%85%B3%E4%BA%8E%E7%B1%BB%E5%9E%8B\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å…³äºç±»å‹</h3>\n<p>å› ä¸ºä»£æ•°æ•ˆåº”æºäºé™æ€ç±»å‹è¯­è¨€ï¼Œæ‰€ä»¥å…³äºå®ƒä»¬å¤§éƒ¨åˆ†äº‰è®ºé›†ä¸­åœ¨å®ƒä»¬ç±»å‹è¡¨è¾¾çš„æ–¹å¼ã€‚è¿™æ— ç–‘æ˜¯é‡è¦çš„ï¼Œä½†åŒæ—¶ä¹Ÿè®©æŠŠæ¡æ¦‚å¿µå˜å¾—æœ‰æŒ‘æˆ˜äº†ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ç¯‡æ–‡ç« é€šç¯‡ä¸æç±»å‹ã€‚ä½†éœ€è¦æé†’çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°å¯ä»¥æ‰§è¡Œæ•ˆåº”ï¼Œé€šå¸¸æ¥è¯´è¿™ä¼šè¢«ç¼–ç è¿›å®ƒçš„ç±»å‹ç­¾åé‡Œã€‚æ‰€ä»¥ä½ ä¸èƒ½åœ¨ä¸€ä¸ªéšæœºæ•ˆåº”æ­£å‘ç”Ÿçš„æƒ…å†µä¸‹ç»“æŸï¼Œå¦åˆ™ä½ æ— æ³•è¿½è¸ªå®ƒä»¬çš„æ¥å¤„ã€‚</p>\n<p>ä½ å¯èƒ½ä¼šè¯´äº†ï¼Œè¿™æ ·çš„è¯åœ¨æŠ€æœ¯ä¸Šä»£æ•°æ•ˆåº”ä¹Ÿä¸ºå‡½æ•°<a href=\"https://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">â€œèµ‹äºˆäº†é¢œè‰²â€</a>ï¼Œå› ä¸ºåœ¨é™æ€ç±»å‹è¯­è¨€ä¸­æ•ˆåº”æ˜¯ç±»å‹ç­¾åçš„ä¸€éƒ¨åˆ†ã€‚æ˜¯è¿™æ ·æ²¡é”™ã€‚ä½†æ˜¯ï¼Œä¸ºäº†å¼•å…¥æ–°æ•ˆåº”è€Œä¿®å¤ä¸­é—´å‡½æ•°çš„ç±»å‹æ³¨é‡Šï¼ˆtype annotationï¼‰ï¼Œè¿™ä»¶äº‹æœ¬èº«ä¸æ˜¯è¯­ä¹‰æ›´æ”¹ â€”â€” è¿™è·Ÿå¼•å…¥ <code class=\"language-text\">async</code> æˆ–å°†å‡½æ•°è½¬ä¸º generator ä¸åŒã€‚è¿™ä¸ªæ¨æ–­è¿˜å¯ä»¥å¸®åŠ©é¿å…çº§è”æ›´æ”¹ã€‚ä¸€ä¸ªé‡è¦çš„åŒºåˆ«æ˜¯ï¼Œä½ å¯ä»¥é€šè¿‡å®ç°ä¸€ä¸ª noop æˆ– mock æ¥â€œå°å­˜â€ä¸€ä¸ªæ•ˆåº”ï¼ˆæ¯”å¦‚ï¼Œä¸€ä¸ªå¼‚æ­¥æ•ˆæœçš„åŒæ­¥è°ƒç”¨ï¼‰ï¼Œæœ‰å¿…è¦çš„è¯ï¼Œè¿™å¯ä»¥é˜²æ­¢å®ƒæ¥è§¦å¤–éƒ¨çš„ä»£ç  â€”â€” æˆ–è€…è½¬å˜ä¸ºä¸€ä¸ªä¸åŒçš„æ•ˆåº”ã€‚</p>\n<h3 id=\"æˆ‘ä»¬åº”è¯¥å°†ä»£æ•°æ•ˆåº”åŠ å…¥-javascript-å—ï¼Ÿ\"><a href=\"#%E6%88%91%E4%BB%AC%E5%BA%94%E8%AF%A5%E5%B0%86%E4%BB%A3%E6%95%B0%E6%95%88%E5%BA%94%E5%8A%A0%E5%85%A5-javascript-%E5%90%97%EF%BC%9F\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æˆ‘ä»¬åº”è¯¥å°†ä»£æ•°æ•ˆåº”åŠ å…¥ JavaScript å—ï¼Ÿ</h3>\n<p>è€å®è¯´ï¼Œæˆ‘ä¸çŸ¥é“ã€‚å®ƒä»¬éå¸¸çš„å¼ºå¤§ï¼Œå¯ä»¥è¯´å®ƒä»¬å¯¹äºåƒ JavaScript è¿™æ ·çš„è¯­è¨€æ¥è¯´æœ‰ç‚¹<strong>è¿‡äº</strong>å¼ºå¤§äº†ã€‚</p>\n<p>æˆ‘è®¤ä¸ºå®ƒä»¬éå¸¸é€‚åˆé‚£äº›å˜åŒ–ï¼ˆmutationï¼‰ä¸å¸¸è§ä¸”æ ‡å‡†åº“å®Œå…¨æ‹¥æŠ± effects çš„è¯­è¨€ã€‚å¦‚æœä½ æ—¥å¸¸ä¸»è¦åš <code class=\"language-text\">perform Timeout(1000)</code>ï¼Œ<code class=\"language-text\">perform Fetch(&#39;http://google.com&#39;)</code>ï¼Œä»¥åŠ <code class=\"language-text\">perform ReadFile(&#39;file.txt&#39;)</code>ï¼Œä¸”ä½ çš„è¯­è¨€æœ‰æ¨¡å¼åŒ¹é…å’Œæ•ˆåº”é™æ€ç±»å‹ï¼Œé‚£ä¹ˆè¿™ä¼šæ˜¯ä¸€ä¸ªéå¸¸æ£’çš„ç¼–ç¨‹ç¯å¢ƒã€‚</p>\n<p>ä¹Ÿè®¸è¿™ç§è¯­è¨€ç”šè‡³å¯ä»¥ç¼–è¯‘æˆ JavaScriptï¼</p>\n<h3 id=\"è¿™äº›æ€ä¹ˆå°±å’Œ-react-æœ‰å…³ç³»äº†ï¼Ÿ\"><a href=\"#%E8%BF%99%E4%BA%9B%E6%80%8E%E4%B9%88%E5%B0%B1%E5%92%8C-react-%E6%9C%89%E5%85%B3%E7%B3%BB%E4%BA%86%EF%BC%9F\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è¿™äº›æ€ä¹ˆå°±å’Œ React æœ‰å…³ç³»äº†ï¼Ÿ</h3>\n<p>å…¶å®æ²¡ä»€ä¹ˆå…³ç³»ã€‚ç”šè‡³å¯ä»¥è¯´è¿™åªæ˜¯ä¸€ä¸ªå»¶ä¼¸ã€‚</p>\n<p>å¦‚æœä½ çœ‹è¿‡æˆ‘<a href=\"https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å…³äºæ—¶é—´åˆ‡ç‰‡å’Œ Suspense çš„æ¼”è®²</a>ï¼Œç¬¬äºŒéƒ¨åˆ†è®²åˆ°ç»„ä»¶ä»ç¼“å­˜ä¸­è¯»å–æ•°æ®ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">MovieDetails</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> id <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// å¦‚æœæ•°æ®è¿˜æ²¡è¢«è¯·æ±‚å›æ¥å‘¢ï¼Ÿ</span>\n  <span class=\"token keyword\">const</span> movie <span class=\"token operator\">=</span> movieCache<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>ï¼ˆæ¼”è®²ä¸­ç”¨äº†ä¸€ä¸ªä¸å¤ªä¸€æ ·çš„ API ä½†è¿™å¹¶ä¸æ˜¯é‡ç‚¹ã€‚ï¼‰</strong></p>\n<p>è¿™æ„å»ºäºä¸€ä¸ªåä¸º â€œSuspenseâ€ çš„ React ç‰¹æ€§ä¹‹ä¸Šï¼Œé’ˆå¯¹è·å–æ•°æ®ç”¨ä¾‹ï¼Œæ­£åœ¨ç§¯æå¼€å‘ä¸­ã€‚å½“ç„¶äº†ï¼Œæœ‰è¶£çš„éƒ¨åˆ†åœ¨äºæ•°æ®å¯èƒ½è¿˜ä¸åœ¨ <code class=\"language-text\">movieCache</code> é‡Œ â€”â€” è¿™ç§æƒ…å†µæˆ‘ä»¬å°±æ— æ³•è¿›è¡Œä¸‹å»äº†ï¼Œæ‰€ä»¥éœ€è¦åšç‚¹<strong>ä»€ä¹ˆäº‹æƒ…</strong>ã€‚ä»æŠ€æœ¯çš„å±‚é¢æ¥è¯´ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹  <code class=\"language-text\">read()</code> è°ƒç”¨ä¼šæŠ›å‡ºä¸€ä¸ª Promiseï¼ˆæ˜¯çš„ï¼ŒæŠ›å‡ºä¸€ä¸ª Promise â€”â€” è¯·ç»†ç»†ä½“ä¼šï¼‰ã€‚è¿™â€œæš‚åœâ€äº†æ‰§è¡Œã€‚React æ•è·è¿™ä¸ª Promiseï¼Œå¹¶ä¸”è®°å¾—åœ¨ Promise è§£å†³åé‡è¯•ç»„ä»¶æ ‘çš„æ¸²æŸ“ã€‚ </p>\n<p>è™½è¯´è¿™ä¸ªæŠ€å·§çš„<a href=\"https://mobile.twitter.com/sebmarkbage/status/941214259505119232\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">çµæ„Ÿ</a>æºäºå®ƒä»¬ï¼Œä½†æœ¬èº«å¹¶ä¸æ˜¯ä¸ªä»£æ•°æ•ˆåº”ã€‚è¯è™½å¦‚æ­¤ï¼Œå®ƒä¹Ÿå®ç°äº†ç›¸åŒçš„ç›®æ ‡ï¼šåœ¨è°ƒç”¨æ ˆä¸­ï¼Œä¸‹é¢çš„ä»£ç æœä»äºä¸Šé¢çš„ä»€ä¹ˆä¸œè¥¿ï¼ˆåœ¨è¿™é‡Œæ˜¯ Reactï¼‰ï¼Œä¸­é—´çš„å‡½æ•°ä¸å¿…çŸ¥é“å®ƒæˆ–è€…è¢« <code class=\"language-text\">async</code> ã€ generators â€œè¼æ¯’â€ã€‚å½“ç„¶ï¼Œéšåæˆ‘ä»¬å¹¶ä¸èƒ½çœŸçš„åœ¨ JavaScript ä¸­<strong>æ¢å¤</strong>æ‰§è¡Œï¼Œä½†ä» React çš„è§’åº¦æ¥çœ‹ï¼Œåœ¨ Promise è§£å†³çš„æ—¶å€™é‡æ¸²æŸ“ç»„ä»¶æ ‘è·Ÿæ¢å¤æ‰§è¡Œæ²¡ä»€ä¹ˆåŒºåˆ«ã€‚åªè¦ä½ çš„ç¼–ç¨‹æ¨¡å‹<a href=\"/react-as-a-ui-runtime/#purity\">å‡å®šå¹‚ç­‰</a>ï¼Œå°±å¯ä»¥å‡è£…æˆ‘ä»¬å¯ä»¥æ¢å¤æ‰§è¡Œï¼</p>\n<p><a href=\"https://reactjs.org/docs/hooks-intro.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hooks</a> æ˜¯å¦ä¸€ä¸ªå¯èƒ½ä¼šè®©ä½ æƒ³èµ·ä»£æ•°æ•ˆåº”çš„ä¾‹å­ã€‚å¤§å®¶çš„ç¬¬ä¸€ä¸ªé—®é¢˜ä¸€èˆ¬æ˜¯ï¼š <code class=\"language-text\">useState</code> æ‰§è¡Œçš„æ—¶å€™æ€ä¹ˆçŸ¥é“å®ƒæŒ‡å‘å“ªä¸€ä¸ªç»„ä»¶ï¼Ÿ</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">LikeButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// useState æ€ä¹ˆçŸ¥é“è‡ªå·±åœ¨å“ªä¸€ä¸ªç»„ä»¶é‡Œï¼Ÿ</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isLiked<span class=\"token punctuation\">,</span> setIsLiked<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æˆ‘å·²ç»åœ¨<a href=\"/how-does-setstate-know-what-to-do/\">æ–‡ç« çš„ç»“å°¾å¤„</a>è§£é‡Šäº†ç­”æ¡ˆï¼šReact å¯¹è±¡ä¸Šæœ‰ä¸€ä¸ªå«â€œå½“å‰è°ƒåº¦å™¨â€çš„ mutable çŠ¶æ€ï¼ŒæŒ‡å‘ä½ æ­£åœ¨ä½¿ç”¨çš„å®ç°ï¼ˆæ¯”å¦‚ <code class=\"language-text\">react-dom</code> é‡Œçš„å®ç°ï¼‰ã€‚ç±»ä¼¼çš„ï¼Œæœ‰ä¸€ä¸ªâ€œå½“å‰ç»„ä»¶â€å±æ€§ï¼ŒæŒ‡å‘æˆ‘ä»¬ <code class=\"language-text\">LikeButton</code> ç»„ä»¶çš„å†…éƒ¨æ•°æ®ç»“æ„ã€‚è¿™å°±æ˜¯ <code class=\"language-text\">useState</code> å¦‚ä½•çŸ¥é“è¯¥åšä»€ä¹ˆçš„ç­”æ¡ˆã€‚</p>\n<p>åœ¨äººä»¬ä¹ æƒ¯ä¹‹å‰ï¼Œä»–ä»¬ä¼šè§‰å¾—è¿™æ ·åšæœ‰ç‚¹â€œè„â€ã€‚åŸå› å¾ˆæ˜æ˜¾ï¼šä¾èµ–ä¸€ä¸ªå…±äº«çš„ mutable çŠ¶æ€æ€»æ˜¯â€œæ„Ÿè§‰å“ªé‡Œä¸å¯¹â€ã€‚<strong>ï¼ˆæ—æ³¨ï¼šä½ è§‰å¾—åœ¨ JavaScript å¼•æ“é‡Œ <code class=\"language-text\">try / catch</code> æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿï¼‰</strong></p>\n<p>è¯åˆè¯´å›æ¥ï¼Œåœ¨æ¦‚å¿µä¸Šä½ å¯ä»¥è®¤ä¸º <code class=\"language-text\">useState()</code> æ˜¯ä¸€ä¸ª <code class=\"language-text\">perform State()</code> æ•ˆåº”ï¼Œåœ¨ç»„ä»¶æ‰§è¡Œæ—¶ç”± React å¤„ç†ã€‚è¿™å¯ä»¥â€œè§£é‡Šâ€ä¸ºä»€ä¹ˆ Reactï¼ˆè°ƒç”¨ä½ ç»„ä»¶çš„ä¸œè¥¿ï¼‰å¯ä»¥ä¸ºå®ƒæä¾›çŠ¶æ€ï¼ˆåœ¨è°ƒç”¨æ ˆä¸­ React åœ¨ä¸Šå±‚ï¼Œæ‰€ä»¥å¯ä»¥æä¾›æ•ˆåº”å¤„ç†å™¨ï¼‰ã€‚ç¡®å®ï¼Œåœ¨æˆ‘æ‰¾åˆ°çš„ä»£æ•°æ•ˆåº”æ•™ç¨‹ä¸­ï¼Œ<a href=\"https://github.com/ocamllabs/ocaml-effects-tutorial/#2-effectful-computations-in-a-pure-setting\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">çŠ¶æ€çš„å®ç°</a>æ˜¯æœ€å¸¸è§çš„ç¤ºä¾‹ä¹‹ä¸€ã€‚</p>\n<p>å½“ç„¶ï¼Œåœ¨æ­¤é‡ç”³ï¼Œå› ä¸º JavaScript é‡Œå¹¶æ²¡æœ‰ä»£æ•°æ•ˆåº”ï¼Œæ‰€ä»¥ React <strong>å®é™…ä¸Š</strong>ä¸æ˜¯è¿™æ ·è¿è¡Œçš„ã€‚å®é™…ä¸Šï¼Œæœ‰ä¸€ä¸ªéšè—å­—æ®µç”¨æ¥ä¿ç•™å½“å‰ç»„ä»¶ï¼Œåœ¨<code class=\"language-text\">useState</code> çš„å®ç°ä¸­ä¹Ÿæœ‰ä¸€ä¸ªå­—æ®µç”¨æ¥æŒ‡å‘å½“å‰â€œè°ƒåº¦å™¨â€ã€‚ä½œä¸ºæ€§èƒ½ä¼˜åŒ–ï¼Œå¯¹<a href=\"https://github.com/facebook/react/blob/2c4d61e1022ae383dd11fe237f6df8451e6f0310/packages/react-reconciler/src/ReactFiberHooks.js#L1260-L1290\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mounts å’Œ updates</a>ç”šè‡³åˆ†åˆ«å®ç°äº† <code class=\"language-text\">useState</code>ã€‚ä½†æ˜¯å¦‚æœä½ çœ¯ç€çœ¼ç”¨åŠ›çœ‹è¿™æ®µä»£ç ï¼Œå°±ä¼šå‘ç°å®ƒä»¬å®è´¨ä¸Šå°±æ˜¯æ•ˆåº”å¤„ç†å™¨ã€‚</p>\n<p>æ€»ç»“ä¸€ä¸‹ï¼Œåœ¨ JavaScript é‡Œï¼ŒæŠ›å‡ºè¡Œä¸ºå¯ä»¥ç²—ç•¥è¿‘ä¼¼äº IO æ•ˆåº”ï¼ˆåªè¦ä¹‹åé‡æ–°æ‰§è¡Œä»£ç æ˜¯å®‰å…¨çš„ï¼Œå¹¶ä¸”ä¸å— CPU é™åˆ¶ï¼‰ï¼Œå¯åœ¨ <code class=\"language-text\">try / finally</code> ä¸­æ¢å¤çš„ mutable â€œè°ƒåº¦å™¨â€å­—æ®µå¯ä»¥ç²—ç•¥è¿‘ä¼¼äºåŒæ­¥æ•ˆåº”å¤„ç†å™¨ã€‚</p>\n<p><a href=\"https://dev.to/yelouafi/algebraic-effects-in-javascript-part-4---implementing-algebraic-effects-and-handlers-2703\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é…åˆgeneratorsä½¿ç”¨</a>ä½ å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ›´æ¥è¿‘çœŸæ­£æ•ˆåº”çš„å®ç°ï¼Œä½†è¿™ä¹Ÿæ„å‘³ç€ä½ ä¸å¾—ä¸æ”¾å¼ƒ JavaScript å‡½æ•°â€œé€æ˜â€çš„æ€§è´¨ï¼Œä½ ä¸å¾—ä¸æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½å˜æˆ generatorã€‚è¿™ä¸ªâ€¦â€¦é¢ã€‚</p>\n<h3 id=\"äº†è§£æ›´å¤š\"><a href=\"#%E4%BA%86%E8%A7%A3%E6%9B%B4%E5%A4%9A\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>äº†è§£æ›´å¤š</h3>\n<p>ä¸ªäººæ¥è¯´ï¼Œä»£æ•°æ•ˆåº”ç»™æˆ‘å¸¦æ¥çš„æ„ä¹‰å¤šåˆ°è®©æˆ‘æƒŠè®¶ã€‚æˆ‘ä¸€ç›´åœ¨åŠªåŠ›ç†è§£åƒ Monads è¿™æ ·çš„æŠ½è±¡æ¦‚å¿µï¼Œè€Œä»£æ•°æ•ˆåº”â€œç‚¹â€é†’äº†æˆ‘ã€‚æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« ä¹Ÿèƒ½å¸®å®ƒä»¬â€œç‚¹â€é†’ä½ ã€‚</p>\n<p>æˆ‘ä¸çŸ¥é“å®ƒä»¬æ˜¯å¦ä¼šè¢«ä¸»æµæ‰€æ¥çº³ã€‚æˆ‘è§‰å¾—å¦‚æœåˆ°äº†2025å®ƒä»¬éƒ½æ²¡æœ‰æµè¡Œäºä»»ä½•ä¸»æµè¯­è¨€ï¼Œæˆ‘ä¼šå¾ˆå¤±æœ›ã€‚è¯·æé†’æˆ‘äº”å¹´åå†å›æ¥æ£€æŸ¥ï¼</p>\n<p>æˆ‘èƒ½ç¡®è®¤çš„æ˜¯ä½ å¯ä»¥ç”¨å®ƒä»¬åšæ›´å¤šçš„äº‹ â€”â€” ä½†å¦‚æœä¸ä¸Šæ‰‹å†™ä»£ç çš„è¯çœŸçš„å¾ˆéš¾ç†è§£å®ƒä»¬çš„å¼ºå¤§ä¹‹å¤„ã€‚å¦‚æœè¿™ç¯‡åšå®¢æ¿€èµ·äº†ä½ ä¸€ç‚¹å¥½å¥‡å¿ƒï¼Œè¿™é‡Œæœ‰ä¸€äº›ä½ å¯èƒ½æƒ³è¦æŸ¥é˜…çš„èµ„æ–™ï¼š</p>\n<ul>\n<li><a href=\"https://github.com/ocamllabs/ocaml-effects-tutorial\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/ocamllabs/ocaml-effects-tutorial</a></li>\n<li><a href=\"https://www.janestreet.com/tech-talks/effective-programming/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.janestreet.com/tech-talks/effective-programming/</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=hrBq8R_kxI0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.youtube.com/watch?v=hrBq8R_kxI0</a></li>\n</ul>\n<p>è¿˜æœ‰å¾ˆå¤šäººæŒ‡å‡ºï¼Œå¦‚æœå¿½ç•¥ç±»å‹éƒ¨åˆ†ï¼ˆå°±åƒæˆ‘åœ¨æ–‡ä¸­åšçš„é‚£æ ·ï¼‰ï¼Œä½ ä¼šå‘ç°åœ¨æ›´æ—©ä¹‹å‰ Common Lisp çš„<a href=\"https://en.wikibooks.org/wiki/Common_Lisp/Advanced_topics/Condition_System\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ¡ä»¶ç³»ç»Ÿ</a>ä¸­å°±å®ç°ç›¸å…³æŠ€æœ¯äº†ã€‚ä½ ä¹Ÿè®¸è¿˜å¾ˆæ¬£èµ James Long <a href=\"https://jlongster.com/Whats-in-a-Continuation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å…³äº continuations çš„åšå®¢</a>ï¼Œåšå®¢è§£é‡Šäº†åœ¨ç”¨æˆ·ç©ºé—´ä¸­ï¼Œ<code class=\"language-text\">call/cc</code> åŸç”Ÿæ€ä¹ˆä¹Ÿå¯ä»¥ä½œä¸ºæ„å»ºæ–­ç‚¹ç»­ä¼ å¼‚å¸¸çš„åŸºç¡€ã€‚</p>\n<p>å¦‚æœä½ æœ‰æ‰¾åˆ°å…¶ä»–é€‚ç”¨äº JavaScript èƒŒæ™¯å¼€å‘è€…çš„ä»£æ•°æ•ˆåº”ç›¸å…³æœ‰ç”¨èµ„æ–™ï¼Œè¯·åœ¨ Twitter ä¸Šå‘Šè¯‰æˆ‘ï¼</p>","timeToRead":18,"frontmatter":{"title":"é€šä¿—æ˜“æ‡‚çš„ä»£æ•°æ•ˆåº”","date":"July 21, 2019","spoiler":"å®ƒä»¬ä¸æ˜¯å¢¨è¥¿å“¥å·é¥¼ã€‚","cta":null},"fields":{"slug":"/zh-hans/algebraic-effects-for-the-rest-of-us/","langKey":"zh-hans"}}},"pageContext":{"slug":"/zh-hans/algebraic-effects-for-the-rest-of-us/","translations":["ja","ko","zh-hans"],"translatedLinks":[]}}}