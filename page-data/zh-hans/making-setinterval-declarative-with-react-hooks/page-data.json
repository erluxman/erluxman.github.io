{"componentChunkName":"component---src-templates-blog-post-js","path":"/zh-hans/making-setinterval-declarative-with-react-hooks/","result":{"data":{"site":{"siteMetadata":{"title":"Overreacted","author":"Dan Abramov"}},"markdownRemark":{"id":"c9cc8703-1de3-5e39-9555-468c71d92569","html":"<p>å¦‚æœä½ ç©äº†å‡ å°æ—¶çš„ <a href=\"https://reactjs.org/docs/hooks-intro.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React Hooks</a>ï¼Œä½ å¯èƒ½ä¼šé™·å…¥ä¸€ä¸ªçƒ¦äººçš„é—®é¢˜ï¼šåœ¨ç”¨ <code class=\"language-text\">setInterval</code> æ—¶æ€»ä¼š<a href=\"https://stackoverflow.com/questions/53024496/state-not-updating-when-using-react-state-hook-within-setinterval\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">åç¦»</a>è‡ªå·±æƒ³è¦çš„æ•ˆæœã€‚</p>\n<p>è¿™æ˜¯ Ryan Florence çš„<a href=\"https://mobile.twitter.com/ryanflorence/status/1088606583637061634\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">åŸè¯</a>ï¼š</p>\n<blockquote>\n<p>æˆ‘å·²ç»ç¢°åˆ°è®¸å¤šäººæåˆ°å¸¦æœ‰ setInterval çš„ hooks æ—¶å¸¸ä¼šæ‰“ React çš„è„¸ï¼Œä½†å› ä¸º stale state å¼•å‘çš„é—®é¢˜æˆ‘è¿˜æ˜¯å¤´ä¸€æ¬¡è§ã€‚ å¦‚æœåœ¨ hooks ä¸­è¿™ä¸ªé—®é¢˜æå…¶å›°éš¾ï¼Œé‚£ä¹ˆç›¸æ¯”äº class componentï¼Œæˆ‘ä»¬é‡åˆ°äº†ä¸åŒçº§åˆ«å¤æ‚åº¦çš„é—®é¢˜ã€‚</p>\n</blockquote>\n<p>è€å®è¯´ï¼Œæˆ‘è§‰å¾—è¿™äº›äººæ˜¯æœ‰ä¸€å¥—çš„ï¼Œè‡³å°‘ä¸ºæ­¤å›°æƒ‘äº†ã€‚</p>\n<p>ç„¶è€Œæˆ‘å‘ç°è¿™ä¸æ˜¯ Hooks çš„é—®é¢˜ï¼Œè€Œæ˜¯ <a href=\"/react-as-a-ui-runtime/\">Reactç¼–ç¨‹æ¨¡å‹</a> å’Œ <code class=\"language-text\">setInterval</code> ä¸åŒ¹é…é€ æˆçš„ã€‚Hooks æ¯” class æ›´è´´è¿‘ React ç¼–ç¨‹æ¨¡å‹ï¼Œä½¿è¿™ç§ä¸åŒ¹é…æ›´æ˜æ˜¾ã€‚</p>\n<p>åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° intervals å’Œ Hooks æ˜¯å¦‚ä½•ç©åœ¨ä¸€èµ·çš„ã€ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ¡ˆæœ‰æ„ä¹‰å’Œå¯ä»¥æä¾›å“ªäº›æ–°çš„åŠŸèƒ½ã€‚</p>\n<hr>\n<p><strong>å…è´£å£°æ˜ï¼šè¿™ç¯‡æ–‡ç« çš„é‡ç‚¹æ˜¯ä¸€ä¸ª <em>é—®é¢˜æ ·ä¾‹</em>ã€‚å³ä½¿ API å¯ä»¥ç®€åŒ–ä¸Šç™¾ç§æƒ…å†µï¼Œè®®è®ºå§‹ç»ˆæŒ‡å‘æ›´éš¾çš„é—®é¢˜ä¸Š</strong>ã€‚</p>\n<p>å¦‚æœä½ åˆšå…¥æ‰‹ Hooks ä¸”ä¸çŸ¥é“è¿™å„¿åœ¨è¯´ä»€ä¹ˆï¼Œå…ˆæŸ¥çœ‹ <a href=\"https://juejin.im/post/5be98a87f265da616e4bf8a4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è¿™ä¸ªä»‹ç»</a> å’Œ <a href=\"https://reactjs.org/docs/hooks-intro.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ–‡æ¡£</a>ã€‚è¿™ç¯‡æ–‡ç« å‡è®¾ä½ å·²ç»ä½¿ç”¨ Hooks è¶…è¿‡ä¸€ä¸ªå°æ—¶ã€‚</p>\n<hr>\n<h2 id=\"ç›´æ¥ç»™æˆ‘çœ‹ä»£ç \"><a href=\"#%E7%9B%B4%E6%8E%A5%E7%BB%99%E6%88%91%E7%9C%8B%E4%BB%A3%E7%A0%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç›´æ¥ç»™æˆ‘çœ‹ä»£ç </h2>\n<p>ä¸ç”¨å¤šè¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯ç§’é€’å¢çš„è®¡æ•°å™¨ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect<span class=\"token punctuation\">,</span> useRef <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// ä½ è‡ªå·±çš„ä»£ç </span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>ï¼ˆè¿™æ˜¯ <a href=\"https://codesandbox.io/s/105x531vkq\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandbox demo</a>ï¼‰ã€‚</em></p>\n<p>demoé‡Œé¢çš„ <code class=\"language-text\">useInterval</code> ä¸æ˜¯ä¸€ä¸ªå†…ç½® React Hookï¼Œè€Œæ˜¯ä¸€ä¸ªæˆ‘å†™çš„ <a href=\"https://reactjs.org/docs/hooks-custom.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">custom Hook</a>ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect<span class=\"token punctuation\">,</span> useRef <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">callback<span class=\"token punctuation\">,</span> delay</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> savedCallback <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ä¿å­˜æ–°å›è°ƒ</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    savedCallback<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> callback<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// å»ºç«‹ interval</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      savedCallback<span class=\"token punctuation\">.</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>delay <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>delay<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>(è¿™æ˜¯å‰é¢çš„demoä¸­ï¼Œä½ å¯èƒ½é”™è¿‡çš„ <a href=\"https://codesandbox.io/s/105x531vkq\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandbox demo</a>ã€‚)</em></p>\n<p><strong>æˆ‘çš„ <code class=\"language-text\">useInterval</code> Hook å†…ç½®äº†ä¸€ä¸ª interval å¹¶åœ¨ unmounting çš„æ—¶å€™æ¸…é™¤</strong>ï¼Œå®ƒæ˜¯ä¸€ä¸ªä½œç”¨åœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸé‡Œçš„ <code class=\"language-text\">setInterval</code> å’Œ <code class=\"language-text\">clearInterval</code> çš„ç»„åˆã€‚</p>\n<p>ä½ å¯ä»¥éšæ„å°†å®ƒå¤åˆ¶ç²˜è´´åˆ°é¡¹ç›®ä¸­æˆ–è€…ç”¨ npm å¯¼å…¥ã€‚</p>\n<p><strong>å¦‚æœä½ ä¸åœ¨ä¹å®ƒæ˜¯æ€ä¹ˆå®ç°çš„ï¼Œä½ å¯ä»¥åœæ­¢é˜…è¯»äº†ï¼æ¥ä¸‹æ¥çš„éƒ¨åˆ†æ˜¯ç»™æƒ³æ·±åº¦æŒ–æ˜ React Hooks çš„ä¹¡äº²ä»¬å‡†å¤‡çš„</strong>ã€‚</p>\n<hr>\n<h2 id=\"ç­‰ä»€ä¹ˆ-\"><a href=\"#%E7%AD%89%E4%BB%80%E4%B9%88-\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç­‰ä»€ä¹ˆ?! ğŸ¤”</h2>\n<p>æˆ‘çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆï¼š</p>\n<blockquote>\n<p>Danï¼Œè¿™æ®µä»£ç æ ¹æœ¬æ²¡ä»€ä¹ˆæ„æ€ï¼Œã€Œå•å•æ˜¯ JavaScriptã€èƒ½æœ‰ä»€ä¹ˆï¼Ÿæ‰¿è®¤ React ç”¨ Hooks é’“åˆ°äº† ã€Œé²¨é±¼ã€ å§ï¼</p>\n</blockquote>\n<p><strong>ä¸€å¼€å§‹æˆ‘ä¹Ÿæ˜¯è¿™æ ·æƒ³çš„ï¼Œä½†åæ¥æˆ‘æ”¹å˜æƒ³æ³•äº†ï¼Œæˆ‘ä¹Ÿè¦æ”¹å˜ä½ çš„</strong>ã€‚åœ¨è§£é‡Šè¿™æ®µä»£ç ä¸ºä»€ä¹ˆæœ‰æ„ä¹‰ä¹‹å‰ï¼Œæˆ‘æƒ³å±•ç¤ºä¸‹å®ƒèƒ½åšä»€ä¹ˆã€‚</p>\n<hr>\n<h2 id=\"ä¸ºä»€ä¹ˆ-useinterval-æ˜¯æ›´å¥½çš„api\"><a href=\"#%E4%B8%BA%E4%BB%80%E4%B9%88-useinterval-%E6%98%AF%E6%9B%B4%E5%A5%BD%E7%9A%84api\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ä¸ºä»€ä¹ˆ <code class=\"language-text\">useInterval()</code> æ˜¯æ›´å¥½çš„API</h2>\n<p>æé†’ä½ ä¸‹ï¼Œæˆ‘çš„ <code class=\"language-text\">useInterval</code> Hook æ¥æ”¶ ä¸€ä¸ª function å’Œ ä¸€ä¸ª delay å‚æ•°ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™æ ·çœ‹èµ·å¾ˆåƒ <code class=\"language-text\">setInterval</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>æ‰€ä»¥ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ <code class=\"language-text\">setInterval</code> å‘¢</strong>ï¼Ÿ</p>\n<p>ä¸€å¼€å§‹å¯èƒ½ä¸æ˜æ˜¾ï¼Œä½†ä½ å‘ç°æˆ‘çš„ <code class=\"language-text\">useInterval</code> ä¸ <code class=\"language-text\">setInterval</code> ä¹‹é—´çš„ä¸åŒåï¼Œä½ ä¼šçœ‹å‡º <strong>å®ƒçš„å‚æ•°æ˜¯ã€ŒåŠ¨æ€åœ°ã€</strong>ã€‚</p>\n<p>æˆ‘å°†ç”¨å…·ä½“çš„ä¾‹å­æ¥è¯´æ˜è¿™ä¸€ç‚¹ã€‚</p>\n<hr>\n<p>å‡è®¾æˆ‘ä»¬å¸Œæœ› delay å¯è°ƒï¼š</p>\n<p><img src=\"/35e4f35a8585255b11c090aed9f72433/counter_delay.gif\" alt=\"Counter with an input that adjusts the interval delay\"></p>\n<p>è™½ç„¶ä½ ä¸ä¸€å®šè¦ç”¨åˆ°è¾“å…¥æ§åˆ¶ delayï¼Œä½†åŠ¨æ€è°ƒæ•´å¯èƒ½å¾ˆæœ‰ç”¨ â€”â€” ä¾‹å¦‚ï¼Œç”¨æˆ·åˆ‡æ¢åˆ°å…¶ä»–é€‰é¡¹å¡æ—¶ï¼Œè¦å‡å°‘ AJAX è½®è¯¢æ›´æ–°é—´éš”ã€‚</p>\n<p>æ‰€ä»¥åœ¨ class é‡Œä½ è¦æ€ä¹ˆç”¨ <code class=\"language-text\">setInterval</code> åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿæˆ‘ä¼šè¿™ä¹ˆåšï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Counter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    count<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    delay<span class=\"token operator\">:</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>interval <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tick<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> prevState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevState<span class=\"token punctuation\">.</span>delay <span class=\"token operator\">!==</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>delay<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>interval<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>interval <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tick<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>interval<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function-variable function\">tick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      count<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function-variable function\">handleDelayChange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> delay<span class=\"token operator\">:</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>delay<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleDelayChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>ï¼ˆè¿™æ˜¯ <a href=\"https://codesandbox.io/s/mz20m600mp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandbox demo</a>ã€‚ï¼‰</em></p>\n<p>è¿™æ ·ä¹Ÿä¸é”™ï¼</p>\n<p>Hook ç‰ˆæœ¬çœ‹èµ·æ¥æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Ÿ</p>\n<p><font size=\"50\">ğŸ¥ğŸ¥ğŸ¥</font></p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>delay<span class=\"token punctuation\">,</span> setDelay<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// è¿™æ˜¯ä½ çš„è‡ªå®šä¹‰é€»è¾‘</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleDelayChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setDelay</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>delay<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleDelayChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>ï¼ˆè¿™æ˜¯ <a href=\"https://codesandbox.io/s/mz20m600mp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandbox demo</a>ã€‚ï¼‰</em></p>\n<p>æ˜¯çš„ï¼Œ<em>è¿™å°±æ˜¯å…¨éƒ¨äº†</em>ã€‚</p>\n<p>ä¸åƒ class çš„ç‰ˆæœ¬ï¼Œ<code class=\"language-text\">useInterval</code> Hook ä¾‹å­ä¸­ï¼Œã€Œæ›´æ–°ã€æˆåŠ¨æ€è°ƒæ•´ delay å¾ˆç®€å•ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token comment\">// å›ºå®š delay</span>\n  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token comment\">// å¯è°ƒæ•´ delay</span>\n  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>å½“ <code class=\"language-text\">useInterval</code> Hook æ¥æ”¶åˆ°ä¸åŒ delayï¼Œå®ƒä¼šé‡è®¾ intervalã€‚</p>\n<p><strong>å£°æ˜ä¸€ä¸ªå¸¦æœ‰åŠ¨æ€è°ƒæ•´ delay çš„ intervalï¼Œæ¥æ›¿ä»£å†™ <em>æ·»åŠ </em>å’Œ<em>æ¸…é™¤</em> interval çš„ä»£ç  â€”â€” <code class=\"language-text\">useInterval</code> Hook å¸®æˆ‘ä»¬åšåˆ°äº†</strong>ã€‚</p>\n<p>å¦‚æœæˆ‘æƒ³æš‚æ—¶ <em>æš‚åœ</em> interval è¦æ€ä¹ˆåšï¼Ÿæˆ‘å¯ä»¥ç”¨ä¸€ä¸ª state æ¥åšåˆ°ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>delay<span class=\"token punctuation\">,</span> setDelay<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isRunning<span class=\"token punctuation\">,</span> setIsRunning<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> isRunning <span class=\"token operator\">?</span> delay <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p><em>ï¼ˆè¿™æ˜¯ <a href=\"https://codesandbox.io/s/l240mp2pm7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">demo</a>!ï¼‰</em></p>\n<p>è¿™è®©æˆ‘å¯¹ React å’Œ Hooks å†æ¬¡æ„Ÿåˆ°å…´å¥‹ã€‚æˆ‘ä»¬å¯ä»¥åŒ…è£…ç°æœ‰çš„å‘½ä»¤å¼ APIs å’Œåˆ›å»ºæ›´è´´è¿‘è¡¨è¾¾æˆ‘ä»¬æ„å›¾çš„å£°æ˜å¼ APIsã€‚å°±æ‹¿æ¸²æŸ“æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶å‡†ç¡®åœ°æè¿°æ¯ä¸ªæ—¶é—´ç‚¹è¿‡ç¨‹ï¼Œè€Œä¸ç”¨å°å¿ƒåœ°ç”¨æŒ‡ä»¤æ¥æ“ä½œå®ƒã€‚</p>\n<hr>\n<p>æˆ‘å¸Œæœ›åˆ°è¿™é‡Œä½ ä»¬å¼€å§‹è§‰å¾— <code class=\"language-text\">useInterval()</code> Hook æ˜¯ä¸€ä¸ªæ›´å¥½çš„ API äº† â€”â€” è‡³å°‘å’Œç»„ä»¶æ¯”ã€‚</p>\n<p><strong>ä½†ä¸ºä»€ä¹ˆåœ¨ Hooks ä¸­ä½¿ç”¨ <code class=\"language-text\">setInterval()</code> å’Œ <code class=\"language-text\">clearInterval()</code> è®©äººå¿ƒçƒ¦å‘¢</strong>ï¼Ÿè®©æˆ‘ä»¬å›åˆ°è®¡æ•°å™¨ä¾‹å­å¹¶è¯•ç€æ‰‹åŠ¨å®ç°å®ƒã€‚</p>\n<hr>\n<h2 id=\"ç¬¬ä¸€æ¬¡å°è¯•\"><a href=\"#%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%B0%9D%E8%AF%95\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¬¬ä¸€æ¬¡å°è¯•</h2>\n<p>æˆ‘ä¼šä»ä¸€ä¸ªåªæ¸²æŸ“åˆå§‹çŠ¶æ€çš„ç®€å•ä¾‹å­å¼€å§‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ç°åœ¨æˆ‘æƒ³è¦ä¸€ä¸ªæ¯ç§’å¢åŠ çš„ intervalï¼Œå®ƒæ˜¯ä¸€ä¸ª<a href=\"https://reactjs.org/docs/hooks-effect.html#effects-with-cleanup\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">éœ€è¦æ¸…ç†å‰¯ä½œç”¨</a>çš„ï¼Œæ‰€ä»¥æˆ‘å°†ç”¨åˆ° <code class=\"language-text\">useEffect()</code> å¹¶è¿”å›æ¸…ç†å‡½æ•°ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>ï¼ˆæŸ¥çœ‹ <a href=\"https://codesandbox.io/s/7wlxk1k87j\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandbox demo</a>.ï¼‰</em></p>\n<p>è¿™ç§å·¥ä½œçœ‹èµ·æ¥å¾ˆç®€å•å¯¹å§ï¼Ÿ</p>\n<p><strong>ä½†æ˜¯ï¼Œè¿™ä»£ç æœ‰ä¸€ä¸ªå¥‡æ€ªçš„è¡Œä¸º</strong>ã€‚</p>\n<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒReact ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åé‡æ‰§è¡Œ effectsï¼Œè¿™æ˜¯æœ‰ç›®çš„çš„ï¼Œè¿™æœ‰åŠ©äºé¿å… React class ç»„ä»¶çš„<a href=\"https://reactjs.org/docs/hooks-effect.html#explanation-why-effects-run-on-each-update\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æŸç§ bugs</a>ã€‚</p>\n<p>è¿™é€šå¸¸æ˜¯å¥½çš„ï¼Œå› ä¸ºéœ€è¦è®¸å¤šè®¢é˜… API å¯ä»¥éšæ—¶é¡ºæ‰‹ç§»é™¤è€çš„ç›‘å¬è€…å’ŒåŠ ä¸ªæ–°çš„ã€‚ä½†æ˜¯ï¼Œ<code class=\"language-text\">setInterval</code> å’Œå®ƒä»¬ä¸ä¸€æ ·ã€‚å½“æˆ‘ä»¬æ‰§è¡Œ <code class=\"language-text\">clearInterval</code> å’Œ <code class=\"language-text\">setInterval</code> æ—¶ï¼Œå®ƒä»¬ä¼šè¿›å…¥æ—¶é—´é˜Ÿåˆ—é‡Œï¼Œå¦‚æœæˆ‘ä»¬é¢‘ç¹é‡æ¸²æŸ“å’Œé‡æ‰§è¡Œ effectsï¼Œinterval æœ‰å¯èƒ½æ²¡æœ‰æœºä¼šè¢«æ‰§è¡Œï¼</p>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥<em>æ›´çŸ­</em>é—´éš”é‡æ¸²æŸ“æˆ‘ä»¬çš„ç»„ä»¶ï¼Œæ¥å‘ç°è¿™ä¸ª bugï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// é‡æ¸²æŸ“å’Œé‡æ‰§è¡Œ Counter çš„ effects</span>\n  <span class=\"token comment\">// è¿™é‡Œä¼šå‘ç”Ÿ clearInterval()</span>\n  <span class=\"token comment\">// åœ¨ interval è¢«æ‰§è¡Œå‰ setInterval()</span>\n  ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Counter</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span> rootElement<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><em>ï¼ˆçœ‹è¿™ä¸ª bug çš„ <a href=\"https://codesandbox.io/s/9j86r218y4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">demo</a>ï¼‰</em></p>\n<hr>\n<h2 id=\"ç¬¬äºŒæ¬¡å°è¯•\"><a href=\"#%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%B0%9D%E8%AF%95\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¬¬äºŒæ¬¡å°è¯•</h2>\n<p>ä½ å¯èƒ½çŸ¥é“ <code class=\"language-text\">useEffect()</code> å…è®¸æˆ‘ä»¬<a href=\"https://reactjs.org/docs/hooks-effect.html#tip-optimizing-performance-by-skipping-effects\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><em>é€‰æ‹©æ€§åœ°</em></a>è¿›è¡Œé‡æ‰§è¡Œ effectsï¼Œä½ å¯ä»¥è®¾å®šä¸€ä¸ªä¾èµ–æ•°ç»„ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼ŒReact åªä¼šåœ¨æ•°ç»„é‡Œçš„æŸä¸ªå‘ç”Ÿå˜åŒ–æ—¶é‡è¿è¡Œï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  document<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You clicked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>count<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> times</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>å½“æˆ‘ä»¬ <em>åª</em> æƒ³åœ¨ mount æ—¶æ‰§è¡Œ effect å’Œ unmount æ—¶æ¸…ç†å®ƒï¼Œæˆ‘ä»¬å¯ä»¥ä¼ ç©º <code class=\"language-text\">[]</code> çš„ä¾èµ–æ•°ç»„ã€‚</p>\n<p>ä½†æ˜¯ï¼Œå¦‚æœä½ ä¸ç†Ÿæ‚‰ JavaScript çš„é—­åŒ…ï¼Œä¼šç¢°åˆ°ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ã€‚æˆ‘ä»¬ç°åœ¨å°±æ¥åˆ¶é€ è¿™ä¸ªé”™è¯¯ï¼ï¼ˆæˆ‘ä»¬è¿˜å»ºç«‹äº†ä¸€ä¸ªå°½æ—©åé¦ˆè¿™ä¸ªé”™è¯¯çš„ <a href=\"https://github.com/facebook/react/pull/14636\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">lint è§„åˆ™</a>ï¼Œä½†è¿˜æ²¡å‡†å¤‡å¥½ã€‚ï¼‰</p>\n<p>åœ¨ç¬¬ä¸€æ¬¡å°è¯•ä¸­ï¼Œæˆ‘ä»¬çš„é—®é¢˜æ˜¯é‡è¿è¡Œ effects æ—¶ä½¿å¾— timer è¿‡æ—©è¢«æ¸…é™¤ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä¸é‡è¿è¡Œå»ä¿®å¤å®ƒä»¬ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä½†æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬çš„è®¡æ—¶å™¨æ›´æ–°åˆ° 1 å°±ä¸åŠ¨äº†ã€‚ï¼ˆ<a href=\"https://codesandbox.io/s/jj0mk6y683\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æŸ¥çœ‹çœŸå® bug</a>ã€‚ï¼‰</p>\n<p>å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿï¼</p>\n<p><strong>é—®é¢˜åœ¨äºï¼Œ<code class=\"language-text\">useEffect</code> åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶è·å–å€¼ä¸º 0 çš„ <code class=\"language-text\">count</code></strong>ï¼Œæˆ‘ä»¬ä¸å†é‡æ‰§è¡Œ effectï¼Œæ‰€ä»¥ <code class=\"language-text\">setInterval</code> ä¸€ç›´å¼•ç”¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶çš„é—­åŒ… <code class=\"language-text\">count</code>ï¼Œä»¥è‡³äº <code class=\"language-text\">count + 1</code> ä¸€ç›´æ˜¯ <code class=\"language-text\">1</code>ã€‚å“å‘€å‘€ï¼</p>\n<p><strong>æˆ‘å¯ä»¥å¬è§ä½ å’¬ç‰™åˆ‡é½¿äº†ï¼ŒHooks çœŸçƒ¦äººå¯¹å§</strong>ï¼Ÿ</p>\n<p>ä¿®å¤å®ƒçš„<a href=\"https://codesandbox.io/s/j379jxrzjy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ä¸€ç§æ–¹æ³•</a>æ˜¯ç”¨åƒ <code class=\"language-text\">setCount(c =&gt; c + 1)</code> è¿™æ ·çš„ ã€Œupdaterã€æ›¿æ¢ <code class=\"language-text\">setCount(count + 1)</code>ï¼Œè¿™æ ·å¯ä»¥è¯»åˆ°æ–° state å˜é‡ã€‚ä½†è¿™ä¸ªæ— æ³•å¸®åŠ©ä½ è·å–åˆ°æ–°çš„ propsã€‚</p>\n<p><a href=\"https://codesandbox.io/s/00o9o95jyv\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å¦ä¸€ä¸ªæ–¹æ³•</a>æ˜¯ç”¨ <a href=\"https://reactjs.org/docs/hooks-reference.html#usereducer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">useReducer()</code></a>ã€‚è¿™ç§æ–¹æ³•ä¸ºä½ æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚åœ¨ reducer ä¸­ï¼Œä½ å¯ä»¥è®¿é—®åˆ°å½“å‰ state å’Œæ–°çš„ propsã€‚<code class=\"language-text\">dispatch</code> æ–¹æ³•æœ¬èº«æ°¸è¿œä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä»ä»»ä½•é—­åŒ…ä¸­å°†æ•°æ®æ”¾å…¥å…¶ä¸­ã€‚<code class=\"language-text\">useReducer()</code> æœ‰ä¸ªçº¦æŸæ˜¯ä½ ä¸å¯ä»¥ç”¨å®ƒæ‰§è¡Œå‰¯ä½œç”¨ã€‚ï¼ˆä½†æ˜¯ï¼Œä½ å¯ä»¥è¿”å›æ–°çŠ¶æ€ â€”â€” è§¦å‘ä¸€äº› effectã€‚ï¼‰</p>\n<p><strong>ä½†ä¸ºä»€ä¹ˆè¦å˜å¾—è¿™ä¹ˆå¤æ‚</strong>ï¼Ÿ</p>\n<hr>\n<h2 id=\"é˜»æŠ—ä¸åŒ¹é…\"><a href=\"#%E9%98%BB%E6%8A%97%E4%B8%8D%E5%8C%B9%E9%85%8D\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>é˜»æŠ—ä¸åŒ¹é…</h2>\n<p>è¿™ä¸ªæœ¯è¯­æœ‰æ—¶ä¼šè¢«æåˆ°ï¼Œ<a href=\"https://haacked.com/archive/2004/06/15/impedance-mismatch.aspx/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Phil Haack</a> è§£é‡Šå¦‚ä¸‹ï¼š</p>\n<blockquote>\n<p>æœ‰äººè¯´æ•°æ®åº“æ¥è‡ªç«æ˜Ÿè€Œå¯¹è±¡æ¥è‡ªé‡‘æ˜Ÿï¼Œæ•°æ®åº“ä¸ä¼šè‡ªç„¶åœ°æ˜ å°„åˆ°å¯¹è±¡æ¨¡å‹ã€‚è¿™å¾ˆåƒè¯•å›¾å°†ç£é“çš„ä¸¤ææ¨åˆ°ä¸€èµ·ã€‚</p>\n</blockquote>\n<p>æˆ‘ä»¬çš„ã€Œé˜»æŠ—åŒ¹é…ã€ä¸åœ¨æ•°æ®åº“å’Œå¯¹è±¡ä¹‹é—´ï¼Œå®ƒåœ¨ React ç¼–ç¨‹æ¨¡å‹å’Œå‘½ä»¤å¼ <code class=\"language-text\">setInterval</code> API ä¹‹é—´ã€‚</p>\n<p><strong>ä¸€ä¸ª React ç»„ä»¶å¯èƒ½åœ¨ mounted ä¹‹å‰æµç»è®¸å¤šä¸åŒçš„ stateï¼Œä½†å®ƒçš„æ¸²æŸ“ç»“æœå°†<em>ä¸€æ¬¡æ€§å…¨éƒ¨</em>æè¿°å‡ºæ¥</strong>ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token comment\">// æè¿°æ¯æ¬¡æ¸²æŸ“</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Hooks ä½¿æˆ‘ä»¬æŠŠç›¸åŒçš„å£°æ˜æ–¹æ³•ç”¨åœ¨ effects ä¸Šï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token comment\">// æè¿°æ¯ä¸ªé—´éš”çŠ¶æ€</span>\n  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> isRunning <span class=\"token operator\">?</span> delay <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>æˆ‘ä»¬ä¸<em>è®¾ç½®</em> intervalï¼Œä½†æŒ‡å®šå®ƒ<em>æ˜¯å¦</em>è®¾ç½®å»¶è¿Ÿæˆ–å»¶è¿Ÿå¤šå°‘ï¼Œæˆ‘ä»¬çš„ Hooks åšåˆ°äº†ï¼Œç”¨ç¦»æ•£æœ¯è¯­æè¿°è¿ç»­è¿‡ç¨‹</p>\n<p><strong>ç›¸åï¼Œ<code class=\"language-text\">setInterval</code> æ²¡æœ‰åŠæ—¶åœ°æè¿°è¿‡ç¨‹ â€”â€” ä¸€æ—¦è®¾å®šäº† intervalï¼Œé™¤äº†æ¸…é™¤å®ƒï¼Œä½ æ— æ³•å¯¹å®ƒåšä»»ä½•æ”¹å˜</strong>ã€‚</p>\n<p>è¿™å°±æ˜¯ React æ¨¡å‹å’Œ <code class=\"language-text\">setInterval</code> API ä¹‹é—´çš„ä¸åŒ¹é…ã€‚</p>\n<hr>\n<p>React ç»„ä»¶ä¸­çš„ props å’Œ state æ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œ React ä¼šé‡æ¸²æŸ“å®ƒä»¬ä¸”ã€Œä¸¢å¼ƒã€ä»»ä½•å…³äºä¸Šä¸€æ¬¡æ¸²æŸ“çš„ç»“æœï¼Œå®ƒä»¬ä¹‹é—´ä¸å†æœ‰ç›¸å…³æ€§ã€‚</p>\n<p><code class=\"language-text\">useEffect()</code> Hook ä¹Ÿã€Œä¸¢å¼ƒã€ä¸Šä¸€æ¬¡æ¸²æŸ“ç»“æœï¼Œå®ƒä¼šæ¸…é™¤ä¸Šä¸€æ¬¡ effect å†å»ºç«‹ä¸‹ä¸€ä¸ª effectï¼Œä¸‹ä¸€ä¸ª effect é”ä½æ–°çš„ props å’Œ stateï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬<a href=\"https://codesandbox.io/s/7wlxk1k87j\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç¬¬ä¸€æ¬¡å°è¯•</a>ç®€å•ç¤ºä¾‹å¯ä»¥æ­£ç¡®å·¥ä½œçš„åŸå› ã€‚</p>\n<p><strong>ä½† <code class=\"language-text\">setInterval</code> ä¸ä¼šã€Œä¸¢å¼ƒã€ã€‚</strong> å®ƒä¼šä¸€ç›´å¼•ç”¨è€çš„ props å’Œ state ç›´åˆ°ä½ æŠŠå®ƒæ¢æ‰ â€”â€” ä¸é‡ç½®æ—¶é—´ä½ æ˜¯æ— æ³•åšåˆ°çš„ã€‚</p>\n<p>æˆ–è€…ç­‰ç­‰ï¼Œä½ å¯ä»¥åšåˆ°ï¼Ÿ</p>\n<hr>\n<h2 id=\"refs-å¯ä»¥åšåˆ°ï¼\"><a href=\"#refs-%E5%8F%AF%E4%BB%A5%E5%81%9A%E5%88%B0%EF%BC%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Refs å¯ä»¥åšåˆ°ï¼</h2>\n<p>è¿™ä¸ªé—®é¢˜å½’ç»“ä¸ºä¸‹é¢è¿™æ ·ï¼š</p>\n<ul>\n<li>æˆ‘ä»¬åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œå¸¦ <code class=\"language-text\">callback1</code> çš„ <code class=\"language-text\">setInterval(callback1, delay)</code>ã€‚</li>\n<li>æˆ‘ä»¬åœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶å¾—åˆ°æºå¸¦æ–°çš„ props å’Œ state çš„ <code class=\"language-text\">callbaxk2</code>ã€‚</li>\n<li>æˆ‘ä»¬æ— æ³•åœ¨ä¸é‡ç½®æ—¶é—´çš„æƒ…å†µä¸‹æ›¿æ¢æ‰å·²ç»å­˜åœ¨çš„ intervalã€‚</li>\n</ul>\n<p><strong>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æ ¹æœ¬ä¸æ›¿æ¢ intervalï¼Œè€Œæ˜¯å¼•å…¥ä¸€ä¸ªæŒ‡å‘<em>æ–°</em> interval å›è°ƒçš„å¯å˜ <code class=\"language-text\">savedCallback</code> ä¼šæ€ä¹ˆæ ·</strong>ï¼Ÿ</p>\n<p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæ–¹æ¡ˆï¼š</p>\n<ul>\n<li>æˆ‘ä»¬è°ƒç”¨ <code class=\"language-text\">setInterval(fn, delay)</code>ï¼Œå…¶ä¸­ <code class=\"language-text\">fn</code> è°ƒç”¨ <code class=\"language-text\">savedCallback</code>ã€‚</li>\n<li>ç¬¬ä¸€æ¬¡æ¸²æŸ“åå°† <code class=\"language-text\">savedCallback</code> è®¾ä¸º <code class=\"language-text\">callback1</code>ã€‚</li>\n<li>ä¸‹ä¸€æ¬¡æ¸²æŸ“åå°† <code class=\"language-text\">savedCallback</code> è®¾ä¸º <code class=\"language-text\">callback2</code>ã€‚</li>\n<li>???</li>\n<li>å®Œæˆ</li>\n</ul>\n<p>è¿™ä¸ªå¯å˜çš„ <code class=\"language-text\">savedCallback</code> éœ€è¦åœ¨é‡æ–°æ¸²æŸ“æ—¶ã€Œå¯æŒç»­ï¼ˆpersistï¼‰ã€ï¼Œæ‰€ä»¥ä¸å¯ä»¥æ˜¯ä¸€ä¸ªå¸¸è§„å˜é‡ï¼Œæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªç±»ä¼¼å®ä¾‹çš„å­—æ®µã€‚</p>\n<p><a href=\"https://reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æ­£å¦‚æˆ‘ä»¬ä» Hooks FAQ ä¸­å­¦åˆ°çš„</a>ï¼Œ<code class=\"language-text\">useRef()</code> ç»™å‡ºäº†æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> savedCallback <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// { current: null }</span></code></pre></div>\n<p><em>ï¼ˆä½ å¯èƒ½ç†Ÿæ‚‰ React ä¸­çš„ <a href=\"https://reactjs.org/docs/refs-and-the-dom.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DOM refs</a>ï¼‰ã€‚Hooks ä½¿ç”¨ç›¸åŒçš„æ¦‚å¿µæ¥ä¿å­˜ä»»æ„å¯å˜å€¼ã€‚ref å°±åƒä¸€ä¸ªã€Œç›’å­ã€ï¼Œä½ å¯ä»¥æ”¾ä»»ä½•ä¸œè¥¿</em></p>\n<p><code class=\"language-text\">useRef()</code> è¿”å›ä¸€ä¸ªæœ‰å¸¦æœ‰ <code class=\"language-text\">current</code> å¯å˜å±æ€§çš„æ™®é€šå¯¹è±¡åœ¨ renders é—´å…±äº«ï¼Œæˆ‘ä»¬å¯ä»¥ä¿å­˜<em>æ–°</em>çš„ interval å›æ‰ç»™å®ƒï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">function</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// å¯ä»¥è¯»åˆ°æ–° propsï¼Œstateç­‰ã€‚</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// æ¯æ¬¡æ¸²æŸ“åï¼Œä¿å­˜æ–°çš„å›è°ƒåˆ°æˆ‘ä»¬çš„ ref é‡Œã€‚</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    savedCallback<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> callback<span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¹‹åæˆ‘ä»¬ä¾¿å¯ä»¥ä»æˆ‘ä»¬çš„ interval ä¸­è¯»å–å’Œè°ƒç”¨å®ƒï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      savedCallback<span class=\"token punctuation\">.</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>æ„Ÿè°¢ <code class=\"language-text\">[]</code>ï¼Œä¸é‡æ‰§è¡Œæˆ‘ä»¬çš„ effectï¼Œinterval å°±ä¸ä¼šè¢«é‡ç½®ã€‚åŒæ—¶ï¼Œæ„Ÿè°¢ <code class=\"language-text\">savedCallback</code> refï¼Œè®©æˆ‘ä»¬å¯ä»¥ä¸€ç›´åœ¨æ–°æ¸²æŸ“ä¹‹åè¯»å–åˆ°å›è°ƒï¼Œå¹¶åœ¨ interval tick é‡Œè°ƒç”¨å®ƒã€‚</p>\n<p>è¿™æ˜¯å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> savedCallback <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    savedCallback<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> callback<span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">      savedCallback<span class=\"token punctuation\">.</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>ï¼ˆçœ‹ <a href=\"https://codesandbox.io/s/3499qqr565\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandbox demo</a>ã€‚ï¼‰</em></p>\n<hr>\n<h2 id=\"æå–ä¸€ä¸ª-hook\"><a href=\"#%E6%8F%90%E5%8F%96%E4%B8%80%E4%B8%AA-hook\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æå–ä¸€ä¸ª Hook</h2>\n<p>ä¸å¯å¦è®¤ï¼Œä¸Šé¢çš„ä»£ç ä»¤äººå›°æƒ‘ï¼Œæ··åˆç›¸åçš„èŒƒå¼ä»¤äººè´¹è§£ï¼Œè¿˜å¯èƒ½å¼„ä¹±å¯å˜ refsã€‚</p>\n<p><strong>æˆ‘è§‰å¾— Hooks æä¾›äº†æ¯” class æ›´ä½çº§çš„åŸè¯­ â€”â€” ä½†å®ƒä»¬çš„ç¾ä¸½åœ¨äºå®ƒä»¬ä½¿æˆ‘ä»¬èƒ½å¤Ÿåˆ›ä½œå¹¶åˆ›é€ å‡ºæ›´å¥½çš„é™ˆè¿°æ€§æŠ½è±¡</strong>ã€‚</p>\n<p>ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘åªæƒ³è¿™æ ·å†™ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æˆ‘å°†æˆ‘ ref æœºåˆ¶çš„ä»£ç å¤åˆ¶ç²˜è´´åˆ°ä¸€ä¸ª custom Hookï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> savedCallback <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    savedCallback<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> callback<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      savedCallback<span class=\"token punctuation\">.</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å½“å‰ï¼Œ<code class=\"language-text\">1000</code> delay æ˜¯å†™æ­»çš„ï¼Œæˆ‘æƒ³æŠŠå®ƒå˜æˆä¸€ä¸ªå‚æ•°ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">callback<span class=\"token punctuation\">,</span> delay</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></code></pre></div>\n<p>æˆ‘ä¼šåœ¨åˆ›å»ºå¥½ interval åä½¿ç”¨å®ƒï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p> ç°åœ¨ <code class=\"language-text\">delay</code> å¯ä»¥åœ¨ renders ä¹‹é—´æ”¹å˜ï¼Œæˆ‘éœ€è¦åœ¨æˆ‘çš„ interval effect ä¾èµ–éƒ¨åˆ†å£°æ˜å®ƒï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      savedCallback<span class=\"token punctuation\">.</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>delay<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>ç­‰ç­‰ï¼Œæˆ‘ä»¬ä¸æ˜¯è¦é¿å…é‡ç½® interval effectï¼Œå¹¶ä¸“é—¨é€šè¿‡ <code class=\"language-text\">[]</code> æ¥é¿å…å®ƒå—ï¼Ÿä¸å®Œå…¨æ˜¯ï¼Œæˆ‘ä»¬åªæƒ³åœ¨<em>å›è°ƒ</em>æ”¹å˜æ—¶é¿å…é‡ç½®å®ƒï¼Œä½†å½“ <code class=\"language-text\">delay</code> æ”¹å˜æ—¶ï¼Œæˆ‘ä»¬<em>æƒ³è¦</em>é‡å¯ timerï¼</p>\n<p>è®©æˆ‘ä»¬æ£€æŸ¥ä¸‹æˆ‘ä»¬çš„ä»£ç æ˜¯å¦æœ‰æ•ˆï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">callback<span class=\"token punctuation\">,</span> delay</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> savedCallback <span class=\"token operator\">=</span> <span class=\"token function\">useRef</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    savedCallback<span class=\"token punctuation\">.</span>current <span class=\"token operator\">=</span> callback<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      savedCallback<span class=\"token punctuation\">.</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>delay<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>ï¼ˆå°è¯•å®ƒ <a href=\"https://codesandbox.io/s/xvyl15375w\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandbox</a>ã€‚ï¼‰</em></p>\n<p>æœ‰æ•ˆï¼æˆ‘ä»¬ç°åœ¨å¯ä»¥ä¸ç”¨æƒ³å¤ªå¤š <code class=\"language-text\">useInterval()</code> çš„å®ç°è¿‡ç¨‹ï¼Œåœ¨ä»»æ„ç»„ä»¶ä¸­ä½¿ç”¨å®ƒã€‚</p>\n<h2 id=\"ç¦åˆ©ï¼šæš‚åœ-interval\"><a href=\"#%E7%A6%8F%E5%88%A9%EF%BC%9A%E6%9A%82%E5%81%9C-interval\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¦åˆ©ï¼šæš‚åœ Interval</h2>\n<p>å‡è®¾æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿé€šè¿‡ä¼ é€’ <code class=\"language-text\">null</code> ä½œä¸º <code class=\"language-text\">delay</code> æ¥æš‚åœæˆ‘ä»¬çš„ intervalï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>delay<span class=\"token punctuation\">,</span> setDelay<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isRunning<span class=\"token punctuation\">,</span> setIsRunning<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> isRunning <span class=\"token operator\">?</span> delay <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>å¦‚ä½•å®ç°è¿™ä¸ªï¼Ÿç­”æ¡ˆæ—¶ï¼šä¸åˆ›å»º intervalã€‚</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      savedCallback<span class=\"token punctuation\">.</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>delay <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>      <span class=\"token keyword\">let</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>tick<span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>delay<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><em>ï¼ˆçœ‹ <a href=\"https://codesandbox.io/s/l240mp2pm7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandbox demo</a>ã€‚ï¼‰</em></p>\n<p>å°±æ˜¯è¿™æ ·ã€‚æ­¤ä»£ç å¤„ç†äº†æ‰€æœ‰å¯èƒ½çš„å˜åŒ–ï¼šæ”¹å˜ delayã€æš‚åœã€æˆ–è€…æ¢å¤ intervalã€‚<code class=\"language-text\">useEffect()</code> API è¦æ±‚æˆ‘ä»¬èŠ±è´¹æ›´å¤šçš„å‰æœŸå·¥ä½œæ¥æè¿°å»ºç«‹å’Œæ¸…é™¤ â€”â€” ä½†æ·»åŠ æ–°æ¡ˆä¾‹å¾ˆå®¹æ˜“ã€‚</p>\n<h2 id=\"ç¦åˆ©ï¼šæœ‰è¶£çš„-demo\"><a href=\"#%E7%A6%8F%E5%88%A9%EF%BC%9A%E6%9C%89%E8%B6%A3%E7%9A%84-demo\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¦åˆ©ï¼šæœ‰è¶£çš„ Demo</h2>\n<p><code class=\"language-text\">useInterval()</code> Hook çœŸçš„å¾ˆå¥½ç©ï¼Œå½“å‰¯ä½œç”¨æ˜¯é™ˆè¿°æ€§çš„ï¼Œå°†å¤æ‚çš„è¡Œä¸ºç¼–æ’åœ¨ä¸€èµ·è¦å®¹æ˜“å¾—å¤šã€‚</p>\n<p><strong>ä¾‹å¦‚ï¼šæˆ‘ä»¬ interval ä¸­ <code class=\"language-text\">delay</code> å¯ä»¥å—æ§äºå¦å¤–ä¸€ä¸ªï¼š</strong></p>\n<p><img src=\"/10cfc4b38497a46980d3a13048a56e36/counter_inception.gif\" alt=\"Counter that automatically speeds up\"> <h1>!!!!</h1></p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>delay<span class=\"token punctuation\">,</span> setDelay<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// å¢åŠ è®¡æ•°å™¨</span>\n  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// æ¯ç§’åŠ é€Ÿ</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>delay <span class=\"token operator\">></span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setDelay</span><span class=\"token punctuation\">(</span>delay <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleReset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setDelay</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Counter: </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h4</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Delay: </span><span class=\"token punctuation\">{</span>delay<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h4</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleReset<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        Reset delay</span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>ï¼ˆçœ‹ <a href=\"https://codesandbox.io/s/znr418qp13\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CodeSandbox demo</a>ï¼ï¼‰</em></p>\n<h2 id=\"å°¾å£°æ€»ç»“\"><a href=\"#%E5%B0%BE%E5%A3%B0%E6%80%BB%E7%BB%93\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å°¾å£°æ€»ç»“</h2>\n<p>Hooks éœ€è¦èŠ±æ—¶é—´å»ä¹ æƒ¯ â€”â€” <em>ç‰¹åˆ«</em>æ˜¯åœ¨è·¨è¶Šå‘½ä»¤å¼å’Œå£°æ˜å¼çš„ä»£ç ä¸Šã€‚ä½ å¯ä»¥åˆ›å»ºåƒ <a href=\"http://react-spring.surge.sh/hooks\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React Spring</a> ä¸€æ ·çš„æŠ½è±¡ï¼Œä½†æœ‰æ—¶å®ƒä»¬ä¼šè®©ä½ ä¸å®‰ã€‚</p>\n<p>Hooks è¿˜å¤„äºå‰æœŸé˜¶æ®µï¼Œæ— ç–‘æ­¤æ¨¡å¼ä»éœ€è¦ä¿®ç‚¼å’Œæ¯”è¾ƒã€‚å¦‚æœä½ ä¹ æƒ¯è·Ÿéšä¼—æ‰€å‘¨çŸ¥çš„ã€Œæœ€ä½³å®è·µã€ï¼Œä¸è¦æ€¥äºé‡‡ç”¨ Hooksï¼Œå®ƒéœ€è¦å¾ˆå¤šçš„å°è¯•å’Œæ¢ç´¢ã€‚</p>\n<p>æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯ä»¥å¸®åŠ©ä½ ç†è§£å¸¦æœ‰ <code class=\"language-text\">setInterval()</code> ç­‰ API çš„ Hooks çš„ç›¸å…³å¸¸è§é—®é¢˜ã€å¯ä»¥å¸®åŠ©ä½ å…‹æœå®ƒä»¬çš„æ¨¡å¼ã€åŠäº«ç”¨å»ºç«‹åœ¨å®ƒä»¬ä¹‹ä¸Šæ›´å…·è¡¨è¾¾åŠ›çš„å£°æ˜å¼ APIs çš„ç”œèœœæœå®ã€‚</p>","timeToRead":17,"frontmatter":{"title":"ä½¿ç”¨ React Hooks å£°æ˜ setInterval","date":"February 04, 2019","spoiler":"æˆ‘æ˜¯å¦‚ä½•å­¦ä¹ åœæ­¢æ‹…å¿ƒå’Œå–œçˆ± refs çš„ã€‚","cta":null},"fields":{"slug":"/zh-hans/making-setinterval-declarative-with-react-hooks/","langKey":"zh-hans"}}},"pageContext":{"slug":"/zh-hans/making-setinterval-declarative-with-react-hooks/","translations":["fr","zh-hans"],"translatedLinks":["/react-as-a-ui-runtime/"]}}}