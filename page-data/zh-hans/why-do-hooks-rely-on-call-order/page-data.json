{"componentChunkName":"component---src-templates-blog-post-js","path":"/zh-hans/why-do-hooks-rely-on-call-order/","result":{"data":{"site":{"siteMetadata":{"title":"Overreacted","author":"Dan Abramov"}},"markdownRemark":{"id":"cded75fc-08cc-5b43-ae48-3f7342aed20c","html":"<p>æœ€åˆä½ å¯èƒ½ä¼šä¸å–œæ¬¢ Hooksï¼š</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2019/2/14/168ea037c69fce4e?w=616&#x26;h=110&#x26;f=png&#x26;s=33543\" alt=\"Negative HN comment\"></p>\n<p>å®ƒä»¬å°±åƒä¸€æ®µéŸ³ä¹ï¼Œåªæœ‰ç»è¿‡å‡ æ¬¡ç”¨å¿ƒè†å¬æ‰ä¼šæ…¢æ…¢çˆ±ä¸Šï¼š</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2019/2/14/168ea249f3f7b83e?w=617&#x26;h=135&#x26;f=png&#x26;s=44605\" alt=\"Positive HN comment from the same person four days later\"></p>\n<p>å½“ä½ é˜…è¯»æ–‡æ¡£æ—¶ï¼Œä¸è¦é”™è¿‡å…³äº<a href=\"https://reactjs.org/docs/hooks-custom.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">æœ€é‡è¦çš„éƒ¨åˆ†</a>â€”â€”åˆ›é€ å±äºä½ è‡ªå·±çš„ Hooksï¼å¤ªå¤šçš„äººçº ç»“äºåå¯¹æˆ‘ä»¬çš„è§‚ç‚¹ï¼ˆclass å­¦ä¹ æˆæœ¬é«˜ç­‰ï¼‰ä»¥è‡³äºé”™è¿‡äº† Hooks æ›´é‡è¦çš„ä¸€é¢ï¼ŒHooks åƒ <code class=\"language-text\">functional mixins</code>ï¼Œå¯ä»¥è®©ä½ åˆ›é€ å’Œæ­å»ºå±äºè‡ªå·±çš„ Hookã€‚</p>\n<p>Hooks <a href=\"https://reactjs.org/docs/hooks-faq.html#what-is-the-prior-art-for-hooks\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å—å¯å‘äºä¸€äº›ç°æœ‰æŠ€æœ¯</a>ï¼Œä½†åœ¨ Sebastian å’Œå›¢é˜Ÿåˆ†äº«ä»–çš„æƒ³æ³•ä¹‹åï¼Œæˆ‘æ‰çŸ¥é“è¿™äº›ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº› API å’Œç°åœ¨åœ¨ç”¨çš„ä¹‹é—´çš„å…³è”å¾ˆå®¹æ˜“è¢«å¿½ç•¥ï¼Œé€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘å¸Œæœ›å¯ä»¥å¸®åŠ©æ›´å¤šçš„äººç†è§£ Hooks ææ¡ˆä¸­äº‰è®®è¾ƒå¤§çš„ç‚¹ã€‚</p>\n<p><strong>æ¥ä¸‹æ¥çš„éƒ¨åˆ†éœ€è¦ä½ çŸ¥é“ Hook API çš„ <code class=\"language-text\">useState</code> å’Œå¦‚ä½•å†™è‡ªå®šä¹‰ Hookã€‚å¦‚æœä½ è¿˜ä¸æ‡‚ï¼Œå¯ä»¥çœ‹çœ‹æ—©å…ˆçš„é“¾æ¥ã€‚</strong></p>\n<p>(å…è´£è¯´æ˜ï¼šæ–‡ç« çš„è§‚ç‚¹ä»…ä»£è¡¨ä¸ªäººæƒ³æ³•ï¼Œä¸ React å›¢é˜Ÿæ— å…³ã€‚è¯é¢˜å¤§ä¸”å¤æ‚ï¼Œå…¶ä¸­å¯èƒ½æœ‰é”™è¯¯çš„è§‚ç‚¹ã€‚)</p>\n<hr>\n<p>ä¸€å¼€å§‹å½“ä½ å­¦ä¹ æ—¶ä½ å¯èƒ½ä¼šéœ‡æƒŠï¼ŒHooks é‡æ¸²æŸ“æ—¶æ˜¯ä¾èµ–äºå›ºå®šé¡ºåºè°ƒç”¨çš„ï¼Œè¿™é‡Œæœ‰<a href=\"https://reactjs.org/docs/hooks-rules.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è¯´æ˜</a>ã€‚</p>\n<p>è¿™ä¸ªå†³å®šæ˜¾ç„¶æ˜¯æœ‰äº‰è®®çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¼šæœ‰äºº<a href=\"https://www.reddit.com/r/reactjs/comments/9xs2r6/sebmarkbages_response_to_hooks_rfc_feedback/e9wh4um/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">åå¯¹æˆ‘ä»¬çš„ææ¡ˆ</a>ã€‚æˆ‘ä»¬ä¼šåœ¨æ°å½“çš„æ—¶æœºå‘å¸ƒè¿™ä¸ªææ¡ˆï¼Œå½“æˆ‘ä»¬è§‰å¾—æ–‡æ¡£å’Œè®²åº§å¯ä»¥è¶³å¤Ÿå¥½çš„æç»˜å®ƒæ—¶ã€‚</p>\n<p>å¦‚æœä½ åœ¨å…³æ³¨ Hooks API çš„æŸäº›ç‚¹ï¼Œæˆ‘å»ºè®®ä½ é˜…è¯»ä¸‹ Sebastian å¯¹ 1000+ è¯„è®º RFC çš„<a href=\"https://github.com/reactjs/rfcs/pull/68#issuecomment-439314884\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å…¨éƒ¨å›å¤</a>ï¼Œ<strong>è¶³å¤Ÿé€æ¾ˆä½†å†…å®¹éå¸¸å¤šï¼Œæˆ‘å¯èƒ½ä¼šå°†è¯„è®ºä¸­çš„æ¯ä¸€æ®µéƒ½å˜æˆè‡ªå·±çš„åšå®¢æ–‡ç« ã€‚(äº‹å®ä¸Šï¼Œæˆ‘å·²ç»<a href=\"/how-does-setstate-know-what-to-do/\">åšè¿‡</a>ä¸€æ¬¡ï¼)</strong></p>\n<p>æˆ‘ä»Šå¤©è¦å…³æ³¨ä¸€ä¸ªå…·ä½“éƒ¨åˆ†ã€‚ä½ å¯èƒ½è¿˜è®°å¾—ï¼Œæ¯ä¸ª Hook å¯ä»¥åœ¨ç»„ä»¶é‡Œè¢«å¤šæ¬¡ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code class=\"language-text\">useState</code> å£°æ˜<a href=\"https://reactjs.org/docs/hooks-state.html#tip-using-multiple-state-variables\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å¤šä¸ªstate</a>ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Mary'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>              <span class=\"token comment\">// State å˜é‡ 1</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Poppins'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// State å˜é‡ 2</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// State å˜é‡ 3</span></span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleResize</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setWidth</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> handleResize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> handleResize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleNameChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleSurnameChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setSurname</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleNameChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>surname<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleSurnameChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span>surname<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Window width: </span><span class=\"token punctuation\">{</span>width<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ³¨æ„æˆ‘ä»¬ç”¨æ•°ç»„è§£æ„è¯­æ³•æ¥å‘½å <code class=\"language-text\">useState()</code> è¿”å›çš„ state å˜é‡ï¼Œä½†è¿™äº›å˜é‡ä¸ä¼šè¿æ¥åˆ° React ç»„ä»¶ä¸Šã€‚ç›¸åï¼Œè¿™ä¸ªä¾‹å­ä¸­ï¼Œ<strong>React å°† <code class=\"language-text\">name</code> è§†ä¸ºã€Œç¬¬ä¸€ä¸ª state å˜é‡ã€ï¼Œ<code class=\"language-text\">surname</code> è§†ä¸ºã€Œç¬¬äºŒä¸ª state å˜é‡ã€ï¼Œä»¥æ­¤ç±»æ¨</strong>ã€‚å®ƒä»¬åœ¨é‡æ–°æ¸²æŸ“æ—¶ç”¨ <em>é¡ºåºè°ƒç”¨</em> æ¥ä¿è¯è¢«æ­£ç¡®è¯†åˆ«ã€‚<a href=\"https://juejin.im/post/5bfa929551882524cb6f413b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è¿™ç¯‡æ–‡ç« </a>è¯¦ç»†çš„è§£é‡Šäº†åŸå› ã€‚</p>\n<p>è¡¨é¢ä¸Šçœ‹ï¼Œä¾èµ–äºé¡ºåºè°ƒç”¨åªæ˜¯<em>æ„Ÿè§‰æœ‰é—®é¢˜</em>ï¼Œç›´è§‰æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ä¿¡å·ï¼Œä½†å®ƒæœ‰æ—¶ä¼šè¯¯å¯¼æˆ‘ä»¬ â€”â€” ç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬è¿˜æ²¡æœ‰å®Œå…¨æ¶ˆåŒ–å›°æƒ‘çš„é—®é¢˜ã€‚<strong>è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä¼šæåˆ°å‡ ä¸ªç»å¸¸æœ‰äººæå‡ºä¿®æ”¹ Hooks çš„æ–¹æ¡ˆï¼ŒåŠå®ƒä»¬å­˜åœ¨çš„é—®é¢˜</strong>ã€‚</p>\n<hr>\n<p>è¿™ç¯‡æ–‡ç« ä¸ä¼šè¯¦å°½æ— é—ï¼Œå¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬å·²ç»çœ‹è¿‡åå‡ ç§è‡³æ•°ç™¾ç§ä¸åŒçš„æ›¿ä»£æ–¹æ¡ˆï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨<a href=\"https://github.com/reactjs/react-future\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">è€ƒè™‘</a>æ›¿æ¢ç»„ä»¶ APIã€‚</p>\n<p>è¯¸å¦‚æ­¤ç±»çš„åšå®¢å¾ˆæ£˜æ‰‹ï¼Œå› ä¸ºå³ä½¿ä½ æ¶‰åŠäº†ä¸€ç™¾ç§æ›¿ä»£æ–¹æ¡ˆï¼Œä¹Ÿæœ‰äººå¼ºè¡Œæå‡ºä¸€ä¸ªæ¥ï¼šã€Œå“ˆå“ˆï¼Œä½ æ²¡æœ‰æƒ³åˆ°<em>è¿™ä¸ª</em>ï¼ã€</p>\n<p>åœ¨å®è·µä¸­ï¼Œä¸åŒæ›¿ä»£æ–¹æ¡ˆæåˆ°çš„é—®é¢˜ä¼šæœ‰å¾ˆå¤šé‡å¤ï¼Œæˆ‘ä¸ä¼šåˆ—ä¸¾<em>æ‰€æœ‰</em>å»ºè®®çš„ APIï¼ˆè¿™éœ€è¦èŠ±è´¹æ•°æœˆæ—¶é—´ï¼‰ï¼Œè€Œæ˜¯é€šè¿‡å‡ ä¸ªå…·ä½“ç¤ºä¾‹å±•ç¤ºæœ€å¸¸è§çš„é—®é¢˜ï¼Œæ›´å¤šçš„é—®é¢˜å°±è€ƒéªŒè¯»è€…ä¸¾ä¸€åä¸‰çš„èƒ½åŠ›äº†ã€‚ğŸ§</p>\n<p><em>è¿™ä¸æ˜¯è¯´ Hooks å°±æ˜¯å®Œç¾çš„</em>ï¼Œä½†æ˜¯ä¸€æ—¦ä½ äº†è§£å…¶ä»–è§£å†³æ–¹æ¡ˆçš„ç¼ºé™·ï¼Œä½ å¯èƒ½ä¼šå‘ç° Hooks çš„è®¾è®¡æ˜¯æœ‰é“ç†çš„ã€‚</p>\n<hr>\n<h3 id=\"ç¼ºé™·-1ï¼šæ— æ³•æå–-custom-hook\"><a href=\"#%E7%BC%BA%E9%99%B7-1%EF%BC%9A%E6%97%A0%E6%B3%95%E6%8F%90%E5%8F%96-custom-hook\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¼ºé™· #1ï¼šæ— æ³•æå– custom hook</h3>\n<p>å‡ºä¹æ„æ–™çš„æ˜¯ï¼Œå¤§å¤šæ•°æ›¿ä»£æ–¹æ¡ˆå®Œå…¨æ²¡æœ‰æåˆ° <a href=\"https://reactjs.org/docs/hooks-custom.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">custom hooks</a>ã€‚å¯èƒ½æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ã€Œmotivationã€æ–‡æ¡£ä¸­æ²¡æœ‰è¶³å¤Ÿå¼ºè°ƒ custom hooksï¼Œä¸è¿‡åœ¨å¼„æ‡‚ Hooks åŸºæœ¬åŸç†ä¹‹å‰ï¼Œè¿™æ˜¯å¾ˆéš¾åšåˆ°çš„ã€‚å°±åƒé¸¡å’Œè›‹é—®é¢˜ï¼Œä½†å¾ˆå¤§ç¨‹åº¦ä¸Š custom hooks æ˜¯ææ¡ˆçš„é‡ç‚¹ã€‚</p>\n<p>ä¾‹å¦‚ï¼šæœ‰ä¸ªæ›¿ä»£æ–¹æ¡ˆæ˜¯é™åˆ¶ä¸€ä¸ªç»„ä»¶è°ƒç”¨å¤šæ¬¡ <code class=\"language-text\">useState()</code>ï¼Œä½ å¯ä»¥æŠŠ state æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œï¼Œè¿™æ ·è¿˜å¯ä»¥å…¼å®¹ class ä¸æ˜¯æ›´å¥½å—ï¼Ÿ</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">'Mary'</span><span class=\"token punctuation\">,</span>\n    surname<span class=\"token operator\">:</span> <span class=\"token string\">'Poppins'</span><span class=\"token punctuation\">,</span>\n    width<span class=\"token operator\">:</span> window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¦æ¸…æ¥šï¼ŒHooks æ˜¯å…è®¸è¿™ç§é£æ ¼å†™çš„ï¼Œä½ ä¸å¿…å°† state æ‹†åˆ†æˆä¸€å † state å˜é‡ï¼ˆè¯·å‚é˜…å‚è§é—®é¢˜è§£ç­”ä¸­çš„<a href=\"https://reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å»ºè®®</a>ï¼‰ã€‚</p>\n<p>ä½†æ”¯æŒå¤šæ¬¡è°ƒç”¨ <code class=\"language-text\">useState()</code> çš„å…³é”®åœ¨äºï¼Œä½ å¯ä»¥ä»ç»„ä»¶ä¸­æå–å‡ºéƒ¨åˆ†æœ‰çŠ¶æ€é€»è¾‘ï¼ˆstate + effectï¼‰åˆ° custom hooks ä¸­ï¼ŒåŒæ—¶å¯ä»¥å•ç‹¬ä½¿ç”¨æœ¬åœ° state å’Œ effectsï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// åœ¨ç»„ä»¶å†…ç›´æ¥å®šä¹‰ä¸€äº› state å˜é‡</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Mary'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Poppins'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// æˆ‘ä»¬å°†éƒ¨åˆ† state å’Œ effects ç§»è‡³ custom hook</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> width <span class=\"token operator\">=</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// åœ¨ custom hook å†…å®šä¹‰ä¸€äº› state å˜é‡</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> width<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å¦‚æœä½ åªå…è®¸æ¯ä¸ªç»„ä»¶è°ƒç”¨ä¸€æ¬¡ <code class=\"language-text\">useState()</code>ï¼Œä½ å°†å¤±å»ç”¨ custom hook å¼•å…¥ state èƒ½åŠ›ï¼Œè¿™å°±æ˜¯ custom hooks çš„å…³é”®ã€‚</p>\n<h3 id=\"ç¼ºé™·-2-å‘½åå†²çª\"><a href=\"#%E7%BC%BA%E9%99%B7-2-%E5%91%BD%E5%90%8D%E5%86%B2%E7%AA%81\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¼ºé™· #2: å‘½åå†²çª</h3>\n<p>ä¸€ä¸ªå¸¸è§çš„å»ºè®®æ˜¯è®©ç»„ä»¶å†… <code class=\"language-text\">useState()</code> æ¥æ”¶ä¸€ä¸ªå”¯ä¸€æ ‡è¯† key å‚æ•°ï¼ˆstring ç­‰ï¼‰åŒºåˆ† state å˜é‡ã€‚</p>\n<p>å’Œè¿™ä¸»æ„æœ‰äº›å‡ºå…¥ï¼Œä½†çœ‹èµ·æ¥å¤§è‡´åƒè¿™æ ·ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// æˆ‘ä»¬ä¼ å‡ ç§ state key ç»™ useState()</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'surname'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span></code></pre></div>\n<p>è¿™è¯•å›¾æ‘†è„±ä¾èµ–é¡ºåºè°ƒç”¨ï¼ˆæ˜¾ç¤º keyï¼‰ï¼Œä½†å¼•å…¥äº†å¦å¤–ä¸€ä¸ªé—®é¢˜ â€”â€” å‘½åå†²çªã€‚</p>\n<p>å½“ç„¶é™¤äº†é”™è¯¯ä¹‹å¤–ï¼Œä½ å¯èƒ½æ— æ³•åœ¨åŒä¸€ä¸ªç»„ä»¶è°ƒç”¨ä¸¤æ¬¡ <code class=\"language-text\">useState(&#39;name&#39;)</code>ï¼Œè¿™ç§å¶ç„¶å‘ç”Ÿçš„å¯ä»¥å½’ç»“äºå…¶ä»–ä»»æ„ bugï¼Œä½†æ˜¯ï¼Œå½“ä½ ä½¿ç”¨ä¸€ä¸ª <em>custom hook</em> æ—¶ï¼Œä½ æ€»ä¼šé‡åˆ°æƒ³æ·»åŠ æˆ–ç§»é™¤ state å˜é‡å’Œ effects çš„æƒ…å†µã€‚</p>\n<p>è¿™ä¸ªæè®®ä¸­ï¼Œæ¯å½“ä½ åœ¨ custom hook é‡Œæ·»åŠ ä¸€ä¸ªæ–°çš„ state å˜é‡æ—¶ï¼Œå°±æœ‰å¯èƒ½ç ´åä½¿ç”¨å®ƒçš„ä»»ä½•ç»„ä»¶ï¼ˆç›´æ¥æˆ–è€…é—´æ¥ï¼‰ï¼Œå› ä¸º <em>å¯èƒ½å·²ç»æœ‰åŒåçš„å˜é‡</em> ä½äºç»„ä»¶å†…ã€‚</p>\n<p>è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰<a href=\"https://juejin.im/post/5c665e44518825622f12e37c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">åº”å˜è€Œä¼˜</a>çš„ APIï¼Œå½“å‰ä»£ç å¯èƒ½çœ‹èµ·æ¥æ€»æ˜¯ã€Œä¼˜é›…çš„ã€ï¼Œä½†åº”å¯¹éœ€æ±‚å˜åŒ–æ—¶ååˆ†è„†å¼±ï¼Œæˆ‘ä»¬åº”è¯¥ä»<a href=\"https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html#mixins-cause-name-clashes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">é”™è¯¯</a>ä¸­å¸å–æ•™è®­ã€‚</p>\n<p>å®é™…ä¸­ Hooks ææ¡ˆé€šè¿‡ä¾èµ–é¡ºåºè°ƒç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šå³ä½¿ä¸¤ä¸ª Hooks éƒ½ç”¨ <code class=\"language-text\">name</code> state å˜é‡ï¼Œå®ƒä»¬ä¹Ÿä¼šå½¼æ­¤éš”ç¦»ï¼Œæ¯æ¬¡è°ƒç”¨ <code class=\"language-text\">useState()</code> éƒ½ä¼šè·å¾—ç‹¬ç«‹çš„\nã€Œå†…å­˜å•å…ƒã€ã€‚</p>\n<p>æˆ‘ä»¬è¿˜æœ‰å…¶ä»–ä¸€äº›æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªç¼ºé™·ï¼Œä½†è¿™äº›æ–¹æ³•ä¹Ÿæœ‰è‡ªèº«çš„ç¼ºé™·ã€‚è®©æˆ‘ä»¬åŠ æ·±æ¢ç´¢è¿™ä¸ªé—®é¢˜ã€‚</p>\n<h3 id=\"ç¼ºé™·-3ï¼šåŒä¸€ä¸ª-hook-æ— æ³•è°ƒç”¨ä¸¤æ¬¡\"><a href=\"#%E7%BC%BA%E9%99%B7-3%EF%BC%9A%E5%90%8C%E4%B8%80%E4%B8%AA-hook-%E6%97%A0%E6%B3%95%E8%B0%83%E7%94%A8%E4%B8%A4%E6%AC%A1\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¼ºé™· #3ï¼šåŒä¸€ä¸ª Hook æ— æ³•è°ƒç”¨ä¸¤æ¬¡</h3>\n<p>ç»™ <code class=\"language-text\">useState</code> ã€ŒåŠ keyã€çš„å¦ä¸€ç§è¡ç”Ÿææ¡ˆæ˜¯ä½¿ç”¨åƒ Symbol è¿™æ ·çš„ä¸œè¥¿ï¼Œè¿™æ ·å°±ä¸å†²çªäº†å¯¹å§ï¼Ÿ</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>\n<span class=\"token keyword\">const</span> nameKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> surnameKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> widthKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// æˆ‘ä»¬ä¼ å‡ ç§state keyç»™useState()</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>nameKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>surnameKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>widthKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span></code></pre></div>\n<p>è¿™ä¸ªææ¡ˆçœ‹ä¸Šå»å¯¹æå–å‡ºæ¥çš„ <code class=\"language-text\">useWindowWidth</code> Hook æœ‰æ•ˆï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> width <span class=\"token operator\">=</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/*********************\n * useWindowWidth.js *\n ********************/</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> widthKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"> </span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>widthKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// ...</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> width<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>ä½†å¦‚æœå°è¯•æå–å‡ºæ¥çš„ input handlingï¼Œå®ƒä¼šå¤±è´¥ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> surname <span class=\"token operator\">=</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">name</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">surname</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* ... */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>    \n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/*******************\n * useFormInput.js *\n ******************/</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> valueKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"> </span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>valueKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    value<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>(æˆ‘æ‰¿è®¤ <code class=\"language-text\">useFormInput()</code> Hook ä¸æ˜¯ç‰¹åˆ«å¥½ç”¨ï¼Œä½†ä½ å¯ä»¥æƒ³è±¡ä¸‹å®ƒå¤„ç†è¯¸å¦‚éªŒè¯å’Œ dirty state æ ‡å¿—ä¹‹ç±»ï¼Œå¦‚ <a href=\"https://github.com/jaredpalmer/formik\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Formik</a>ã€‚)</p>\n<p>ä½ èƒ½å‘ç°è¿™ä¸ªbugå—ï¼Ÿ</p>\n<p>æˆ‘ä»¬è°ƒç”¨ <code class=\"language-text\">useFormInput()</code> ä¸¤æ¬¡ï¼Œä½† <code class=\"language-text\">useFormInput()</code> æ€»æ˜¯ç”¨åŒä¸€ä¸ª key è°ƒç”¨ <code class=\"language-text\">useState()</code>ï¼Œå°±åƒè¿™æ ·ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>valueKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>valueKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æˆ‘ä»¬å†æ¬¡å‘ç”Ÿäº†å†²çªã€‚</p>\n<p>å®é™…ä¸­ Hooks ææ¡ˆæ²¡æœ‰è¿™ç§é—®é¢˜ï¼Œå› ä¸º<strong>æ¯æ¬¡ <em>è°ƒç”¨</em> <code class=\"language-text\">useState()</code> ä¼šè·å¾—å•ç‹¬çš„state</strong>ã€‚ä¾èµ–äºå›ºå®šé¡ºåºè°ƒç”¨ä½¿æˆ‘ä»¬å…äºæ‹…å¿ƒå‘½åå†²çªã€‚</p>\n<h3 id=\"ç¼ºé™·-4ï¼šé’»çŸ³é—®é¢˜å¤šå±‚ç»§æ‰¿é—®é¢˜\"><a href=\"#%E7%BC%BA%E9%99%B7-4%EF%BC%9A%E9%92%BB%E7%9F%B3%E9%97%AE%E9%A2%98%E5%A4%9A%E5%B1%82%E7%BB%A7%E6%89%BF%E9%97%AE%E9%A2%98\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¼ºé™· #4ï¼šé’»çŸ³é—®é¢˜(å¤šå±‚ç»§æ‰¿é—®é¢˜)</h3>\n<p>ä»æŠ€æœ¯ä¸Šæ¥è¯´è¿™ä¸ªå’Œä¸Šä¸€ä¸ªç¼ºé™·ç›¸åŒï¼Œä½†å®ƒçš„è‡­åå€¼å¾—è¯´è¯´ï¼Œç”šè‡³ç»´åŸºç™¾ç§‘éƒ½æœ‰ä»‹ç»ã€‚(æœ‰äº›æ—¶å€™è¿˜è¢«ç§°ä¸ºã€Œè‡´å‘½çš„æ­»äº¡é’»çŸ³ã€ â€”â€” coolï¼)</p>\n<p>æˆ‘ä»¬è‡ªå·±çš„ mixin ç³»ç»Ÿå°±<a href=\"https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html#mixins-cause-name-clashes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å—åˆ°äº†ä¼¤å®³</a>ã€‚</p>\n<p>æ¯”å¦‚<code class=\"language-text\">useWindowWidth()</code> å’Œ <code class=\"language-text\">useNetworkStatus()</code> è¿™ä¸¤ä¸ª custom hooks å¯èƒ½è¦ç”¨åƒ <code class=\"language-text\">useSubscription()</code> è¿™æ ·çš„ custom hookï¼Œå¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">StatusMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> width <span class=\"token operator\">=</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> isOnline <span class=\"token operator\">=</span> <span class=\"token function\">useNetworkStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Window width is </span><span class=\"token punctuation\">{</span>width<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">You are </span><span class=\"token punctuation\">{</span>isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'online'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'offline'</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useSubscription</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">subscribe<span class=\"token punctuation\">,</span> unsubscribe<span class=\"token punctuation\">,</span> getValue</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleChange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">unsubscribe</span><span class=\"token punctuation\">(</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> width <span class=\"token operator\">=</span> <span class=\"token function\">useSubscription</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span>innerWidth</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> width<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useNetworkStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isOnline <span class=\"token operator\">=</span> <span class=\"token function\">useSubscription</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'online'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">      window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'offline'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'online'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">      window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'offline'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> navigator<span class=\"token punctuation\">.</span>onLine</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> isOnline<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™æ˜¯ä¸€ä¸ªçœŸå®å¯è¿è¡Œçš„ç¤ºä¾‹ã€‚ <strong>custom hook ä½œè€…å‡†å¤‡æˆ–åœæ­¢ä½¿ç”¨å¦ä¸€ä¸ª custom hook åº”è¯¥æ˜¯è¦å®‰å…¨çš„ï¼Œè€Œä¸å¿…æ‹…å¿ƒå®ƒæ˜¯å¦å·²åœ¨é“¾ä¸­æŸå¤„ã€Œè¢«ç”¨è¿‡äº†ã€</strong>ã€‚</p>\n<p>(ä½œä¸ºåä¾‹ï¼Œé—ç•™çš„ React <code class=\"language-text\">createClass()</code> çš„ mixins ä¸å…è®¸ä½ è¿™æ ·åšï¼Œæœ‰æ—¶ä½ ä¼šæœ‰ä¸¤ä¸ª mixinsï¼Œå®ƒä»¬éƒ½æ˜¯ä½ æƒ³è¦çš„ï¼Œä½†ç”±äºæ‰©å±•äº†åŒä¸€ä¸ª ã€Œbaseã€ mixinï¼Œå› æ­¤äº’ä¸å…¼å®¹ã€‚)</p>\n<p>è¿™æ˜¯æˆ‘ä»¬çš„ ã€Œé’»çŸ³ã€ï¼šğŸ’</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">       / useWindowWidth()   \\                   / useState()  ğŸ”´ Clash\nStatus                        useSubscription() \n       \\ useNetworkStatus() /                   \\ useEffect() ğŸ”´ Clash</code></pre></div>\n<p>ä¾èµ–äºå›ºå®šçš„é¡ºåºè°ƒç”¨å¾ˆè‡ªç„¶çš„è§£å†³äº†å®ƒï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">                                                 / useState()  âœ… #1. State\n       / useWindowWidth()   -&gt; useSubscription()                    \n      /                                          \\ useEffect() âœ… #2. Effect\nStatus                         \n      \\                                          / useState()  âœ… #3. State\n       \\ useNetworkStatus() -&gt; useSubscription()\n                                                 \\ useEffect() âœ… #4. Effect</code></pre></div>\n<p>å‡½æ•°è°ƒç”¨ä¸ä¼šæœ‰ã€Œé’»çŸ³ã€é—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬ä¼šå½¢æˆæ ‘çŠ¶ç»“æ„ã€‚ğŸ„</p>\n<h3 id=\"ç¼ºé™·-5ï¼šå¤åˆ¶ç²˜è´´çš„ä¸»æ„è¢«æ‰“ä¹±\"><a href=\"#%E7%BC%BA%E9%99%B7-5%EF%BC%9A%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4%E7%9A%84%E4%B8%BB%E6%84%8F%E8%A2%AB%E6%89%93%E4%B9%B1\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¼ºé™· #5ï¼šå¤åˆ¶ç²˜è´´çš„ä¸»æ„è¢«æ‰“ä¹±</h3>\n<p>æˆ–è®¸æˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥æŸç§å‘½åç©ºé—´æ¥æŒ½æ•‘ç»™ state åŠ ã€Œkeyã€æè®®ï¼Œæœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>\n<p>ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨é—­åŒ…éš”ç¦» state çš„ keyï¼Œè¿™éœ€è¦ä½ åœ¨ ã€Œå®ä¾‹åŒ–ã€ custom hooksæ—¶ç»™æ¯ä¸ª hook è£¹ä¸Šä¸€å±‚ functionï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">/*******************\n * useFormInput.js *\n ******************/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createUseFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// æ¯æ¬¡å®ä¾‹åŒ–éƒ½å”¯ä¸€</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> valueKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>valueKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      value<span class=\"token punctuation\">,</span>\n      <span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™ç§ä½œæ³•éå¸¸ç¹çï¼ŒHooks çš„è®¾è®¡ç›®æ ‡ä¹‹ä¸€å°±æ˜¯é¿å…ä½¿ç”¨é«˜é˜¶ç»„ä»¶å’Œ render props çš„æ·±å±‚åµŒå¥—å‡½æ•°ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸å¾—ä¸åœ¨ä½¿ç”¨ <em>ä»»ä½•</em> custom hook æ—¶è¿›è¡Œã€Œå®ä¾‹åŒ–ã€ â€”â€” è€Œä¸”åœ¨ç»„ä»¶ä¸»ä½“ä¸­åªèƒ½å•æ¬¡ä½¿ç”¨ç”Ÿäº§çš„å‡½æ•°ï¼Œè¿™æ¯”ç›´æ¥è°ƒç”¨ Hooks éº»çƒ¦å¥½å¤šã€‚</p>\n<p>å¦å¤–ï¼Œä½ ä¸å¾—ä¸æ“ä½œä¸¤æ¬¡æ‰èƒ½ä½¿ç»„ä»¶ç”¨ä¸Š custom hookã€‚ä¸€æ¬¡åœ¨æœ€é¡¶å±‚(æˆ–åœ¨ç¼–å†™ custom hook æ—¶çš„å‡½æ•°é‡Œå¤´)ï¼Œè¿˜æœ‰ä¸€æ¬¡æ˜¯æœ€ç»ˆçš„è°ƒç”¨ã€‚è¿™æ„å‘³ç€å³ä½¿ä¸€ä¸ªå¾ˆå°çš„æ”¹åŠ¨ï¼Œä½ ä¹Ÿå¾—åœ¨é¡¶å±‚å£°æ˜å’Œrenderå‡½æ•°é—´æ¥å›è·³è½¬ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> useNameFormInput <span class=\"token operator\">=</span> <span class=\"token function\">createUseFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> useSurnameFormInput <span class=\"token operator\">=</span> <span class=\"token function\">createUseFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token function\">useNameFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> surname <span class=\"token operator\">=</span> <span class=\"token function\">useNameFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä½ è¿˜éœ€è¦éå¸¸ç²¾ç¡®çš„å‘½åï¼Œæ€»æ˜¯éœ€è¦è€ƒè™‘ã€Œä¸¤å±‚ã€å‘½å â€”â€” åƒ <code class=\"language-text\">createUseFormInput</code> è¿™æ ·çš„å·¥å‚å‡½æ•°å’Œ <code class=\"language-text\">useNameFormInput</code>ã€<code class=\"language-text\">useSurnameFormInput</code>è¿™æ ·çš„å®ä¾‹ Hooksã€‚</p>\n<p>å¦‚æœä½ åŒæ—¶è°ƒç”¨ä¸¤æ¬¡ç›¸åŒçš„ custom hook ã€Œå®ä¾‹ã€ï¼Œä½ ä¼šå‘ç”Ÿstateå†²çªã€‚äº‹å®ä¸Šï¼Œä¸Šé¢çš„ä»£ç å°±æ˜¯è¿™ç§é”™è¯¯ â€”â€” å‘ç°äº†å—ï¼Ÿ å®ƒåº”è¯¥ä¸ºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token function\">useNameFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> surname <span class=\"token operator\">=</span> <span class=\"token function\">useSurnameFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Not useNameFormInput!</span></code></pre></div>\n<p>è¿™äº›é—®é¢˜å¹¶éä¸å¯å…‹æœï¼Œä½†æˆ‘è®¤ä¸ºå®ƒä»¬ä¼šæ¯”éµå®ˆ <a href=\"https://reactjs.org/docs/hooks-rules.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hooksè§„åˆ™</a> çš„é˜»åŠ›å¤§äº›ã€‚</p>\n<p>é‡è¦çš„æ˜¯ï¼Œå®ƒä»¬æ‰“ç ´äº†å¤åˆ¶ç²˜è´´çš„å°ç®—ç›˜ã€‚åœ¨æ²¡æœ‰å°è£…å¤–å±‚çš„æƒ…å†µä¸‹è¿™ç§ custom hook ä»ç„¶å¯ä»¥ä½¿ç”¨ï¼Œä½†å®ƒä»¬åªå¯ä»¥è¢«è°ƒç”¨ä¸€æ¬¡(è¿™åœ¨ä½¿ç”¨æ—¶ä¼šäº§ç”Ÿé—®é¢˜)ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå½“ä¸€ä¸ªAPIçœ‹èµ·æ¥å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä¸€æ—¦ä½ æ„è¯†åˆ°åœ¨é“¾çš„æŸä¸ªåœ°æ–¹å‡ºç°äº†å†²çªæ—¶ï¼Œå°±ä¸å¾—ä¸æŠŠæ‰€æœ‰å®šä¹‰å¥½çš„ä¸œè¥¿åŒ…èµ·æ¥äº†ã€‚</p>\n<h3 id=\"ç¼ºé™·-6ï¼šæˆ‘ä»¬ä»ç„¶éœ€è¦ä¸€ä¸ªä»£ç æ£€æŸ¥å·¥å…·\"><a href=\"#%E7%BC%BA%E9%99%B7-6%EF%BC%9A%E6%88%91%E4%BB%AC%E4%BB%8D%E7%84%B6%E9%9C%80%E8%A6%81%E4%B8%80%E4%B8%AA%E4%BB%A3%E7%A0%81%E6%A3%80%E6%9F%A5%E5%B7%A5%E5%85%B7\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¼ºé™· #6ï¼šæˆ‘ä»¬ä»ç„¶éœ€è¦ä¸€ä¸ªä»£ç æ£€æŸ¥å·¥å…·</h3>\n<p>è¿˜æœ‰å¦å¤–ä¸€ç§ä½¿ç”¨å¯†é’¥stateæ¥é¿å…å†²çªçš„æ–¹æ³•ï¼Œå¦‚æœä½ çŸ¥é“ï¼Œå¯èƒ½ä¼šçœŸçš„å¾ˆç”Ÿæ°”ï¼Œå› ä¸ºæˆ‘ä¸çœ‹å¥½å®ƒï¼ŒæŠ±æ­‰ã€‚</p>\n<p>è¿™ä¸ªä¸»æ„å°±æ˜¯æ¯æ¬¡å†™ custom hook æ—¶ <em>ç»„åˆ</em> ä¸€ä¸ªå¯†é’¥ï¼Œå°±åƒè¿™æ ·ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> surname <span class=\"token operator\">=</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token string\">'surname'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">name</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">surname</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* ... */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>    \n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">formInputKey</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'useFormInput('</span> <span class=\"token operator\">+</span> formInputKey <span class=\"token operator\">+</span> <span class=\"token string\">').value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    value<span class=\"token punctuation\">,</span>\n    <span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å’Œå…¶ä»–æ›¿ä»£æè®®æ¯”ï¼Œæˆ‘æœ€ä¸å–œæ¬¢è¿™ä¸ªï¼Œæˆ‘è§‰å¾—å®ƒæ²¡æœ‰ä»€ä¹ˆä»·å€¼ã€‚</p>\n<p>ä¸€ä¸ª Hook ç»è¿‡å¤šæ¬¡è°ƒç”¨æˆ–è€…ä¸å…¶ä»– Hook å†²çªä¹‹åï¼Œä»£ç å¯èƒ½ <em>æ„å¤–äº§å‡º</em> éå”¯ä¸€æˆ–åˆæˆæ— æ•ˆå¯†é’¥è¿›è¡Œä¼ é€’ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœå®ƒæ˜¯åœ¨æŸäº›æ¡ä»¶ä¸‹å‘ç”Ÿçš„(æˆ‘ä»¬ä¼šè¯•å›¾ ã€Œä¿®å¤ã€ å®ƒå¯¹å§ï¼Ÿ)ï¼Œå¯èƒ½åœ¨ä¸€æ®µæ—¶é—´åæ‰å‘ç”Ÿå†²çªã€‚</p>\n<p>æˆ‘ä»¬æƒ³æé†’å¤§å®¶ï¼Œè®°ä½æ‰€æœ‰é€šè¿‡å¯†é’¥æ¥æ ‡è®°çš„ custom hooks éƒ½å¾ˆè„†å¼±ï¼Œå®ƒä»¬ä¸ä»…å¢åŠ äº†è¿è¡Œæ—¶çš„å·¥ä½œé‡(åˆ«å¿˜äº†å®ƒä»¬è¦è½¬æˆ <em>å¯†é’¥</em> )ï¼Œè€Œä¸”ä¼šæ¸æ¸å¢å¤§ bundle å¤§å°ã€‚<strong>ä½†å¦‚æœè¯´æˆ‘ä»¬éè¦æé†’ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯å“ªä¸ªé—®é¢˜å‘¢</strong>ï¼Ÿ</p>\n<p>å¦‚æœéè¦åœ¨æ¡ä»¶åˆ¤æ–­é‡Œå£°æ˜ state å’Œ effectsï¼Œè¿™ç§æ–¹æ³•å¯èƒ½æ˜¯æœ‰ä½œç”¨çš„ï¼Œä½†æŒ‰è¿‡å»ç»éªŒæ¥è¯´ï¼Œæˆ‘å‘ç°å®ƒä»¤äººå›°æƒ‘ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä¸è®°å¾—æœ‰äººä¼šåœ¨æ¡ä»¶åˆ¤æ–­é‡Œå®šä¹‰<code class=\"language-text\">this.state</code>æˆ–è€…<code class=\"language-text\">componentMount</code>çš„ã€‚</p>\n<p>è¿™æ®µä»£ç åˆ°åº•æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>isActive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'count'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å½“ <code class=\"language-text\">props.isActive</code> ä¸º <code class=\"language-text\">false</code> æ—¶ <code class=\"language-text\">count</code> æ˜¯å¦è¢«ä¿ç•™ï¼Ÿæˆ–è€…ç”±äº <code class=\"language-text\">useState(&#39;count&#39;)</code> æ²¡æœ‰è¢«è°ƒç”¨è€Œé‡ç½® <code class=\"language-text\">count</code>ï¼Ÿ</p>\n<p>å¦‚æœæ¡ä»¶ä¸ºä¿ç•™ stateï¼Œeffect åˆä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>isActive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'count'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span> <span class=\"token operator\">=></span> c <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ— ç–‘å®ƒä¸ä¼šåœ¨ <code class=\"language-text\">props.isActive</code> ç¬¬ä¸€æ¬¡æ˜¯ <code class=\"language-text\">true</code> <em>ä¹‹å‰</em> è¿è¡Œï¼Œä½†ä¸€æ—¦å˜æˆ <code class=\"language-text\">true</code>ï¼Œå®ƒä¼šåœæ­¢è¿è¡Œå—ï¼Ÿå½“ <code class=\"language-text\">props.isActive</code> è½¬å˜ä¸º <code class=\"language-text\">false</code> æ—¶ interval ä¼šé‡ç½®å—ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œeffect ä¸ state(æˆ‘ä»¬è¯´ä¸é‡ç½®æ—¶) çš„è¡Œä¸ºä¸åŒä»¤äººå›°æƒ‘ã€‚å¦‚æœ effect ç»§ç»­è¿è¡Œï¼Œé‚£ä¹ˆ effect å¤–å±‚çš„ <code class=\"language-text\">if</code> ä¸å†æ§åˆ¶ effectï¼Œè¿™ä¹Ÿä»¤äººæ„Ÿåˆ°å›°æƒ‘ï¼Œæˆ‘ä»¬ä¸æ˜¯è¯´æˆ‘ä»¬æƒ³è¦åŸºäºæ¡ä»¶æ§åˆ¶çš„ effects å—ï¼Ÿ  </p>\n<p>å¦‚æœåœ¨æ¸²æŸ“æœŸé—´æˆ‘ä»¬æ²¡æœ‰ã€Œä½¿ç”¨ã€ state ä½† å®ƒå´è¢«é‡ç½®ï¼Œå¦‚æœæœ‰å¤šä¸ª <code class=\"language-text\">if</code> åˆ†æ”¯åŒ…å« <code class=\"language-text\">useState(&#39;count&#39;)</code> ä½†åªæœ‰å…¶ä¸­ä¸€ä¸ªä¼šåœ¨ç»™å®šæ—¶é—´é‡Œè¿è¡Œï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè¿™æ˜¯æœ‰æ•ˆçš„ä»£ç å—ï¼Ÿå¦‚æœæˆ‘ä»¬çš„æ ¸å¿ƒæ€æƒ³æ˜¯ ã€Œä»¥å¯†é’¥åˆ†å¸ƒã€ï¼Œé‚£ä¸ºä»€ä¹ˆè¦ ã€Œä¸¢å¼ƒã€ å®ƒï¼Ÿå¼€å‘äººå‘˜æ˜¯å¦å¸Œæœ›åœ¨è¿™ä¹‹åä»ç»„ä»¶ä¸­æå‰ <code class=\"language-text\">return</code> ä»¥é‡ç½®æ‰€æœ‰ state å‘¢ï¼Ÿ å…¶å®å¦‚æœæˆ‘ä»¬çœŸçš„éœ€è¦é‡ç½®stateï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æå–ç»„ä»¶ä½¿å…¶æ˜ç¡®ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>isActive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\b\n    <span class=\"token comment\">// æ¸…æ™°åœ°çŸ¥é“å®ƒæœ‰è‡ªå·±çš„ state</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TickingCounter</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ— è®ºå¦‚ä½•è¿™å¯èƒ½æˆä¸ºæ˜¯è§£å†³è¿™äº›å›°æƒ‘é—®é¢˜çš„ã€Œæœ€ä½³å®è·µã€ï¼Œæ‰€ä»¥ä¸ç®¡ä½ é€‰æ‹©å“ªç§æ–¹å¼å»è§£é‡Šï¼Œæˆ‘è§‰å¾—æ¡ä»¶é‡Œ <em>å£°æ˜</em> state å’Œ effect çš„è¯­ä¹‰æ€æ ·éƒ½å¾ˆæ€ªå¼‚ï¼Œä½ å¯èƒ½ä¼šä¸çŸ¥ä¸è§‰çš„æ„Ÿå—åˆ°ã€‚</p>\n<p>å¦‚æœè¿˜è¦æé†’çš„æ˜¯ â€”â€” æ­£ç¡®åœ°ç»„åˆå¯†é’¥çš„éœ€æ±‚ä¼šå˜æˆã€Œè´Ÿæ‹…ã€ï¼Œå®ƒå¹¶æ²¡æœ‰ç»™æˆ‘ä»¬å¸¦æ¥ä»»ä½•æƒ³è¦çš„ã€‚ä½†æ˜¯ï¼Œæ”¾å¼ƒè¿™ä¸ªéœ€æ±‚(å¹¶å›åˆ°æœ€åˆçš„ææ¡ˆ)ç¡®å®ç»™æˆ‘ä»¬å¸¦æ¥äº†ä¸€äº›ä¸œè¥¿ï¼Œå®ƒä½¿ç»„ä»¶ä»£ç èƒ½å¤Ÿå®‰å…¨åœ°å¤åˆ¶ç²˜è´´åˆ°ä¸€ä¸ª custom hook ä¸­ï¼Œä¸”ä¸éœ€è¦å‘½åç©ºé—´ï¼Œå‡å° bundle å¤§å°åŠè½»å¾®çš„æ•ˆç‡æå‡(ä¸éœ€è¦MapæŸ¥æ‰¾)ã€‚</p>\n<p>æ…¢æ…¢ç†è§£ã€‚</p>\n<h3 id=\"ç¼ºé™·-7ï¼šhooks-ä¹‹é—´æ— æ³•ä¼ å€¼\"><a href=\"#%E7%BC%BA%E9%99%B7-7%EF%BC%9Ahooks-%E4%B9%8B%E9%97%B4%E6%97%A0%E6%B3%95%E4%BC%A0%E5%80%BC\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¼ºé™· #7ï¼šHooks ä¹‹é—´æ— æ³•ä¼ å€¼</h3>\n<p>Hooks æœ‰ä¸ªæœ€å¥½çš„åŠŸèƒ½å°±æ˜¯å¯ä»¥åœ¨å®ƒä»¬ä¹‹é—´ä¼ å€¼ã€‚</p>\n<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªé€‰æ‹©ä¿¡æ¯æ”¶ä»¶äººçš„æ¨¡æ‹Ÿç¤ºä¾‹ï¼Œå®ƒæ˜¾ç¤ºäº†å½“å‰é€‰æ‹©çš„å¥½å‹æ˜¯å¦åœ¨çº¿ï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> friendList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Phoebe'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Rachel'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Ross'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ChatRecipientPicker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>recipientID<span class=\"token punctuation\">,</span> setRecipientID<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isRecipientOnline <span class=\"token operator\">=</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span>recipientID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Circle</span></span> <span class=\"token attr-name\">color</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>isRecipientOnline <span class=\"token operator\">?</span> <span class=\"token string\">'green'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'red'</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span>\n        <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>recipientID<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token function\">setRecipientID</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>friendList<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">friend</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token punctuation\">{</span>friend<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">friendID</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleStatusChange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>friendID<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>friendID<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> isOnline<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å½“æ”¹å˜æ”¶ä»¶äººæ—¶ï¼Œ<code class=\"language-text\">useFriendStatus</code> Hook å°±ä¼šé€€è®¢ä¸Šä¸€ä¸ªå¥½å‹çš„çŠ¶æ€ï¼Œè®¢é˜…æ¥ä¸‹æ¥çš„è¿™ä¸ªã€‚</p>\n<p>è¿™æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥å°† <code class=\"language-text\">useState()</code> Hook è¿”å›çš„å€¼ä¼ ç»™ <code class=\"language-text\">useFriendStatus()</code> Hookï¼š</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>recipientID<span class=\"token punctuation\">,</span> setRecipientID<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isRecipientOnline <span class=\"token operator\">=</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span>recipientID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>Hooksä¹‹é—´ä¼ å€¼éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼š<a href=\"https://medium.com/@drcmda/hooks-in-react-spring-a-tutorial-c6c436ad7ee4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React Spring</a>å¯ä»¥åˆ›å»ºä¸€ä¸ªå°¾éšåŠ¨ç”»ï¼Œå…¶ä¸­å¤šä¸ªå€¼å½¼æ­¤ã€Œè·Ÿéšã€ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> pos1 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">set</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSpring</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> pos1<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> config<span class=\"token operator\">:</span> fast <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> pos2 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSpring</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> pos2<span class=\"token operator\">:</span> pos1<span class=\"token punctuation\">,</span> config<span class=\"token operator\">:</span> slow <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> pos3 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSpring</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> pos3<span class=\"token operator\">:</span> pos2<span class=\"token punctuation\">,</span> config<span class=\"token operator\">:</span> slow <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>(è¿™æ˜¯ <a href=\"https://codesandbox.io/s/ppxnl191zx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">demo</a>ã€‚)</p>\n<p>åœ¨Hookåˆå§‹åŒ–æ—¶æ·»åŠ é»˜è®¤å‚æ•°æˆ–è€…å°†Hookå†™åœ¨è£…é¥°å™¨è¡¨å•ä¸­çš„æè®®ï¼Œå¾ˆéš¾å®ç°è¿™ç§æƒ…å†µçš„é€»è¾‘ã€‚</p>\n<p>å¦‚æœä¸åœ¨å‡½æ•°ä½“å†…è°ƒç”¨ Hooksï¼Œå°±ä¸å¯ä»¥è½»æ¾åœ°åœ¨å®ƒä»¬ä¹‹é—´ä¼ å€¼äº†ã€‚ä½ å¯ä»¥æ”¹å˜è¿™äº›å€¼ç»“æ„ï¼Œè®©å®ƒä»¬ä¸éœ€è¦åœ¨å¤šå±‚ç»„ä»¶ä¹‹é—´ä¼ é€’ï¼Œä¹Ÿå¯ä»¥ç”¨ <code class=\"language-text\">useMemo</code> æ¥å­˜å‚¨è®¡ç®—ç»“æœã€‚ä½†ä½ ä¹Ÿæ— æ³•åœ¨ effects ä¸­å¼•ç”¨è¿™äº›å€¼ï¼Œå› ä¸ºå®ƒä»¬æ— æ³•åœ¨é—­åŒ…ä¸­è¢«è·å–åˆ°ã€‚æœ‰äº›æ–¹æ³•å¯ä»¥é€šè¿‡æŸäº›çº¦å®šæ¥è§£å†³è¿™äº›é—®é¢˜ï¼Œä½†å®ƒä»¬éœ€è¦ä½ åœ¨å¿ƒé‡Œã€Œæ ¸ç®—ã€è¾“å…¥å’Œè¾“å‡ºï¼Œè¿™è¿èƒŒäº† React ç›´æ¥äº†å½“çš„é£æ ¼ã€‚</p>\n<p>åœ¨ Hooks ä¹‹é—´ä¼ å€¼æ˜¯æˆ‘ä»¬ææ¡ˆçš„æ ¸å¿ƒï¼ŒRender props æ¨¡å¼åœ¨æ²¡æœ‰ Hooks æ—¶æ˜¯ä½ æœ€å…ˆèƒ½æƒ³åˆ°çš„ï¼Œä½†åƒ <a href=\"https://ui.reach.tech/component-component\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Component Component</a> è¿™æ ·çš„åº“ï¼Œæ˜¯æ— æ³•é€‚ç”¨äºä½ é‡åˆ°çš„æ‰€æœ‰åœºæ™¯çš„ï¼Œå®ƒç”±äºã€Œé”™è¯¯çš„å±‚æ¬¡ç»“æ„ã€å­˜åœ¨å¤§é‡çš„è¯­æ³•å¹²æ‰°ã€‚Hooks ç”¨æ‰å¹³åŒ–å±‚æ¬¡ç»“æ„æ¥å®ç°ä¼ å€¼ â€”â€” ä¸”å‡½æ•°è°ƒç”¨æ˜¯æœ€ç®€å•çš„ä¼ å€¼æ–¹å¼ã€‚</p>\n<h3 id=\"ç¼ºé™·-8ï¼šæ­¥éª¤ç¹ç\"><a href=\"#%E7%BC%BA%E9%99%B7-8%EF%BC%9A%E6%AD%A5%E9%AA%A4%E7%B9%81%E7%90%90\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¼ºé™· #8ï¼šæ­¥éª¤ç¹ç</h3>\n<p>æœ‰è®¸å¤šæè®®å¤„äºè¿™ç§èŒƒç•´é‡Œã€‚ä»–ä»¬å°½å¯èƒ½çš„æƒ³è®©Reactæ‘†è„±å¯¹ Hooks çš„ä¾èµ–æ„Ÿï¼Œå¤§å¤šæ•°æ–¹æ³•æ˜¯è¿™ä¹ˆåšçš„ï¼šè®© <code class=\"language-text\">this</code> æ‹¥æœ‰å†…ç½® Hooksï¼Œä½¿å®ƒä»¬å˜æˆé¢å¤–çš„å‚æ•°åœ¨Reactä¸­æ— å¤„ä¸åœ¨ï¼Œç­‰ç­‰ç­‰ã€‚</p>\n<p>æˆ‘è§‰å¾— <a href=\"https://github.com/reactjs/rfcs/pull/68#issuecomment-439314884\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Sebastiançš„å›ç­”</a> æ¯”æˆ‘çš„æè¿°ï¼Œæ›´èƒ½è¯´æœè¿™ç§æ–¹å¼ï¼Œæˆ‘å»ºè®®ä½ å»äº†è§£ä¸‹ã€Œæ³¨å…¥æ¨¡å‹ã€ã€‚</p>\n<p>æˆ‘åªæƒ³è¯´è¿™å’Œç¨‹åºå‘˜å€¾å‘äºç”¨ <code class=\"language-text\">try</code>/<code class=\"language-text\">catch</code> æ•è·æ–¹æ³•ä¸­çš„é”™è¯¯ä»£ç æ˜¯ä¸€æ ·çš„é“ç†ï¼ŒåŒæ ·å¯¹æ¯” AMDç”±æˆ‘ä»¬è‡ªå·±ä¼ å…¥ <code class=\"language-text\">require</code> çš„ã€Œæ˜¾ç¤ºã€å£°æ˜ï¼Œæˆ‘ä»¬æ›´å–œæ¬¢ <code class=\"language-text\">import</code>(æˆ–è€… CommonJS <code class=\"language-text\">require</code>) çš„ ESæ¨¡å—ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// æœ‰è°æƒ³å¿µ AMDï¼Ÿ</span>\n<span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'require'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dependency1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dependency2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">require</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> dependency1 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dependency1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">var</span> dependency2 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dependency2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ˜¯çš„ï¼ŒAMD å¯èƒ½æ›´ã€Œè¯šå®ã€ çš„é™ˆè¿°äº†åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­æ¨¡å—ä¸æ˜¯åŒæ­¥åŠ è½½çš„ï¼Œä½†å½“ä½ çŸ¥é“äº†è¿™ä¸ªåï¼Œå†™ <code class=\"language-text\">define</code>ä¸‰æ˜æ²» å°±å˜æˆåšæ— ç”¨åŠŸäº†ã€‚</p>\n<p><code class=\"language-text\">try</code>/<code class=\"language-text\">catch</code>ã€<code class=\"language-text\">require</code>å’Œ React Context APIéƒ½æ˜¯æˆ‘ä»¬æ›´å–œæ¬¢ã€Œç¯å¢ƒã€å¼ä½“éªŒï¼Œå¤šäºç›´æ¥å£°æ˜ä½¿ç”¨çš„çœŸå®ä¾‹å­(å³ä½¿é€šå¸¸æˆ‘ä»¬æ›´å–œæ¬¢ç›´çˆ½é£æ ¼)ï¼Œæˆ‘è§‰å¾— Hooks ä¹Ÿå±äºè¿™ç§ã€‚</p>\n<p>è¿™ç±»ä¼¼äºå½“æˆ‘ä»¬å£°æ˜ç»„ä»¶æ—¶ï¼Œå°±åƒä» <code class=\"language-text\">React</code> æŠ“ä¸ª <code class=\"language-text\">Component</code> è¿‡æ¥ã€‚å¦‚æœæˆ‘ä»¬ç”¨å·¥å‚çš„æ–¹å¼å¯¼å‡ºæ¯ä¸ªç»„ä»¶ï¼Œå¯èƒ½æˆ‘ä»¬çš„ä»£ç ä¼šæ›´è§£è€¦ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">createModal</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">React</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Modal</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä½†åœ¨å®é™…ä¸­ï¼Œè¿™æœ€åä¼šå˜å¾—å¤šæ­¤ä¸€ä¸¾è€Œä»¤äººåŒçƒ¦ã€‚å½“æˆ‘ä»¬çœŸçš„æƒ³ä»¥æŸç§æ–¹å¼æŠ“Reactæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨æ¨¡å—ç³»ç»Ÿå±‚é¢ä¸Šå®ç°ã€‚</p>","timeToRead":19,"frontmatter":{"title":"ä¸ºä»€ä¹ˆé¡ºåºè°ƒç”¨å¯¹ React Hooks å¾ˆé‡è¦ï¼Ÿ","date":"December 13, 2018","spoiler":"å­¦ä¹  mixinsï¼Œrender propsï¼Œ HOCsï¼Œå’Œ class çš„è¯¾ç¨‹ã€‚","cta":null},"fields":{"slug":"/zh-hans/why-do-hooks-rely-on-call-order/","langKey":"zh-hans"}}},"pageContext":{"slug":"/zh-hans/why-do-hooks-rely-on-call-order/","translations":["fr","es","zh-hans"],"translatedLinks":[]}}}