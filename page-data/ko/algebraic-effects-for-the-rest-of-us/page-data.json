{"componentChunkName":"component---src-templates-blog-post-js","path":"/ko/algebraic-effects-for-the-rest-of-us/","result":{"data":{"site":{"siteMetadata":{"title":"Overreacted","author":"Dan Abramov"}},"markdownRemark":{"id":"f7cb880e-2201-5b36-92eb-565fb3a40835","html":"<p><em>대수적 효과</em>에 대해 들어본 적이 있는가?</p>\n<p>대수적 효과가 무엇인지, 혹은 왜 관심을 가져야 하는지 알아내기 위한 나의 첫 번째 시도는 성공하지 못했다. <a href=\"https://www.eff-lang.org/handlers-tutorial.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">몇 개</a>의 <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2016/08/algeff-tr-2016-v2.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pdf 문서</a>를 찾아냈지만, 이 문서들은 나를 더 혼란스럽게 만들 뿐이었다.(학문적인 pdf 문서에는 나를 졸리게 만드는 뭔가가 있다.)</p>\n<p>하지만 내 동료인 Sebastian은 리액트 내부 구조를 위한 개념 모델(mental model)로써 <a href=\"https://mobile.twitter.com/sebmarkbage/status/763792452289343490\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">대수적</a> <a href=\"https://mobile.twitter.com/sebmarkbage/status/776883429400915968\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">효과를</a> <a href=\"https://mobile.twitter.com/sebmarkbage/status/776840575207116800\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">계속해서</a> <a href=\"https://mobile.twitter.com/sebmarkbage/status/969279885276454912\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">언급해왔다</a>. (Sebastian은 리액트 팀의 일원이며, Hooks과 Suspense를 비롯한 몇 가지 아이디어를 생각해냈다.) 나중에는, 대수적 효과가 리액트 팀에서 유행처럼 사용하는 농담이 되었고, 많은 대화가 이런 식으로 끝나게 되었다.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5fb19385d24afb94180b6ba9aeb2b8d4/066f9/effects.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 400px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 87.16216216216216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDBQL/xAAWAQEBAQAAAAAAAAAAAAAAAAACAwD/2gAMAwEAAhADEAAAAeVtVlNwrBdforHjhb//xAAdEAACAgEFAAAAAAAAAAAAAAABAgADERMhIjIz/9oACAEBAAEFAgu9yaYxCoK2K7NxEr85Z3//xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8BI//EABkRAAEFAAAAAAAAAAAAAAAAAAEAEBESUf/aAAgBAgEBPwESrHH/AP/EABsQAAMAAgMAAAAAAAAAAAAAAAABEQIhEBJh/9oACAEBAAY/AhbvC6pssbnhMtMRkM//xAAcEAABBQEBAQAAAAAAAAAAAAABABARIUExUXH/2gAIAQEAAT8h6MQS7j0Q0nDe0EQwmNK0gPhDXflh/9oADAMBAAIAAwAAABDcL/z/xAAZEQABBQAAAAAAAAAAAAAAAAARAAEQQVH/2gAIAQMBAT8QLWg2f//EABkRAQACAwAAAAAAAAAAAAAAAAEAECExUf/aAAgBAgEBPxBLKR7Iar//xAAeEAEAAgIBBQAAAAAAAAAAAAABABEhQaExUXGx8f/aAAgBAQABPxBLMvoqCCrF614lnURBHN9agjMlNH1m5Zjzl2rB2nGfcZefP//Z'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"\"Algebraic Effects\" caption on the \"Ancient Aliens\" guy meme\"\n        title=\"\"\n        src=\"/static/5fb19385d24afb94180b6ba9aeb2b8d4/066f9/effects.jpg\"\n        srcset=\"/static/5fb19385d24afb94180b6ba9aeb2b8d4/a80bd/effects.jpg 148w,\n/static/5fb19385d24afb94180b6ba9aeb2b8d4/1c91a/effects.jpg 295w,\n/static/5fb19385d24afb94180b6ba9aeb2b8d4/066f9/effects.jpg 400w\"\n        sizes=\"(max-width: 400px) 100vw, 400px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>알고보니 대수적 효과는 멋진 개념이었고, 내가 pdf 문서를 보며 생각했던 것처럼 무서운 것이 아니었다. <strong>만약 당신이 단지 리액트의 사용자일 뿐이라면 대수적 효과를 알 필요는 전혀 없다. 하지만 내가 그랬듯이 흥미가 생긴 독자라면, 계속해서 읽어보길 바란다.</strong></p>\n<p><em>(면책 조항: 나는 프로그래밍 언어 연구가가 아니며, 설명 중에 잘못된 내용이 있을 수도 있다. 나는 이 주제에 대한 전문가가 아니므로, 잘못된 내용이 있으면 알려주길 바란다.)</em></p>\n<h3 id=\"아직-실제-제품에-적용할-단계는-아니다\"><a href=\"#%EC%95%84%EC%A7%81-%EC%8B%A4%EC%A0%9C-%EC%A0%9C%ED%92%88%EC%97%90-%EC%A0%81%EC%9A%A9%ED%95%A0-%EB%8B%A8%EA%B3%84%EB%8A%94-%EC%95%84%EB%8B%88%EB%8B%A4\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>아직 실제 제품에 적용할 단계는 아니다</h3>\n<p><em>대수적 효과</em>는 연구중인 프로그래밍 언어 기능(feature)이다. 즉, <strong><code class=\"language-text\">if</code>나 함수, 혹은 <code class=\"language-text\">async / await</code>와는 다르게 실제 제품에서는 사용할 수 없다는 의미이다.</strong> 대수적 효과는 이 개념을 연구하기 위한 목적으로 만들어진 <a href=\"https://www.eff-lang.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">몇 가지</a> <a href=\"https://www.microsoft.com/en-us/research/project/koka/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">언어</a>에서만 사용할 수 있다. OCaml이 대수적 효과를 실제 언어에 적용하려는 시도를 하고 있지만… 아직은 <a href=\"https://github.com/ocaml-multicore/ocaml-multicore/wiki\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">진행중</a>이다. 바꿔 말하면, <a href=\"https://www.youtube.com/watch?v=otCpCn0l4Wo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">건드릴 수 없다(Can’t touch this)</a>.</p>\n<blockquote>\n<p>수정 : 몇몇 사람들에 따르면, 리습(Lisp) 언어에서 <a href=\"https://overreacted.io/algebraic-effects-for-the-rest-of-us/#learn-more\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">유사한 기능을 제공한다</a>고 한다. 즉, 리습을 사용하는 사람은 실제 제품에서 사용할 수 있다.</p>\n</blockquote>\n<h3 id=\"그럼-왜-관심을-가져야-할까\"><a href=\"#%EA%B7%B8%EB%9F%BC-%EC%99%9C-%EA%B4%80%EC%8B%AC%EC%9D%84-%EA%B0%80%EC%A0%B8%EC%95%BC-%ED%95%A0%EA%B9%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>그럼, 왜 관심을 가져야 할까?</h3>\n<p>만약 당신이 <code class=\"language-text\">goto</code>를 사용해서 코드를 작성하고 있는데, 누군가가 <code class=\"language-text\">if</code>문과 <code class=\"language-text\">for</code>문을 보여줬다고 생각해보자. 혹은 당신이 콜백 지옥에 빠져있는데, 누군가가 <code class=\"language-text\">async / await</code>를 보여줬다고 생각해보자. 멋지지 않은가?</p>\n<p>만약 당신이 프로그래밍의 특정 개념이 유행처럼 퍼지기 몇 년 전에 미리 배우고 싶어하는 사람이라면, 지금이 대수적 효과에 관심을 갖기 좋은 시기이다. 하지만 꼭 알아야 한다고 생각하진 않길 바란다. 이건 마치 1999년에 <code class=\"language-text\">async / await</code>를 생각하는 것과 비슷하다. </p>\n<h3 id=\"좋아-그럼-대수적-효과가-뭐지\"><a href=\"#%EC%A2%8B%EC%95%84-%EA%B7%B8%EB%9F%BC-%EB%8C%80%EC%88%98%EC%A0%81-%ED%9A%A8%EA%B3%BC%EA%B0%80-%EB%AD%90%EC%A7%80\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>좋아, 그럼 대수적 효과가 뭐지?</h3>\n<p>이름을 보면 뭔가 무섭게 느껴지지만, 개념은 아주 간단하다. <code class=\"language-text\">try / catch</code> 블록에 대해 잘 알고 있다면, 대수적 효과를 이해하는 건 매우 쉽다. </p>\n<p>먼저 <code class=\"language-text\">try / catch</code>를 복습해보자. 에러를 던지는(throw) 함수가 하나 있다고 가정해보자. 아마 그 함수와 <code class=\"language-text\">catch</code> 블록 사이에는 많은 함수가 있을 것이다. </p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A girl has no name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user1<span class=\"token punctuation\">,</span> user2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  user1<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  user2<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> arya <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gendry <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Gendry'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Oops, that didn't work out: \"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">getName</code> 함수 내에서 던진 에러는, 호출 스택을 거슬러 올라가서 <code class=\"language-text\">makeFriends</code> 함수를 지나 가장 가까운 <code class=\"language-text\">catch</code> 블록까지 전달된다. 이 동작은 <code class=\"language-text\">try / catch</code> 구문의 중요한 특징이다. 중간에 있는 함수는 에러 핸들링에 대해 전혀 신경쓰지 않아도 된다. </p>\n<p>C언어 등에 있는 에러 코드와는 다르게, <code class=\"language-text\">try / catch</code>문을 사용하면 에러가 누락될까 걱정하면서 중간에 있는 모든 레이어에서 에러를 직접 전달할 필요가 없다. 에러는 자동적으로 전달된다. </p>\n<h3 id=\"이게-대수적-효과랑-무슨-관계가-있는거지\"><a href=\"#%EC%9D%B4%EA%B2%8C-%EB%8C%80%EC%88%98%EC%A0%81-%ED%9A%A8%EA%B3%BC%EB%9E%91-%EB%AC%B4%EC%8A%A8-%EA%B4%80%EA%B3%84%EA%B0%80-%EC%9E%88%EB%8A%94%EA%B1%B0%EC%A7%80\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이게 대수적 효과랑 무슨 관계가 있는거지?</h3>\n<p>위의 예제에서는, 에러가 한 번 발생하면 이어서 진행할 수 없다. <code class=\"language-text\">catch</code> 블록에 도달하고 나면, 원래 코드를 이어서 실행할 수 있는 방법이 없는 것이다.</p>\n<p>이미 지난 일이고, 너무 늦었다. 우리가 할 수 있는 최선은 그저 오류를 복구하거나, 기존에 하려던 동작을 어떻게든 다시 시도하는 것일 뿐, 마치 마법처럼 원래 있던 곳으로 “돌아가서” 다른 일을 할 수는 없다. 하지만, 대수적 효과를 사용하면 가능하다.</p>\n<p>아래 예제는 자바스크립트를 가상으로 변경한 언어(재미삼아 ES2025라고 부르기로 하자)로 작성했으며, 이 언어에서는 누락된 <code class=\"language-text\">user.name</code>을 채워넣을 수 있다. </p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    name <span class=\"token operator\">=</span> perform <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user1<span class=\"token punctuation\">,</span> user2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  user1<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  user2<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> arya <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gendry <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Gendry'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> </span><span class=\"gatsby-highlight-code-line\">    resume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>(2025년에 이 글을 읽고 있는 독자들 중 “ES2025”로 웹페이지를 검색해서 찾아온 분들이 있다면 사과드린다. 만약 그 때 대수적 효과가 자바스크립트에 적용되어 있다면, 기쁜 마음으로 수정하겠다!)</em></p>\n<p><code class=\"language-text\">throw</code> 대신에, 가상의 <code class=\"language-text\">perform</code> 키워드를 사용했다. 마찬가지로, <code class=\"language-text\">try / catch</code> 대신에 가상의 <code class=\"language-text\">try / handle</code>를 사용했다. 단지 개념을 설명하기 위해 사용한 것이므로 구체적인 문법은 중요하지 않다.</p>\n<p>그럼 무슨 일이 일어날까? 좀 더 자세하게 살펴보자. </p>\n<p>에러를 던지는 대신, 우리는 <em>효과(effect)</em> 를 <em>수행(perform)</em> 한다. 어떤 값이든 <code class=\"language-text\">throw</code>할 수 있는 것과 마찬가지로, <code class=\"language-text\">perform</code>에도 어떤 값이든 전달할 수 있다. 이 예제에서는 문자열을 넘기고 있지만, 객체나 다른 어떤 데이터 타입도 사용 가능하다.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    name <span class=\"token operator\">=</span> perform <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">;</span>  </span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>에러를 <code class=\"language-text\">throw</code>할 때, 엔진은 호출 스택에서 가장 가까운 <code class=\"language-text\">try / catch</code> 에러 핸들러를 찾는다. 마찬가지로, 효과를 <code class=\"language-text\">perform</code>할 때, 엔진은 호출 스택에서 가장 가까운 <code class=\"language-text\">try / handle</code> 효과 핸들러를 찾을 것이다. </p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    resume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 효과는 이름이 누락된 경우 어떻게 처리해야 할 지를 결정할 수 있게 해 준다. 예외(exception)를 사용할 때와 비교해서 새로 추가된 부분은 가상의 <code class=\"language-text\">resume with</code> 구문이다. </p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    resume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 구문은 <code class=\"language-text\">try / catch</code>로는 할 수 없는 일을 한다. 이 구문을 사용하면 <strong>효과가 수행(perform)된 곳으로 다시 돌아갈 수 있고, 핸들러를 통해서 뭔가를 다시 전달할 수 있다.</strong> 🤯</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// 1. 여기서 효과를 수행(perform) 한다.</span></span>    name <span class=\"token operator\">=</span> perform <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// 4. ... 그리고 결국 여기로 돌아온다. (name값은 이제 'Arya Stark'이다)</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// 2. 핸들러로 점프한다 (try/catch 처럼)</span></span>  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// 3. 하지만, (try/catch와는 다르게!) 값을 전달하면서 기존 코드를 이어서 진행할 수 있다 </span></span>    resume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 구문에 익숙해지려면 시간이 좀 걸릴수도 있지만, 사실 개념적으로는 “재시작할 수 있는(resumable) <code class=\"language-text\">try / catch</code>“와 별 다를 것이 없다.</p>\n<p>하지만, <strong>대수적 효과는 <code class=\"language-text\">try / catch</code> 보다 훨씬 더 유연하며, 오류를 복구하는 것은 단지 수많은 활용 예 중의 하나일 뿐</strong>이라는 것을 기억하길 바란다. 내가 이 예제부터 시작한 이유는 단지 이해하기 가장 쉬웠기 때문이다.</p>\n<h3 id=\"색이-없는-함수\"><a href=\"#%EC%83%89%EC%9D%B4-%EC%97%86%EB%8A%94-%ED%95%A8%EC%88%98\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>색이 없는 함수</h3>\n<p>대수적 효과는 비동기 코드를 다룰 때 흥미로운 의미를 갖는다.</p>\n<p><code class=\"language-text\">async / await</code>를 사용하는 언어에서, <a href=\"https://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">함수는 보통 “색”을 갖는다</a>. 예를 들면, 자바스크립트에서 <code class=\"language-text\">makeFriends</code>와 그 함수의 호출자를 <code class=\"language-text\">async</code>로 만들지 않고 <code class=\"language-text\">getName</code> 함수를 비동기로 만드는 것은 불가능하다. 이런 특징 때문에, 특정 코드 조각이 경우에 따라 동기 혹은 비동기로 동작할 때, 아주 괴로운 상황이 발생할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 만약 이 함수를 async로 만들고 싶다면..</span>\n<span class=\"token keyword\">async</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 이 함수도 async가 되어야 한다.</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user1<span class=\"token punctuation\">,</span> user2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  user1<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  user2<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 이런 식으로 async가 게속 전파된다...</span></code></pre></div>\n<p>자바스크립트의 제러네이터도 <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">마찬가지다</a>. 제너레이터를 사용할 때는, 중간에 있는 코드도 제너레이터에 대해 알고 있어야 한다.</p>\n<p>이게 무슨 관계가 있는걸까?</p>\n<p><code class=\"language-text\">async / await</code>에 대해서는 잠시 잊어버리고, 다시 원래의 예제로 돌아가보자.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    name <span class=\"token operator\">=</span> perform <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">;</span>  </span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user1<span class=\"token punctuation\">,</span> user2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  user1<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  user2<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> arya <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gendry <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Gendry'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    resume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>효과 핸들러가 “대체할 이름(fallback name)“을 동기적으로 알 수 없다면 어떻게 해야 할까? 만약 데이터베이스에서 이름을 가져와야 한다면?</p>\n<p>알고 보면, 효과 핸들러에서 <code class=\"language-text\">resume with</code>를 비동기적으로 호출해도  <code class=\"language-text\">getName</code>이나 <code class=\"language-text\">makeFriends</code>를 변경할 필요가 전혀 없다. </p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> name <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    name <span class=\"token operator\">=</span> perform <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user1<span class=\"token punctuation\">,</span> user2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  user1<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  user2<span class=\"token punctuation\">.</span>friendNames<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span>user1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> arya <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gendry <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Gendry'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">makeFriends</span><span class=\"token punctuation\">(</span>arya<span class=\"token punctuation\">,</span> gendry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token operator\">===</span> <span class=\"token string\">'ask_name'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      resume <span class=\"token keyword\">with</span> <span class=\"token string\">'Arya Stark'</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>위의 예제에서, 1초가 지나기 전까지는 <code class=\"language-text\">resume with</code>를 호출하지 않는다. <code class=\"language-text\">resume with</code>를 한 번만 실행되는 콜백 함수라고 생각해도 된다. (혹은 “one-shot delimited continuation” 라고 불러서 친구들을 감명시킬 수도 있을 것이다.)</p>\n<p>이제 대수적 효과의 동작 방식에 대해서는 어느 정도 정리가 됐을 것이다. 우리가 에러를 <code class=\"language-text\">throw</code>할 때, 자바스크립트 엔진은 프로세스에 있는 지역 변수들을 제거하면서 “스택을 해제”한다. 하지만 효과를 <code class=\"language-text\">perform</code>할 때, 가상의 엔진은 함수의 나머지 부분들로 콜백 함수를 만들어낸 다음, <code class=\"language-text\">resume with</code>를 통해 그 함수를 호출한다. </p>\n<p>다시 한 번 강조하지만, 구체적인 문법과 키워드는 이 글을 위해서 만들어낸 것이다. 요점은 문법이나 키워드가 아니라 동작 방식에 있다.</p>\n<h2 id=\"순수성purity에-대해-알아둘-점\"><a href=\"#%EC%88%9C%EC%88%98%EC%84%B1purity%EC%97%90-%EB%8C%80%ED%95%B4-%EC%95%8C%EC%95%84%EB%91%98-%EC%A0%90\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>순수성(Purity)에 대해 알아둘 점</h2>\n<p>대수적 효과가 함수형 프로그래밍 연구에서 발생했다는 사실은 주목할 필요가 있다. 대수적 효과가 해결하는 문제들 중 일부는 순수 함수형 프로그래밍을 위한 것이다. 예를 들어, 임의의 부수 효과(side effect)를 허용하지 않는 언어(하스켈 등)에서는, 효과를 다루기 위해 모나드(Monad)와 같은 개념을 사용해야만 한다. 모나드 튜토리얼을 한 번이라도 읽어봤다면, 모나드가 꽤 이해하기 어렵다는 것을 알 것이다. 대수적 효과는 비슷한 일을 좀 더 단순한 형태로 할 수 있게 도와준다.</p>\n<p>내가 대수적 효과에 대한 수많은 논의들을 이해할 수 없던 이유는 바로 이 때문이다.(나는 하스켈과 그 친구들을 <a href=\"https://overreacted.io/things-i-dont-know-as-of-2018/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">모른다</a>.) 하지만, 나는 자바스크립트와 같이 순수하지 않은 언어에서도 <strong>대수적 효과가 코드에서 무엇(what)과 어떻게(how)를 분리할 수 있게 도와주는 아주 강력한 도구가 될 수 있다</strong>고 생각한다. </p>\n<p>대수적 효과는 “무엇”을 하는지에만 집중하는 코드를 작성할 수 있게 해 준다.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">enumerateFiles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dir</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> contents <span class=\"token operator\">=</span> perform <span class=\"token function\">OpenDirectory</span><span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span><span class=\"gatsby-highlight-code-line\">  perform <span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Enumerating files in '</span><span class=\"token punctuation\">,</span> dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> file <span class=\"token keyword\">of</span> contents<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    perform <span class=\"token function\">HandleFile</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </span>  <span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">  perform <span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Enumerating subdirectories in '</span><span class=\"token punctuation\">,</span> dir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span>  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> directory <span class=\"token keyword\">of</span> contents<span class=\"token punctuation\">.</span>dir<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 재귀를 사용하거나 효과를 갖는 다른 함수를 호출할 수도 있다</span>\n    <span class=\"token function\">enumerateFiles</span><span class=\"token punctuation\">(</span>directory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">  perform <span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Done'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>그리고, 나중에 “어떻게”를 명시하는 코드로 감싸면 된다.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">let</span> files <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">enumerateFiles</span><span class=\"token punctuation\">(</span><span class=\"token string\">'C:\\\\'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Log</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    myLoggingLibrary<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>effect<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    resume<span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">OpenDirectory</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    myFileSystemImpl<span class=\"token punctuation\">.</span><span class=\"token function\">openDir</span><span class=\"token punctuation\">(</span>effect<span class=\"token punctuation\">.</span>dirName<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">contents</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      resume <span class=\"token keyword\">with</span> contents<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">HandleFile</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    files<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>effect<span class=\"token punctuation\">.</span>fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    resume<span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 파일 배열은 이제 모든 파일을 갖고 있다.</span></code></pre></div>\n<p>그렇다면, 위의 코드 조각을 라이브러리로 만들 수도 있을 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> withMyLoggingLibrary <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'my-log'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> withMyFileSystem <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'my-fs'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ourProgram</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">enumerateFiles</span><span class=\"token punctuation\">(</span><span class=\"token string\">'C:\\\\'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">withMyLoggingLibrary</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">withMyFileSystem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">ourProgram</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">async / await</code>나 제너레이터와는 다르게, <strong>대수적 효과는 “중간에 있는” 함수들과 복잡하게 얽힐 필요가 없다</strong>. <code class=\"language-text\">enumerateFiles</code>을 <code class=\"language-text\">ourProgram</code> 내부의 깊은 곳에서 호출하더라도, 내부에서 수행(perform)하는 각 효과에 대한 핸들러가 외부 어딘가에 존재하는 한 코드는 잘 동작할 것이다.</p>\n<p>효과 핸들러를 사용하면, 불필요하게 많은 코드르 추가하지 않고도 효과에 대한 구체적인 구현 내용으로부터 프로그램 로직을 분리해낼 수 있다. 예를 들어, 테스트를 작성할 때 구체적인 행위를 완전히 오버라이드해서, 가상의 파일시스템을 사용하거나, 로그를 출력하는 대신 로그에 대한 스냅샷 테스트를 할 수도 있다. </p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> withFakeFileSystem <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'fake-fs'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">withLogSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fn</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> logs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n  \t<span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token function\">handle</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">effect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  \t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>effect <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Log</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  \t  logs<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>effect<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \t  resume<span class=\"token punctuation\">;</span>\n  \t<span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// Snapshot emitted logs.</span>\n  <span class=\"token function\">expect</span><span class=\"token punctuation\">(</span>logs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMatchSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my program'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> fakeFiles <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token comment\">/* ... */</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">withFakeFileSystem</span><span class=\"token punctuation\">(</span>fakeFiles<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  \t<span class=\"token function\">withLogSnapshot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">\t  <span class=\"token function\">ourProgram</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  \t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a href=\"https://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">“함수의 색”</a>이 없고(중간에 있는 코드는 효과에 대해 알 필요가 없음), 효과 핸들러를 조합할 수 있기 때문에(중첩해서 사용 가능), 대수적 효과를 사용하면 표현력 아주 뛰어난 추상화를 만들어낼 수 있다. </p>\n<h3 id=\"타입에-대해-알아둘-점\"><a href=\"#%ED%83%80%EC%9E%85%EC%97%90-%EB%8C%80%ED%95%B4-%EC%95%8C%EC%95%84%EB%91%98-%EC%A0%90\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>타입에 대해 알아둘 점</h3>\n<p>대수적 효과는 정적 타입 언어에서 나왔기 때문에, 많은 논의들이 타입을 사용한 표현 방법에 초점을 두고 있다. 사실 타입과의 관계가 중요하다는 것은 의심할 여지가 없지만, 반대로 개념을 잡는 데에 어려움을 줄 수도 있다. 이 글에서 타입에 대한 설명을 전혀 하지 않는 이유는 바로 이 때문이다. 하지만, 어떤 함수가 효과를 수행할 수 있다는 사실을 코드로 표현할 때 일반적으로 타입 시그니쳐를 사용한다는 것은 언급해야 할 것 같다. 그러면 어떤 임의의 효과가 발생했을 때, 그 효과가 어디서 왔는지 추적할 수 없는 상황을 방지할 수 있다.</p>\n<p>효과가 타입 시그니쳐의 일부라면, 기술적으로 보면 정적 타입 언어의 대수적 효과는 함수에 <a href=\"https://journal.stuffwithstuff.com/2015/02/01/what-color-is-your-function/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">“색을 할당한다”</a>라고 주장할 수도 있을 것이다. 그건 사실이다. 하지만 중간에 있는 함수에 새로운 효과를 추가하기 위해 타입 선언을 고치는 것은, <code class=\"language-text\">async</code> 키워드를 추가하거나 함수를 제너레이터로 변경하는 것과 같은 문법적인 변경이 아니다. 타입 추론 또한 연쇄적인 변경을 방지할 수 있다. 중요한 차이점은, 빈 함수나 가상 구현체(예를 들어, 비동기 효과를 동기 방식으로 호출하는)를 제공해서 효과를 상쇄시킬 수 있다는 점이다. 이를 통해, 필요에 따라 효과를 사용하는 코드가 외부에 영향을 미치지 않도록 제한할 수 있고, 혹은 다른 효과로 변경할 수도 있다.</p>\n<h3 id=\"대수적-효과를-자바스크립트에-포함시켜야-할까\"><a href=\"#%EB%8C%80%EC%88%98%EC%A0%81-%ED%9A%A8%EA%B3%BC%EB%A5%BC-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EC%97%90-%ED%8F%AC%ED%95%A8%EC%8B%9C%EC%BC%9C%EC%95%BC-%ED%95%A0%EA%B9%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대수적 효과를 자바스크립트에 포함시켜야 할까?</h3>\n<p>솔직히 나도 잘 모르겠다. 대수적 효과는 아주 강력하기 때문에, 누군가는 자바스크립트 같은 언어에서 사용하기에 너무 강력하다고 주장할 수도 있다. </p>\n<p>내 생각에 대수적 효과는 변경(mutation)이 일반적이지 않고, 표준 라이브러리에서 효과를 전적으로 지원하는 언어에 잘 어울리는 것 같다. 만약 <code class=\"language-text\">perform Timeout(1000)</code>, <code class=\"language-text\">perform Fetch(&#39;http://google.com&#39;)</code>, <code class=\"language-text\">perform ReadFile(&#39;file.txt&#39;)</code>등을 기본 기능으로 사용할 수 있고, 언어적으로 효과에 대한 패턴 매칭과 정적 타이핑을 지원한다면 아주 훌륭한 개발 환경이라 할 수 있을 것이다. </p>\n<p>어쩌면, 이런 언어가 자바스크립트로 컴파일 될 수도 있지 않을까!</p>\n<h3 id=\"이-모든-게-리액트와는-무슨-관계가-있을까\"><a href=\"#%EC%9D%B4-%EB%AA%A8%EB%93%A0-%EA%B2%8C-%EB%A6%AC%EC%95%A1%ED%8A%B8%EC%99%80%EB%8A%94-%EB%AC%B4%EC%8A%A8-%EA%B4%80%EA%B3%84%EA%B0%80-%EC%9E%88%EC%9D%84%EA%B9%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이 모든 게 리액트와는 무슨 관계가 있을까?</h3>\n<p>딱히 관련이 있는 건 아니다. 사실 억지로 끼워맞춘다는 느낌이 들 수도 있다.</p>\n<p><a href=\"https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">시간 분할(Time Slicing)과 보류(Suspense)에 대한 내 발표</a>에서, 두 번째 부분은 캐쉬로부터 데이터를 읽어오는 컴포넌트에 관한 내용이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">MovieDetails</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> id <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 아직 데이터를 가져오는 중이라면 어떨게 될까?</span>\n  <span class=\"token keyword\">const</span> movie <span class=\"token operator\">=</span> movieCache<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>(실제 발표는 약간 다른 API를 사용하지만, 그게 요점은 아니다.)</em></p>\n<p>이 코드는 리액트의 “Suspense”라는 기능을 사용하고 있으며, 이 기능은 데이터를 가져오는 용도로 현재 활발하게 개발중이다. 여기서 주의깊게 봐야 할 점은 <code class=\"language-text\">movieCache</code>에 데이터가 아직 없을수도 있다는 점이다. 이 경우 다음으로 진행할 수가 없기 때문에 뭔가를 처리해 줘야 한다. 기술적으로는는 이 경우 <code class=\"language-text\">read()</code>를 호출하면 프라미스를 던진다(throw). (그렇다. 프라미스를 throw한다 - 잘 생각해보자). 그러면 실행이 “보류”된다. 리액트는 그 프라미스를 잡아서, 그 프라미스가 해결되었을 때 컴포넌트 트리를 다시 렌더링하기 위해 기억해둔다.</p>\n<p>비록 이 기법이 대수적 효과에서 <a href=\"https://mobile.twitter.com/sebmarkbage/status/941214259505119232\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">착안한</a> 것이긴 하지만, 그 자체로 대수적 효과라고 할 순 없다. 하지만 둘은 동일한 목적을 갖는다. 호출 스택(이 경우, 리액트)의 중간에 있는 함수들을 신경쓸 필요 없이, 혹은 그 함수들을 <code class=\"language-text\">async</code>나 제너레이터 함수로 강제로 변경할 필요 없이, 호출 스택의 아래쪽에 있는 코드가 윗쪽에 있는 코드에게 뭔가를 전달할 수 있다. 물론, 자바스크립트에서는 실제로 나중에 코드를 다시 실행하는 것이 불가능하지만, 리액트의 입장에서 프라미스가 해결되었을 때 컴포넌트 트리를 다시 렌더링하는 것은 사실상 같은 개념이라고 볼 수 있다. 사용하는 프로그래밍 모델이 <a href=\"https://overreacted.io/react-as-a-ui-runtime/#purity\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">멱등성(idempotence)을 보장한다면</a>, 대수적 효과를 흉내낼 수 있다!</p>\n<p>대수적 효과의 또 다른 예시로 <a href=\"https://reactjs.org/docs/hooks-intro.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">훅(Hooks)</a>을 떠올리는 사람도 있을 것이다. 사람들이 가장 먼저 물어보는 것은 <code class=\"language-text\">useState</code>가 어떤 컴포넌트를 참조하고 있는지를 어떻게 알 수 있냐는 것이다. </p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">LikeButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// useState가 어떤 컴포넌트 안에 있는지를 어떻게 알 수 있을까?</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isLiked<span class=\"token punctuation\">,</span> setIsLiked<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://overreacted.io/how-does-setstate-know-what-to-do/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">이 글의 마지막 부분</a>에서 이미 정답을 설명했다. 리액트 객체에는 바로 지금 사용되고 있는 구현체를 가리키는 “현재 디스패처” 라는 변경 가능한 상태가 있다(<code class=\"language-text\">react-dom</code>을 사용하는 경우 <code class=\"language-text\">react-dom</code>의 디스패처를 가리킨다). 이와 유사하게, <code class=\"language-text\">LikeButton</code>의 내부 데이터 구조를 가리키는 “현재 컴포넌트”라는 속성도 있다. 이를 통해 <code class=\"language-text\">useState</code>가 무엇을 할 지를 알 수 있다.</p>\n<p>사람들이 훅에 익숙해지기 전에는, 분명히 어딘가 “지저분하다”라고 생각하는 경우가 많다. 공유된 변경 가능한 상태에 의존하는 것은 “잘못됐다는 느낌”을 준다. (그런데, <code class=\"language-text\">try / catch</code>는 자바스크립트 엔진에서 어떻게 구현되어 있을까?)</p>\n<p>하지만, 개념적으로는 <code class=\"language-text\">useState()</code>를 컴포넌트가 실행될 때 리액트에 의해 처리되는 <code class=\"language-text\">perform State()</code> 효과라고 볼 수 있다. 그렇게 보면, 왜 리액트(컴포넌트를 호출하는 코드)가 컴포넌트에게 상태를 제공해줄 수 있는지를 설명할 수 있다(리액트는 호출 스택의 윗쪽에 있으므로 효과 핸들러를 제공할 수 있다). 사실, <a href=\"https://github.com/ocamllabs/ocaml-effects-tutorial/#2-effectful-computations-in-a-pure-setting\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">상태를 구현하는 것</a>은 내가 본 대수적 효과의 튜토리얼에서 가장 흔하게 볼 수 있는 예제 중의 하나이다. </p>\n<p>다시 말하지만, 자바스크립트에는 대수적 효과가 없기 때문에, 리액트가 실제로 이렇게 동작하지는 않는다. 대신에 현재 컴포넌트를 저장하는 숨겨진 필드가 있으며, 또한 <code class=\"language-text\">useState</code>의 구현체를 갖는 현재 “디스패처”를 가리키는 필드도 있다. 심지어 성능 최적화에 사용되는 <a href=\"https://github.com/facebook/react/blob/2c4d61e1022ae383dd11fe237f6df8451e6f0310/packages/react-reconciler/src/ReactFiberHooks.js#L1260-L1290\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">마운트(mount)와 업데이트(update)만을 위한</a> 별도의 <code class=\"language-text\">useState</code> 구현체도 있다. 하지만 정말 열린 마음으로 받아들인다면, 사실상 이 코드를 효과 핸들러라고 볼 수도 있을 것이다.</p>\n<p>정리하자면, 자바스크립트에서 throw하는 기능은 어설프게나마 IO 효과의 역할을 하며(그 코드를 나중에 다시 실행하는 게 안전하고, CPU를 과하게 사용하지 않는 한),  <code class=\"language-text\">try / finally</code> 내부에 변경 가능한 “디스패처” 필드를 갖는 것은 어설프게나마 동기적 효과 핸들러의 역할을 한다고 볼 수 있다.</p>\n<p><a href=\"https://dev.to/yelouafi/algebraic-effects-in-javascript-part-4---implementing-algebraic-effects-and-handlers-2703\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">제너레이터를 사용하면</a> 훨씬 더 제대로 된 효과를 구현할 수도 있지만, 그 경우 자바스크립트 함수의 “투명한(transparent)” 본성을 포기하고 모든 함수를 제너레이터로 변경해야만 한다. 그건… 쩝.</p>\n<h3 id=\"더-알아보기\"><a href=\"#%EB%8D%94-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>더 알아보기</h3>\n<p>개인적으로는 내가 대수적 효과를 이렇게 잘 이해할 수 있다는 사실에 놀랐다. 나는 항상 모나드와 같은 추상적인 개념을 이해하기가 어려웠는데, 대수적 효과는 “단번에” 이해할 수 있었다. 이 글을 읽고 다른 사람들도 대수적 효과를 “단번에” 이해할 수 있길 바란다.</p>\n<p>대수적 효과가 주류로 사용될 수 있을지는 모르겠다. 만약 2025년까지 어떤 주류 언어도 대수적 효과를 지원하지 않는다면 실망스러울 것 같다. 5년 후에 꼭 다시 확인하라고 알려주길 바란다!</p>\n<p>물론 대수적 효과로 할 수 있는 일은 이보다 훨씬 많다. 하지만 이 개념을 사용해서 직접 코드를 작성하기 전까지는 실제로 그 위력을 체감하기가 매우 어렵다. 만약 이 글을 읽고 흥미가 생겼다면, 다음 자료를 좀 더 확인해보자.</p>\n<ul>\n<li><a href=\"https://github.com/ocamllabs/ocaml-effects-tutorial\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/ocamllabs/ocaml-effects-tutorial</a></li>\n<li><a href=\"https://www.janestreet.com/tech-talks/effective-programming/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.janestreet.com/tech-talks/effective-programming/</a></li>\n<li><a href=\"https://www.youtube.com/watch?v=hrBq8R_kxI0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.youtube.com/watch?v=hrBq8R_kxI0</a></li>\n</ul>\n<p>많은 사람들이 지적하길, 타입과 관련된 내용을 빼고 나면(내가 이 글에서 한 것처럼), 커먼 리습(Common Lisp)의 <a href=\"https://en.wikibooks.org/wiki/Common_Lisp/Advanced_topics/Condition_System\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">조건 시스템(condition system)</a>이 사실상 대수적 효과와 같은 기능이라고 한다. 또한 James Long이 쓴 <a href=\"https://jlongster.com/Whats-in-a-Continuation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">컨티뉴에이션(continuation)에 대한 글</a>을 보면, 내장 기능인 <code class=\"language-text\">call/cc</code>를 기초로 해서 재시작 가능한 예외를 실제로 구현하는 방법을 잘 설명하고 있다.</p>\n<p>만약 자바스크립트를 사용하는 사람들이 대수적 효과를 이해하는 데 도움을 줄 만한 자료가 있다면, 트위터를 통해 알려주기 바란다!</p>","timeToRead":16,"frontmatter":{"title":"모두를 위한 대수적 효과","date":"July 21, 2019","spoiler":"부리또가 아니다.","cta":null},"fields":{"slug":"/ko/algebraic-effects-for-the-rest-of-us/","langKey":"ko"}}},"pageContext":{"slug":"/ko/algebraic-effects-for-the-rest-of-us/","translations":["ja","ko","zh-hans"],"translatedLinks":[]}}}