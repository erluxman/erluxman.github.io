{"componentChunkName":"component---src-templates-blog-post-js","path":"/es/why-do-hooks-rely-on-call-order/","result":{"data":{"site":{"siteMetadata":{"title":"Overreacted","author":"Dan Abramov"}},"markdownRemark":{"id":"a656f6ac-8eeb-57f7-bcf6-dbeb5b5c9954","html":"<p>En React Conf 2018, el equipo de React present칩 <a href=\"https://reactjs.org/docs/hooks-intro.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">la propuesta de Hooks</a>.</p>\n<p>Si te gustar칤a saber qu칠 son los Hooks y que problemas resuelven, revisa <a href=\"https://www.youtube.com/watch?v=dpw9EHDh2bM\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">nuestras charlas</a> donde se introdujeron y <a href=\"https://medium.com/@dan_abramov/making-sense-of-react-hooks-fdbde8803889\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mi art칤culo posterior</a> donde se abordan frecuentes concepciones err칩neas.</p>\n<p>Lo m치s probable es que no te gusten los Hooks en un principio.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d498863e7382b4d5ee4d8753e6e74a1e/f868f/hooks-hn1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 19.594594594594593%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA1UlEQVQY01VQ266CMBDk/7/oJB5UKNDW0yLwIDExIl4QOCRG/YBxd6MPPkxmOzubTibo+yO67gDm67UVHscTHo9/wfM5Cd/v4xez/gG/b7eeMCAwJkaaLhFFM8RxiCRZII5+ZV6tElijZK/UHDpbIgx/oDXfLJCSlz0Z6bvdBpfLHkFdF2LIcwNrFZzTWK8tqsqjLB3pFrnXdJjC0459Wkcoij+ZvcvgvUFdl5I+YNFQCmalQjFWlZNkTbPFNHX0c0O1NDif91RJK0m4poHqGd4VsYe9L/zQGSMpPy/HAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Negative HN comment\"\n        title=\"\"\n        src=\"/static/d498863e7382b4d5ee4d8753e6e74a1e/fcda8/hooks-hn1.png\"\n        srcset=\"/static/d498863e7382b4d5ee4d8753e6e74a1e/12f09/hooks-hn1.png 148w,\n/static/d498863e7382b4d5ee4d8753e6e74a1e/e4a3f/hooks-hn1.png 295w,\n/static/d498863e7382b4d5ee4d8753e6e74a1e/fcda8/hooks-hn1.png 590w,\n/static/d498863e7382b4d5ee4d8753e6e74a1e/efc66/hooks-hn1.png 885w,\n/static/d498863e7382b4d5ee4d8753e6e74a1e/c83ae/hooks-hn1.png 1180w,\n/static/d498863e7382b4d5ee4d8753e6e74a1e/f868f/hooks-hn1.png 1382w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<blockquote>\n<p>Mi instinto me dice que los Hooks no son la m치s grande adici칩n a React. Algo que siempre he alabado de React es la API limpia y extremadamente expl칤cita (siendo <code class=\"language-text\">dangerouslySetInnerHTML</code> mi ejemplo favorito). La API de los hooks toma el camino peligroso de lo impl칤cito y la magia lo que para m칤 solo puede traducirse en cosas malas.</p>\n</blockquote>\n<p>Son como un disco que gusta solo despu칠s de escucharlo varias veces:</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b31774c3ef4f2239bf9e62fe9272662b/1dbe8/hooks-hn2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 23.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABBklEQVQY0z1Q2XKCQBDk//8nFcsCUwJyhuUIBEuFeKBERcHyeuzMTkIeunp7pmd7apTNpsB2+4W6XqGqSuIljscKl8uB0bbfzF13+OM91fb//d5zvTZ4PFooInAQChdCOHBdA75v8TsIbCRJgDj2WUeRR70JfG8Cx9ZJ+9wLaN5zTf6j3i2hSNEP9RyGLqLQowAT6YdgyKAsC3/D3m0OlD4ZwEuRv2l2UIbDF5jmG0bagNm2xtDUAcZjFbquEWswjBFU9RW6rBFkkOPosMhrUs+mjaV3vV5Amc8zrFZzTPMEeR5jNkuJE+aynKIociwWn6zTVOB0rvF8drjfzwx5t9vtxJB3/AEwKl21CwjATgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Positive HN comment from the same person four days later\"\n        title=\"\"\n        src=\"/static/b31774c3ef4f2239bf9e62fe9272662b/fcda8/hooks-hn2.png\"\n        srcset=\"/static/b31774c3ef4f2239bf9e62fe9272662b/12f09/hooks-hn2.png 148w,\n/static/b31774c3ef4f2239bf9e62fe9272662b/e4a3f/hooks-hn2.png 295w,\n/static/b31774c3ef4f2239bf9e62fe9272662b/fcda8/hooks-hn2.png 590w,\n/static/b31774c3ef4f2239bf9e62fe9272662b/efc66/hooks-hn2.png 885w,\n/static/b31774c3ef4f2239bf9e62fe9272662b/c83ae/hooks-hn2.png 1180w,\n/static/b31774c3ef4f2239bf9e62fe9272662b/1dbe8/hooks-hn2.png 1374w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<blockquote>\n<p>Despu칠s de filtrar esta API por los 칰ltimos 3 d칤as y actualizarme con la RFC, he cambiado mi posici칩n. Cre칤 que no pod칤a dejar este comentario as칤, porque ya no refleja mi posici칩n. Creo que los hooks son maravillosos. Si el equipo de React logra concretar la API pienso que revolucionar치n la forma en que trabajamos en React. A칰n siento que subir치n un poco la barrera de entrada, pero para un desarrollador experimentado de React son fant치sticos.</p>\n</blockquote>\n<p>Cuando leas la documentaci칩n, no te pierdas <a href=\"https://reactjs.org/docs/hooks-custom.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">la p치gina m치s importante</a> 춰acerca de construir tus propios Hooks! Demasiados se fijan solo en una parte de nuestro mensaje con la que no est치n de acuerdo (p. ej., que aprender clases es dif칤cil) y pierden de vista el concepto m치s amplio detr치s de los Hooks. Y este es que los <strong>Hooks son como <em>mixins funcionales</em> que te permiten crear y componer tus propias abstracciones.</strong></p>\n<p>Los Hooks <a href=\"https://reactjs.org/docs/hooks-faq.html#what-is-the-prior-art-for-hooks\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">est치n influenciados por conocimiento previo</a>, pero no he visto nada <em>exactamente</em> igual hasta que Sebastian comparti칩 su idea con el equipo. Desgraciadamente, es f치cil dejar pasar la conexi칩n que existe entre las decisiones espec칤ficas sobre las API y las valiosas propiedades que abre este dise침o. Con este art칤culo espero ayudar a m치s personas a entender la raz칩n detr치s del aspecto m치s controversial de la propuesta de los Hooks.</p>\n<p><strong>El resto de este art칤culo asume que conoces la API Hook <code class=\"language-text\">useState()</code> y c칩mo escribir un Hook personalizado. Si no lo sabes, revisa los enlaces anteriores. Adem치s, ten en mente que los Hooks son experimentales y no tienes que aprenderlos ahora mismo!</strong></p>\n<p>(Nota aclaratoria: Este es un art칤culo a t칤tulo personal y no refleja necesariamente las opiniones del equipo de React. Es largo, el tema es complejo y puede que haya cometido algunos errores en alguna parte).</p>\n<hr>\n<p>El primero y probablemente el mayor impacto que recibes al aprender sobre los Hooks es que dependen de un <em>칤ndice persistente de invocaci칩n entre invocaciones</em>. Esto tiene varias <a href=\"https://reactjs.org/docs/hooks-rules.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">implicaciones</a>.</p>\n<p>La decisi칩n claramente es controvertida. Por ello, <a href=\"https://www.reddit.com/r/reactjs/comments/9xs2r6/sebmarkbages_response_to_hooks_rfc_feedback/e9wh4um/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">contra nuestros principios</a>, solo publicamos esta propuesta despu칠s que sentimos que la documentaci칩n y las charlas los describ칤an suficientemente bien para que se le diera un oportunidad justa.</p>\n<p><strong>Si est치s preocupado con alg칰n aspecto del dise침o de la API de los Hooks, te animo a leer la <a href=\"https://github.com/reactjs/rfcs/pull/68#issuecomment-439314884\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">respuesta completa</a> de Sebastian a los m치s de 1 000 comentarios en el debate de la RFC.</strong> Es abarcador, pero tambi칠n bastante denso. Probablemente podr칤a convertir cada p치rrafo de ese comentario en un art칤culo independiente. (De hecho, 춰ya <a href=\"/how-does-setstate-know-what-to-do/\">lo hice</a> una vez!)</p>\n<p>Hay una parte en espec칤fico en la que me gustar칤a enfocarme hoy. Como quiz치 recuerdes, cada Hook se puede usar en un componente m치s de una vez. Por ejemplo, podemos declarar <a href=\"https://reactjs.org/docs/hooks-state.html#tip-using-multiple-state-variables\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">m칰ltiples variables de estado</a> al invocar a <code class=\"language-text\">useState()</code> repetidamente:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Mary'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>              <span class=\"token comment\">// Variable de estado 1</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Poppins'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">// Variable de estado 2</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Variable de estado 3</span></span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleResize</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setWidth</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> handleResize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> handleResize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleNameChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handleSurnameChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setSurname</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleNameChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>surname<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleSurnameChange<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Hello, </span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span>surname<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Window width: </span><span class=\"token punctuation\">{</span>width<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>F칤jate que utilizamos la sintaxis de desestructuraci칩n de arreglos para nombrar las variables de estado de <code class=\"language-text\">useState()</code>, pero estos nombres no se le pasan a React. En su lugar, en este ejemplo, <strong>React trata a <code class=\"language-text\">name</code> como 춺la primera variable de estado췉, a <code class=\"language-text\">surname</code> como 춺la segunda variable de estado췉, y as칤 sucesivamente</strong>. Su <em>칤ndice de invocaci칩n</em> es lo que les da una identidad estable entre cada nuevo renderizado. Este modelo mental est치 bien descrito <a href=\"https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">en este art칤culo</a>.</p>\n<p>A nivel superficial, depender del 칤ndice de invocaci칩n <em>no parece correcto</em>. Una intuici칩n es una se침al 칰til, pero puede estar errada; especialmente si no hemos comprendido del todo el problema que estamos resolviendo. <strong>En este art칤culo, tomar칠 algunas alternativas de dise침o para los Hooks sugeridas con frecuencia y mostrar칠 cuando se derrumban.</strong></p>\n<hr>\n<p>Este art칤culo no ser치 exhaustivo. Dependiendo con cu치nta granularidad cuentes, hemos visto desde una docena hasta <em>cientos</em> de propuestas alternativas. Tambi칠n nosotros hemos <a href=\"https://github.com/reactjs/react-future\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pensado</a> en API alternativas para componentes durante los 칰ltimos cinco a침os.</p>\n<p>Art칤culos como este son complicados porque aun si se cubren cien alternativas, alguien puede parar y decir: 춺!Ah, no pensaste en <em>esa</em>!췉.</p>\n<p>En la pr치ctica, diferentes propuestas alternativas tienden a solaparse en sus desventajas. En lugar de enumerar <em>todas</em> las API sugeridas (lo que me tomar칤a meses), demostrar칠 los defectos m치s comunes con ejemplos espec칤ficos. Categorizar otras API posibles de acuerdo a estos problemas podr칤a ser un ejercicio para el lector. 游븷</p>\n<p><em>Eso no quiere decir que los Hooks no tengan defectos.</em> Pero una vez que te familiarizas con los de otras soluciones, puede que le empieces a hallar sentido al dise침o de los Hooks.</p>\n<hr>\n<h3 id=\"defecto-n췈-1-no-permite-extraer-un-hook-personalizado\"><a href=\"#defecto-n%C2%BA-1-no-permite-extraer-un-hook-personalizado\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Defecto n.췈 1: No permite extraer un Hook personalizado</h3>\n<p>Sorprendentemente, muchas propuestas alternativas no permiten en lo absoluto <a href=\"https://reactjs.org/docs/hooks-custom.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hooks personalizados</a>. Quiz치 no enfatizamos lo suficiente a los Hooks personalizados en la documentaci칩n de la 춺motivaci칩n췉. Es dif칤cil hacerlo hasta que las primitivas se comprenden bien, por lo que es el problema del huevo y la gallina. Pero los Hooks personalizados son por mucho el punto de toda la propuesta.</p>\n<p>Por ejemplo, una alternativa prohib칤a m칰ltiples invocaciones a <code class=\"language-text\">useState()</code> en un componente. Tendr칤as que mantener el estado en un objeto, 쯙unciona para las clases, no?</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">'Mary'</span><span class=\"token punctuation\">,</span>\n    surname<span class=\"token operator\">:</span> <span class=\"token string\">'Poppins'</span><span class=\"token punctuation\">,</span>\n    width<span class=\"token operator\">:</span> window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Seamos claros, los Hooks <em>s칤</em> permiten este estilo. No <em>tienes que</em> dividir tu estado en varias variables de estado (mira nuestras <a href=\"https://reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">recomendaciones</a> en las preguntas frecuentes).</p>\n<p>Pero el punto de permitir m칰ltiples invocaciones a <code class=\"language-text\">useState()</code> es que puedas <em>extraer</em> partes de l칩gica con estado (estado + efectos) de tu componente en Hooks personalizados que pueden <em>tambi칠n</em> usar independientemente estado local y efectos.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Se declaran algunas variables de estado directamente en el cuerpo del componente</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Mary'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Poppins'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// Movemos algo de estado y efectos hacia un Hook personalizado</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> width <span class=\"token operator\">=</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Se declara algo de estado y efecto en un Hook personalizado</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> width<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Si solo permites una invocaci칩n a <code class=\"language-text\">useState()</code> por componente, pierdes la habilidad de los Hooks personalizados para introducir estado local, que es b치sicamente el punto de los Hooks personalizados.</p>\n<h3 id=\"defecto-n췈-2-conflictos-de-nombre\"><a href=\"#defecto-n%C2%BA-2-conflictos-de-nombre\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Defecto n.췈 2: Conflictos de nombre</h3>\n<p>Otra sugerencia com칰n es permitir a <code class=\"language-text\">useState()</code> que acepte como argumento una llave (p. ej. una cadena) que identifique de manera 칰nica una variable de estado en particular dentro de un componente.</p>\n<p>Hay algunas variaciones de esta idea, pero todas lucen aproximadamente como esta:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 丘멆잺 Esta NO es la API de los Hooks de React</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Pasamos alg칰n tipo de llave de estado a useState()</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'surname'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span></code></pre></div>\n<p>Esto intenta evitar la dependencia en el 칤ndice de invocaci칩n (춰s칤, llaves expl칤citas!), pero introduce otro problema: Conflictos de nombre.</p>\n<p>De acuerdo, probablemente no te ver치s tentado a invocar <code class=\"language-text\">useState(&#39;name&#39;)</code> dos veces en el mismo componente a no ser por error. Puede ocurrir accidentalmente, pero podr칤amos decir eso de cualquier error. Sin embargo, es bastante probable que cuando trabajes en un <em>Hook personalizado</em> querr치s a침adir o eliminar variables de estado y efectos.</p>\n<p>Con esta propuesta, cada vez que a침ades una variable de estado dentro de un Hook personalizado, te arriesgas a quebrar cualquier componente que lo use (directa o transitivamente), porque <em>podr칤an estar usando el mismo nombre</em> para sus propias variables de estado.</p>\n<p>Este es un ejemplo de una API que no est치 <a href=\"/optimized-for-change/\">optimizada para el cambio</a>. El c칩digo actual puede que luzca siempre 춺elegante췉, pero es muy fr치gil en cuanto a cambios en los requerimientos se refiere. Debemos <a href=\"https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html#mixins-cause-name-clashes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">aprender</a> de nuestros errores.</p>\n<p>La propuesta real de los Hooks resuelve esto al depender en el orden de invocaci칩n: a칰n si dos Hooks usan una variable de estado <code class=\"language-text\">name</code> estar칤an aislados entre s칤. Cada invocaci칩n a <code class=\"language-text\">useState()</code> obtiene su propia 춺celda de memoria췉.</p>\n<p>A칰n hay otras formas de resolver este defecto, pero siempre tienen sus propios inconvenientes. Exploremos este espacio problem치tico m치s detenidamente.</p>\n<h3 id=\"defecto-n췈-3-no-se-puede-invocar-dos-veces-al-mismo-hook\"><a href=\"#defecto-n%C2%BA-3-no-se-puede-invocar-dos-veces-al-mismo-hook\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Defecto n.췈 3: No se puede invocar dos veces al mismo Hook</h3>\n<p>Otra variaci칩n de la propuesta 춺con llave췉 de <code class=\"language-text\">useState</code> es usar algo como <code class=\"language-text\">Symbol</code>. 쯃os s칤mbolos no pueden colisionar, no?</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 丘멆잺 Esta NO es la API de los Hooks de React</span>\n<span class=\"token keyword\">const</span> nameKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> surnameKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> widthKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Pasamos alg칰n tipo de llave de estado a useState()</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>nameKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>surnameKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>widthKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span></code></pre></div>\n<p>Esta propuesta parece funcionar para extraer el Hook <code class=\"language-text\">useWindowWidth()</code>:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 丘멆잺 Esta NO es la API de los Hooks de React</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> width <span class=\"token operator\">=</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/*********************\n * useWindowWidth.js *\n ********************/</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> widthKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"> </span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>widthKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// ...</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> width<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>Pero fallar칤a si intentamos extraer el manejo de los campos de entrada:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 丘멆잺 Esta NO es la API de los Hooks de React</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> surname <span class=\"token operator\">=</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">name</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">surname</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* ... */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/*******************\n * useFormInput.js *\n ******************/</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> valueKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"> </span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>valueKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    value<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>(Admito que este Hook <code class=\"language-text\">useFormInput()</code> no es particularmente 칰til, pero podr칤as imaginarlo para el manejo de la validaci칩n y del cambio de los monitores de estado de manera similar a <a href=\"https://github.com/jaredpalmer/formik\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Formik</a>).</p>\n<p>Detectas el error?</p>\n<p>Estamos invocando <code class=\"language-text\">useFormInput()</code> dos veces pero <code class=\"language-text\">useFormInput()</code> siempre invoca a <code class=\"language-text\">useState()</code> con la misma llave. Por tanto estamos haciendo efectivamente algo como esto:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>valueKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>surname<span class=\"token punctuation\">,</span> setSurname<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>valueKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Y as칤 es como obtenemos de nuevo una colisi칩n.</p>\n<p>La propuesta real de los Hooks no tienen este problema porque <strong>cada <em>invocaci칩n</em> a <code class=\"language-text\">useState()</code> obtiene su propio estado aislado.</strong> Depender de un 칤ndice de invocaci칩n persistente nos libera de la preocupaci칩n de las colisiones de nombre.</p>\n<h3 id=\"defecto-n췈-4-el-problema-del-diamante\"><a href=\"#defecto-n%C2%BA-4-el-problema-del-diamante\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Defecto n.췈 4: El problema del diamante</h3>\n<p>T칠cnicamente este es el mismo defecto que el anterior, pero vale la pena mencionarlo por su notoriedad. Incluso <a href=\"https://es.wikipedia.org/wiki/Problema_del_diamante\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">se describe en Wikipedia</a>. (Aparentemente, a veces se le llama 춺el letal diamante de la muerte췉, 춰genial!).</p>\n<p>Lo <a href=\"https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html#mixins-cause-name-clashes\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">sufrimos en carne propia</a> con nuestro sistema de mixins.</p>\n<p>Dos Hooks personalizados como <code class=\"language-text\">useWindowWidth()</code> y <code class=\"language-text\">useNetworkStatus()</code> podr칤an querer usar internamente un mismo Hook personalizado como <code class=\"language-text\">useSubscription()</code>:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">StatusMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> width <span class=\"token operator\">=</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> isOnline <span class=\"token operator\">=</span> <span class=\"token function\">useNetworkStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Window width is </span><span class=\"token punctuation\">{</span>width<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">You are </span><span class=\"token punctuation\">{</span>isOnline <span class=\"token operator\">?</span> <span class=\"token string\">'online'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'offline'</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useSubscription</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">subscribe<span class=\"token punctuation\">,</span> unsubscribe<span class=\"token punctuation\">,</span> getValue</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>state<span class=\"token punctuation\">,</span> setState<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleChange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">unsubscribe</span><span class=\"token punctuation\">(</span>handleChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useWindowWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> width <span class=\"token operator\">=</span> <span class=\"token function\">useSubscription</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span>innerWidth</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> width<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useNetworkStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isOnline <span class=\"token operator\">=</span> <span class=\"token function\">useSubscription</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'online'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">      window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'offline'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token parameter\">handler</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'online'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">      window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'offline'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> navigator<span class=\"token punctuation\">.</span>onLine</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> isOnline<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Este es un caso completamente v치lido. <strong>Deber칤a ser seguro para el autor de un Hook personalizado comenzar o parar de usar otro Hook personalizado sin preocuparse por si 춺ya est치 siendo usado췉 en alg칰n lugar de la cadena.</strong> De hecho, <em>no puedes conocer</em> la cadena completa a menos que audites en cada cambio cada componente que usa tu Hook.</p>\n<p>(Como contraejemplo, el mixin heredado <code class=\"language-text\">createClass()</code> no te permit칤a hacer esto. A veces acabar칤as con dos mixins que hac칤an exactamente lo que necesitabas pero eran mutualmente incompatibles pues heredaban del mismo mixin 춺base췉).</p>\n<p>Este es nuestro 춺diamante췉:  游눑</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">       / useWindowWidth()   \\                   / useState()  游댮 Colisi칩n\nStatus                        useSubscription() \n       \\ useNetworkStatus() /                   \\ useEffect() 游댮 Colisi칩n</code></pre></div>\n<p>La dependencia en el orden de invocaci칩n persistente naturalmente lo resuelve:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">                                                 / useState()  九 #1. Estado\n       / useWindowWidth()   -&gt; useSubscription()                    \n      /                                          \\ useEffect() 九 #2. Efecto\nStatus                         \n      \\                                          / useState()  九 #3. Estado\n       \\ useNetworkStatus() -&gt; useSubscription()\n                                                 \\ useEffect() 九 #4. Efecto</code></pre></div>\n<p>Las invocaciones a funciones no tienen un problema de 춺diamante췉 porque forman un 치rbol. 游꾻</p>\n<h3 id=\"defecto-n췈-5-copiar-y-pegar-quiebra-las-cosas\"><a href=\"#defecto-n%C2%BA-5-copiar-y-pegar-quiebra-las-cosas\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Defecto n.췈 5: Copiar y pegar quiebra las cosas</h3>\n<p>Quiz치 podr칤amos salvar la propuesta del estado con llave al introducir alg칰n tipo de espacio de nombre. Hay varias formas diferentes de hacerlo.</p>\n<p>Una forma ser칤a aislar las llaves de estado con clausuras. Ello requerir칤a que 춺instanciaras췉 los Hooks personalizados y a침adieras una funci칩n envoltorio a cada uno de ellos.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">/*******************\n * useFormInput.js *\n ******************/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createUseFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// 칔nica por instanciaci칩n</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> valueKey <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>valueKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      value<span class=\"token punctuation\">,</span>\n      <span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Este enfoque fuerza demasiado las cosas. Uno de los objetivos de dise침o de los Hooks es evitar el estilo funcional profundamente anidado que prevalece en los componentes de orden superior y las props de renderizado. En este caso tenemos que 춺instanciar췉 <em>cualquier</em> Hook personalizado antes de usarlo y utilizar la funci칩n resultante <em>exactamente una vez</em> en el cuerpo de un componente. Esto no es mucho m치s simple que invocar a los Hooks incondicionalmente.</p>\n<p>Adicionalmente, tienes que repetir dos veces cada Hook personalizado usado en un componente. Una vez en el 치mbito del nivel superior (o dentro del 치mbito de una funci칩n si estuvi칠ramos escribiendo un Hook personalizado) y otra en el lugar de la invocaci칩n. Eso se traduce en tener que saltar entre las declaraciones del renderizado y las del nivel superior incluso para cambios peque침os:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 丘멆잺 Esta NO es la API de los Hooks de React</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> useNameFormInput <span class=\"token operator\">=</span> <span class=\"token function\">createUseFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> useSurnameFormInput <span class=\"token operator\">=</span> <span class=\"token function\">createUseFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token function\">useNameFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> surname <span class=\"token operator\">=</span> <span class=\"token function\">useNameFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Adem치s necesitas ser muy preciso con sus nombres. Siempre tendr칤as 춺dos niveles췉 de nombres: los 춺constructores췉 como <code class=\"language-text\">createUseFormInput</code> y los Hooks instanciados como <code class=\"language-text\">useNameFormInput</code> y <code class=\"language-text\">useSurnameFormInput</code>.</p>\n<p>Si invocas a las 춺instancia췉 del Hook personalizado dos veces tienes como resultado una colisi칩n. De hecho, el c칩digo anterior tiene ese error; lo notaste? Deber칤a ser:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token function\">useNameFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> surname <span class=\"token operator\">=</span> <span class=\"token function\">useSurnameFormInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// No es useNameFormInput!</span></code></pre></div>\n<p>Estos no son problemas insalvables, pero para m칤 a침aden <em>m치s</em> fricci칩n que seguir las <a href=\"https://reactjs.org/docs/hooks-rules.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Reglas de los Hooks</a>.</p>\n<p>Tambi칠n es importante que rompen con las expectativas de 춺copiar y pegar췉. Extraer un Hook personalizado sin un envoltorio de clausura extra <em>a칰n funciona</em> con esta forma, pero solo hasta que se invoque dos veces (y ah칤 es que crea el conflicto). Es desafortunado que una API parezca funcionar, pero luego te fuerce a Envolverlo Todo뮖잺 una vez que te das cuenta que hay un conflicto en alg칰n lugar en lo profundo de la cadena.</p>\n<h3 id=\"defecto-n췈-6-a칰n-necesitamos-un-lint\"><a href=\"#defecto-n%C2%BA-6-a%C3%BAn-necesitamos-un-lint\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Defecto n.췈 6: A칰n necesitamos un <em>lint</em></h3>\n<p>Hay otra forma de evitar conflictos con el estado con llaves. Si lo sabes, probablemente ya estabas molesto, 춰porque a칰n no lo admit칤a! Lo siento.</p>\n<p>La idea es que podr칤amos <em>conformar</em> llaves cada vez que escribimos un Hook personalizado. Algo como esto:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 丘멆잺 Esta NO es la API de los Hooks de React</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> name <span class=\"token operator\">=</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> surname <span class=\"token operator\">=</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token string\">'surname'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token comment\">// ...</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">name</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">surname</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* ... */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>    \n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">function</span> <span class=\"token function\">useFormInput</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">formInputKey</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'useFormInput('</span> <span class=\"token operator\">+</span> formInputKey <span class=\"token operator\">+</span> <span class=\"token string\">').value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    value<span class=\"token punctuation\">,</span>\n    <span class=\"token function\">onChange</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>De todas las distintas alternativas, esta es la que menos me desagrada. Sin embargo, no creo que valga la pena.</p>\n<p>El c칩digo que pase llaves no 칰nicas o mal compuestas podr칤a <em>funcionar accidentalmente</em> hasta que un Hook fuese invocado en m칰ltiples ocasiones o colisionara con otro Hook. O peor a칰n, si fuese condicional (estamos intentando 춺arreglar췉 el requerimiento de invocaci칩n incondicional, 쯖ierto?) podr칤a que no encontraramos siquiera las colisiones hasta tiempo despu칠s.</p>\n<p>Recordar pasar llaves por todas las capas de Hooks personalizados parece lo suficientemente fr치gil para que quisi칠ramos comprobarlo con un <em>lint</em>. A침adir칤an trabajo extra en tiempo de ejecuci칩n (no se debe olvidar que necesitar칤an funcionar <em>como llaves</em>) y cada uno de ellos a침ade al tama침o del compilado final. <strong>Pero si de todas formas tenemos que usar un <em>lint</em>, 쯤u칠 problema resolvimos?</strong></p>\n<p>Podr칤a tener sentido si declarar condicionalmente estado y efectos fuera altamente deseable. Pero en la pr치ctica lo encuentro confuso. De hecho, no recuerdo a nadie pedir nunca definir condicionalmente <code class=\"language-text\">this.state</code> o <code class=\"language-text\">componentDidMount</code>.</p>\n<p>쯈u칠 significa este c칩digo exactamente?</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 丘멆잺 Esta NO es la API de los Hooks de React</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>isActive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'count'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Se preserva <code class=\"language-text\">count</code> cuando <code class=\"language-text\">props.isActive</code> es <code class=\"language-text\">false</code>? O se reinicia porque <code class=\"language-text\">useState(&#39;count&#39;)</code> no se invoc칩?</p>\n<p>Si se preserva el estado condicional, 쯤u칠 ocurre con un efecto?</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 丘멆잺 Esta NO es la API de los Hooks de React</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>isActive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'count'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span> <span class=\"token operator\">=></span> c <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Definitivamente no puede ejecutarse <em>antes</em> de que <code class=\"language-text\">props.isActive</code> sea <code class=\"language-text\">true</code> por primera vez. Pero una vez que se vuelve <code class=\"language-text\">true</code>, 쯣ara alguna vez de ejecutarse? 쯉e reinicia el intervalo cuando cambia <code class=\"language-text\">props.isActive</code> a <code class=\"language-text\">false</code>? Si lo hace, confunde el hecho de que el efecto se comporte de manera diferente al estado (que dijimos no se iba a reiniciar). Si el efecto contin칰a ejecut치ndose, confunde que el <code class=\"language-text\">if</code> fuera del efecto no lo haga en realidad condicional. 쯅o dijimos que quer칤amos efectos condicionales?</p>\n<p>Si el estado <em>s칤</em> se reinicia cuando no lo 춺usamos췉 durante un renderizado, 쯤u칠 ocurre si m칰ltiples ramas <code class=\"language-text\">if</code> contienen <code class=\"language-text\">useState(&#39;count&#39;)</code>, pero solo una se ejecuta en un momento dado? 쮼s un c칩digo v치lido? Si nuestro modelo mental es un 춺mapa con llaves췉, 쯣or qu칠 춺desaparecen췉 de 칠l los elementos? 쮼sperar칤a el desarrollador un <code class=\"language-text\">return</code> anticipado de un componente para reiniciar todo el estado despu칠s de 칠l? Si de verdad quisi칠ramos reiniciar el estado, podr칤amos hacerlo expl칤citamente al extraer un componente:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">Counter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>isActive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Claramente tiene su propio estado</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TickingCounter</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Esa probablemente se convertir칤a de todas formas en una 춺buena pr치ctica췉 para evitar estas preguntas confusas. Por lo que de cualquier forma que elijas para responderlas creo que la sem치ntica de <em>declarar</em> condicionalmente el estado y los efectos termina siendo tan extra침a que podr칤amos querer usar un <em>lint</em> para prevenirla.</p>\n<p>Si de todas formas tenemos que usar un <em>lint</em>, el requerimiento de componer llaves correctamente se convierte en una <em>carga innecesaria.</em> No nos trae nada que realmente <em>querramos</em> hacer. Sin embargo, eliminar ese requerimiento (y volver a la propuesta original) <em>s칤</em> nos reporta un beneficio. Provoca que copiar y pegar c칩digo de un componente en un Hook personalizado sea seguro sin utilizar espacios de nombres, reduce las adiciones al tama침o del compilado provocadas por las llaves y permite una implementaci칩n un poco m치s eficiente (no hay necesidad de b칰squedas en un diccionario).</p>\n<p>Las peque침as cosas van sumando.</p>\n<h3 id=\"defecto-n췈-7-no-se-pueden-pasar-valores-entre-los-hooks\"><a href=\"#defecto-n%C2%BA-7-no-se-pueden-pasar-valores-entre-los-hooks\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Defecto n.췈 7: No se pueden pasar valores entre los Hooks</h3>\n<p>Una de las mejores caracter칤sticas de los Hooks es que permiten pasar valores entre ellos.</p>\n<p>Aqu칤 hay un ejemplo hipot칠tico de un selector del destinatario de un mensaje que muestra si el amigo escogido actualmente est치 en l칤nea:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> friendList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Phoebe'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Rachel'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Ross'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ChatRecipientPicker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>recipientID<span class=\"token punctuation\">,</span> setRecipientID<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isRecipientOnline <span class=\"token operator\">=</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span>recipientID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Circle</span></span> <span class=\"token attr-name\">color</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>isRecipientOnline <span class=\"token operator\">?</span> <span class=\"token string\">'green'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'red'</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span>\n        <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>recipientID<span class=\"token punctuation\">}</span></span>\n        <span class=\"token attr-name\">onChange</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token function\">setRecipientID</span><span class=\"token punctuation\">(</span><span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span>friendList<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">friend</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>option</span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>friend<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">            </span><span class=\"token punctuation\">{</span>friend<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>option</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">friendID</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isOnline<span class=\"token punctuation\">,</span> setIsOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleStatusChange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setIsOnline</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">.</span>isOnline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">subscribeToFriendStatus</span><span class=\"token punctuation\">(</span>friendID<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      ChatAPI<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribeFromFriendStatus</span><span class=\"token punctuation\">(</span>friendID<span class=\"token punctuation\">,</span> handleStatusChange<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> isOnline<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Cuando cambias el destinatario, nuestro Hook <code class=\"language-text\">useFriendStatus()</code> eliminar칤a su suscripci칩n del estado del amigo anterior, y se suscribir칤a al pr칩ximo.</p>\n<p>Esto funciona porque podemos pasar el valor de retorno del Hook <code class=\"language-text\">useState()</code> al Hook <code class=\"language-text\">useFriendStatus()</code>:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>recipientID<span class=\"token punctuation\">,</span> setRecipientID<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> isRecipientOnline <span class=\"token operator\">=</span> <span class=\"token function\">useFriendStatus</span><span class=\"token punctuation\">(</span>recipientID<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>Pasar valores entre Hooks es muy poderoso. Por ejemplo, <a href=\"https://medium.com/@drcmda/hooks-in-react-spring-a-tutorial-c6c436ad7ee4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React Spring</a> te permite crear una animaci칩n de un rastro de varios valores 춺sigui칠ndose췉 entre ellos:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> pos1 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">set</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSpring</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> pos1<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> config<span class=\"token operator\">:</span> fast <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> pos2 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSpring</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> pos2<span class=\"token operator\">:</span> pos1<span class=\"token punctuation\">,</span> config<span class=\"token operator\">:</span> slow <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> pos3 <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useSpring</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> pos3<span class=\"token operator\">:</span> pos2<span class=\"token punctuation\">,</span> config<span class=\"token operator\">:</span> slow <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>(Aqu칤 hay un <a href=\"https://codesandbox.io/s/ppxnl191zx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">demo</a>).</p>\n<p>Las propuestas que ponen la inicializaci칩n de los Hooks en valores por defecto en argumentos o que escriben Hooks como decoradores hacen dif칤cil expresar este tipo de l칩gica.</p>\n<p>Si la invocaci칩n a los Hooks no ocurre en el cuerpo de la funci칩n dejar치 de ser f치cil pasar valores entre ellos, transformar esos valores sin crear muchas capas de componentes, o a침adir <code class=\"language-text\">useMemo()</code> para memorizar un c치lculo intermedio. Tampoco puedes referenciar f치cilmente estos valores en efectos, porque no los pueden capturar en clausuras. Hay formas de superar estos problemas con algunas convenciones, pero requieren que mentalmente 춺hagas coincidir췉 entradas y salidas. Esto es complicado y viola el estilo de otra manera directo de React.</p>\n<p>Pasar valores entre los Hooks es parte de la base de nuestra propuesta. El patr칩n de props de renderizado era lo m치s cercano que se pod칤a obtener sin los Hooks, pero no se pod칤an obtener todos los beneficios sin algo como <a href=\"https://ui.reach.tech/component-component\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><em>Component Component</em></a> que tiene mucho ruido sint치ctico debido a una 춺falsa jerarqu칤a췉. Los Hooks eliminan esa jerarqu칤a pasando valores, y las invocaciones a funci칩n son la forma m치s sencilla de hacerlo.</p>\n<h3 id=\"defecto-n췈-8-demasiada-ceremonia\"><a href=\"#defecto-n%C2%BA-8-demasiada-ceremonia\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Defecto n.췈 8: Demasiada ceremonia</h3>\n<p>Hay muchas propuestas que se incluyen en esta categor칤a. La mayor칤a intentan evitar la percibida dependencia de React que tienen los Hooks. Hay varias formas de conseguirlo: hacer que los Hooks incorporados por defecto est칠n disponibles en <code class=\"language-text\">this</code>, convertirlos en un argumento extra que hay que pasarle a todo y as칤 sucesivamente.</p>\n<p>Creo que <a href=\"https://github.com/reactjs/rfcs/pull/68#issuecomment-439314884\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">la respuesta de Sebastian</a> aborda esta forma mejor de lo que yo puedo describir, por lo que te animo a leer su primera secci칩n (<em>춺Injection Model췉</em>).</p>\n<p>Solo dir칠 que hay una raz칩n por la que los programadores tienden a preferir <code class=\"language-text\">try</code> / <code class=\"language-text\">catch</code> para manejar errores en lugar de pasar c칩digos de error a trav칠s de cada funci칩n. Es la misma raz칩n por la que preferimos los m칩dulos ES con <code class=\"language-text\">import</code> (o el <code class=\"language-text\">require</code> de CommonJS) a las definiciones expl칤citas de AMD donde se nos pasa <code class=\"language-text\">require</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 쮸lguien extra침a AMD?</span>\n<span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'require'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dependency1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dependency2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">require</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> dependency1 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dependency1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">var</span> dependency2 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dependency2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>S칤, puede que AMD sea m치s 춺honesto췉 en el hecho de que los m칩dulos no son cargados en realidad sincr칩nicamente en el ambiente de un navegador. Pero una vez que sabes eso, tener que escribir todo lo que conlleva <code class=\"language-text\">define</code> se convierte en un sinsentido.</p>\n<p><code class=\"language-text\">try</code> / <code class=\"language-text\">catch</code>, <code class=\"language-text\">require</code> y la API de Contexto de React son ejemplos pragm치ticos de c칩mo queremos tener un manejador 춺ambiental췉 disponible en lugar de moverlo expl칤citamente por cada nivel; incluso si de manera general valoramos lo expl칤cito. Creo que vale igual para los Hooks.</p>\n<p>Es similar a como, cuando definimos componentes, simplemente tomamos <code class=\"language-text\">Component</code> de <code class=\"language-text\">React</code>. Quiz치 nuestro c칩digo estar칤a m치s desacoplado de React si export치ramos una funci칩n constructora para cada componente.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">createModal</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">React</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Modal</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Pero en la pr치ctica termina siendo solo una indirecci칩n molesta. Cuando en realidad queramos simular React con algo m치s, siempre podemos hacerlo en el nivel del sistema de m칩dulos.</p>\n<p>Lo mismo se puede aplicar a los Hooks. A칰n m치s, como menciona la <a href=\"https://github.com/reactjs/rfcs/pull/68#issuecomment-439314884\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">respuesta de Sebastian</a>, es <em>t칠cnicamente posible</em> 춺redireccionar췉 los Hooks exportados por <code class=\"language-text\">react</code> a una implementaci칩n diferente. (<a href=\"/how-does-setstate-know-what-to-do/\">Uno de mis art칤culos anteriores</a> menciona c칩mo).</p>\n<p>Otra forma de imponer m치s ceremonia es hacer a los Hooks <a href=\"https://paulgray.net/an-alternative-design-for-hooks/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mon치dicos</a> o a침adir un concepto de primera clase como <code class=\"language-text\">React.createHook()</code>. Aparte del costo adicional en tiempo de ejecuci칩n, cualquier soluci칩n que a침ade envoltorios pierde uno de los grandes beneficios de usar funciones comunes: <em>Son muy f치ciles de depurar</em>.</p>\n<p>Las funciones comunes te permiten ir y venir con un depurador, sin que interfiera ning칰n c칩digo externo de alguna biblioteca y ver exactamente c칩mo fluyen los valores dentro del cuerpo de tu componente. Las indirecciones dificultan este proceso. Soluciones que son similares en esp칤ritu ya sea a los componentes de orden superior (Hooks 춺decoradores췉) o a las props de renderizado (p. ej. la propuesta <code class=\"language-text\">adopt</code> o usar <code class=\"language-text\">yield</code> desde generadores) padecen el mismo problema. Las indirecciones adem치s complican el uso de tipos est치ticos.</p>\n<hr>\n<p>Como mencion칠 anteriormente, este art칤culo no intenta ser exhaustivo. Hay otros problemas interesantes con propuestas diferentes. Algunos son m치s oscuros (p. ej. relacionados con la concurrencia o t칠cnicas avanzadas de compilaci칩n) y puede ser el tema para otro art칤culo en el futuro.</p>\n<p>Los Hooks tampoco son perfectos, pero es el mejor punto medio que pudimos encontrar para resolver estos problemas. Hay asuntos que <a href=\"https://github.com/reactjs/rfcs/pull/68#issuecomment-440780509\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">todav칤a tenemos que resolver</a> y existen elementos que son m치s inc칩modos de lograr que con clases. Ese es tambi칠n tema para otro art칤culo.</p>\n<p>Ya sea si cubr칤 tu propuesta alternativa favorita o no, espero que este escrito haya ayudado a arrojar algo de luz en nuestro proceso de pensamiento y en los criterios que consideramos al escoger una API. Como puedes ver, mucho de ello (como asegurarse que copiar y pegar, mover c칩digo, a침adir y eliminar dependencias funcionaran previsiblemente) tiene que ver con <a href=\"/optimized-for-change/\">optimizar para el cambio</a>. Espero que los usuarios de React apreciar치n estos aspectos.</p>","timeToRead":22,"frontmatter":{"title":"쯇or qu칠 los Hooks de React dependen del orden de invocaci칩n?","date":"December 13, 2018","spoiler":"Lecciones aprendidas de los mixins, props de renderizado, HOC y clases.","cta":null},"fields":{"slug":"/es/why-do-hooks-rely-on-call-order/","langKey":"es"}}},"pageContext":{"slug":"/es/why-do-hooks-rely-on-call-order/","translations":["es","fr","zh-hans"],"translatedLinks":[]}}}